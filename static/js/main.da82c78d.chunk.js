(this["webpackJsonpqbjc-playground"]=this["webpackJsonpqbjc-playground"]||[]).push([[0],{112:function(e,n,t){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,t,r){void 0===r&&(r=t),Object.defineProperty(e,r,{enumerable:!0,get:function(){return n[t]}})}:function(e,n,t,r){void 0===r&&(r=t),e[r]=n[t]}),o=this&&this.__exportStar||function(e,n){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(n,t)||r(n,e,t)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.QbUdt=n.QbArray=n.RuntimePlatform=n.Executor=n.ExecutionError=n.compile=void 0;var a=t(668);Object.defineProperty(n,"compile",{enumerable:!0,get:function(){return s(a).default}}),o(t(94),n),o(t(38),n);var i=t(163);Object.defineProperty(n,"ExecutionError",{enumerable:!0,get:function(){return i.ExecutionError}}),Object.defineProperty(n,"Executor",{enumerable:!0,get:function(){return s(i).default}});var u=t(134);Object.defineProperty(n,"RuntimePlatform",{enumerable:!0,get:function(){return u.RuntimePlatform}});var c=t(164);Object.defineProperty(n,"QbArray",{enumerable:!0,get:function(){return s(c).default}});var p=t(165);Object.defineProperty(n,"QbUdt",{enumerable:!0,get:function(){return s(p).default}}),o(t(96),n)},132:function(e,n,t){"use strict";var r=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.AstVisitor=n.AstVisitorError=n.UnaryOp=n.BinaryOp=n.ExprType=n.isLhsExpr=n.InputType=n.PrintSep=n.CondLoopStructure=n.CaseExprType=n.isSingularTypeExpr=n.DataTypeExprType=n.DimType=n.StmtType=n.isFnProcOrDefFnProc=void 0;var s,a,i,u=o(t(94)),c=t(38);n.isFnProcOrDefFnProc=function(e){return c.isFnOrDefFn(e.type)},function(e){e.LABEL="label",e.DIM="dim",e.ASSIGN="assign",e.CONST="const",e.GOTO="goto",e.IF="if",e.SELECT="select",e.COND_LOOP="condLoop",e.UNCOND_LOOP="uncondLoop",e.EXIT_LOOP="exitLoop",e.FOR="for",e.NEXT="next",e.EXIT_FOR="exitFor",e.GOSUB="gosub",e.RETURN="return",e.CALL="call",e.EXIT_PROC="exitProc",e.END="end",e.SWAP="swap",e.PRINT="print",e.INPUT="input",e.DEF_TYPE="defType",e.DATA="data",e.READ="read",e.RESTORE="restore"}(s=n.StmtType||(n.StmtType={})),function(e){e.LOCAL="local",e.SHARED="shared",e.STATIC="static"}(n.DimType||(n.DimType={})),function(e){e.ELEMENTARY="elementary",e.ARRAY="array",e.UDT="udt"}(a=n.DataTypeExprType||(n.DataTypeExprType={})),n.isSingularTypeExpr=function(e){return e.type!==a.ARRAY},function(e){e.VALUE="value",e.RANGE="range",e.COMP="comp"}(n.CaseExprType||(n.CaseExprType={})),function(e){e.COND_EXPR_BEFORE_STMTS="condExprBeforeStmts",e.COND_EXPR_AFTER_STMTS="condExprAfterStmts"}(n.CondLoopStructure||(n.CondLoopStructure={})),function(e){e.COMMA="comma",e.SEMICOLON="semicolon"}(n.PrintSep||(n.PrintSep={})),function(e){e.TOKENIZED="tokenized",e.LINE="line"}(n.InputType||(n.InputType={})),n.isLhsExpr=function(e){return[i.VAR_REF,i.SUBSCRIPT,i.MEMBER].includes(e.type)},function(e){e.LITERAL="literal",e.VAR_REF="varRef",e.FN_CALL="fnCall",e.BINARY_OP="binaryOp",e.UNARY_OP="unaryOp",e.SUBSCRIPT="subscript",e.MEMBER="member"}(i=n.ExprType||(n.ExprType={})),function(e){e.ADD="add",e.SUB="sub",e.MUL="mul",e.DIV="div",e.INTDIV="intdiv",e.EXP="exp",e.MOD="mod",e.AND="and",e.OR="or",e.EQ="eq",e.NE="ne",e.GT="gt",e.GTE="gte",e.LT="lt",e.LTE="lte"}(n.BinaryOp||(n.BinaryOp={})),function(e){e.NOT="not",e.NEG="sub",e.PARENS="parens"}(n.UnaryOp||(n.UnaryOp={}));var p=function(e){function n(n,t){var r=void 0===t?{}:t,o=r.sourceFileName,s=r.node;return e.call(this,n,{sourceFileName:o,loc:null===s||void 0===s?void 0:s.loc})||this}return r(n,e),n}(u.default);n.AstVisitorError=p;var l=function(){function e(){}return e.prototype.accept=function(e){switch(e.type){case c.ProcType.SUB:case c.ProcType.FN:case c.ProcType.DEF_FN:return this.visitProc(e);case s.LABEL:return this.visitLabelStmt(e);case s.DIM:return this.visitDimStmt(e);case s.ASSIGN:return this.visitAssignStmt(e);case s.CONST:return this.visitConstStmt(e);case s.GOTO:return this.visitGotoStmt(e);case s.IF:return this.visitIfStmt(e);case s.SELECT:return this.visitSelectStmt(e);case s.COND_LOOP:return this.visitCondLoopStmt(e);case s.UNCOND_LOOP:return this.visitUncondLoopStmt(e);case s.EXIT_LOOP:return this.visitExitLoopStmt(e);case s.FOR:return this.visitForStmt(e);case s.NEXT:return this.visitNextStmt(e);case s.EXIT_FOR:return this.visitExitForStmt(e);case s.GOSUB:return this.visitGosubStmt(e);case s.RETURN:return this.visitReturnStmt(e);case s.CALL:return this.visitCallStmt(e);case s.EXIT_PROC:return this.visitExitProcStmt(e);case s.END:return this.visitEndStmt(e);case s.SWAP:return this.visitSwapStmt(e);case s.PRINT:return this.visitPrintStmt(e);case s.INPUT:return this.visitInputStmt(e);case s.DEF_TYPE:return this.visitDefTypeStmt(e);case s.DATA:return this.visitDataStmt(e);case s.READ:return this.visitReadStmt(e);case s.RESTORE:return this.visitRestoreStmt(e);case i.LITERAL:return this.visitLiteralExpr(e);case i.VAR_REF:return this.visitVarRefExpr(e);case i.FN_CALL:return this.visitFnCallExpr(e);case i.BINARY_OP:return this.visitBinaryOpExpr(e);case i.UNARY_OP:return this.visitUnaryOpExpr(e);case i.SUBSCRIPT:return this.visitSubscriptExpr(e);case i.MEMBER:return this.visitMemberExpr(e);default:throw new Error("Unknown node type: "+JSON.stringify(e))}},e.prototype.acceptAll=function(e){var n=this;return e.map((function(e){return n.accept(e)}))},e.prototype.throwError=function(e,n){throw new p(e,{sourceFileName:this.sourceFileName,node:n})},e}();n.AstVisitor=l},133:function(e,n,t){"use strict";var r,o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var s=t(38),a=o(t(164)),i=o(t(165)),u=((r={})[s.DataType.INTEGER]=0,r[s.DataType.LONG]=0,r[s.DataType.SINGLE]=0,r[s.DataType.DOUBLE]=0,r[s.DataType.STRING]="",r);n.default=function(e){var n=e.type;if(s.isElementaryType(n))return u[n];switch(e.type){case s.DataType.ARRAY:return new a.default(e);case s.DataType.UDT:return new i.default(e);default:throw new Error("Unknown type: "+JSON.stringify(e))}}},134:function(e,n,t){"use strict";var r=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(o,s){function a(e){try{u(r.next(e))}catch(n){s(n)}}function i(e){try{u(r.throw(e))}catch(n){s(n)}}function u(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,i)}u((r=r.apply(e,n||[])).next())}))},o=this&&this.__generator||function(e,n){var t,r,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=n.call(e,a)}catch(i){s=[6,i],r=0}finally{t=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},s=this&&this.__spreadArray||function(e,n){for(var t=0,r=n.length,o=e.length;t<r;t++,o++)e[o]=n[t];return e},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.SCREEN_MODE_CONFIGS=n.RuntimePlatform=void 0;var i=a(t(160)),u=t(38),c=t(161),p=t(96),l=a(t(162)),m=function(){this.shouldStopExecution=!1};n.RuntimePlatform=m,n.SCREEN_MODE_CONFIGS=[{mode:0,textModeDimensions:[{rows:80,cols:25}],colorMap:["black","blue","green","cyan","red","magenta","yellow","white","gray","blueBright","greenBright","cyanBright","redBright","magentaBright","yellowBright","whiteBright"]}];var f=function(){function e(e){this.platform=e,this.roundHalfToEven=l.default,this.printFormatStringLexer=i.default.compile({NUMBER:/(?:[#,])*\.#+|[#,]+/,STRING:"&",DOLLAR_SIGNS:/\$+/,LITERAL:{match:/[^.#&\$]+/,lineBreaks:!0}}),this.inputLexer=i.default.compile({WHITESPACE:{match:/\s+/,lineBreaks:!0},QUOTED_STRING:{match:/"[^"]*"/,value:function(e){return e.substr(1,e.length-2)},type:function(){return"STRING"}},COMMA:",",STRING:/[^,\s]+/}),this.currentScreenMode=0}return e.prototype.executeBuiltinProc=function(e,n){for(var t=[],a=2;a<arguments.length;a++)t[a-2]=arguments[a];return r(this,void 0,void 0,(function(){var r,a;return o(this,(function(o){switch(o.label){case 0:if(!(r=c.lookupBuiltin(c.BUILTIN_FNS,e,n)||c.lookupBuiltin(c.BUILTIN_SUBS,e,n)))throw new Error('No matching built-in procedure found: "'+e+'"');if(n.length!==t.length)throw new Error("Argument types and values do not match: expected "+n.length+" arguments, got "+t.length);return a={runtime:this,platform:this.platform,argTypeSpecs:n,args:t},[4,r.run.apply(r,s(s([],t.map((function(e){return e[0][e[1]]}))),[a]))];case 1:return[2,o.sent()]}}))}))},e.prototype.print=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return r(this,void 0,void 0,(function(){var t;return o(this,(function(r){switch(r.label){case 0:return t=e?this.printWithFormatString(e,n):this.printWithDefaultFormat(n),0!==n.length&&n[n.length-1].type!==p.PrintArgType.VALUE||(t+="\n"),[4,this.platform.print(t)];case 1:return r.sent(),[2]}}))}))},e.prototype.printWithFormatString=function(e,n){var t=[],r=0;for(this.printFormatStringLexer.reset(e);;){for(;r<n.length&&n[r].type!==p.PrintArgType.VALUE;)++r;var o=r<n.length?n[r]:null,s=this.printFormatStringLexer.next();if(!s)break;switch(s.type){case"NUMBER":if(!o||"number"!==typeof o.value)throw new Error("Formatting error: expected number as argument #"+(r+1)+", got "+typeof(null===o||void 0===o?void 0:o.value));var a=s.value.split("."),i=a[0],u=a[1],c=i.replace(/,/,"").length;if(u){var l=(""+Math.floor(o.value)).padStart(c)+"."+o.value.toFixed(u.length).split(".")[1];t.push(l)}else{l=o.value.toFixed(0).padStart(c)+(s.value.indexOf(".")>=0?".":"");t.push(l)}++r;break;case"STRING":if(!o||"string"!==typeof o.value)throw new Error("Formatting error: expected string as argument #"+(r+1));t.push(o.value),++r;break;case"DOLLAR_SIGNS":var m=void 0;m=s.value.length<=1?s.value:2===s.value.length?" $":"%$",t.push(m);break;case"LITERAL":t.push(s.value);break;default:throw new Error("Unexpected token type: "+JSON.stringify(s))}}return t.join("")},e.prototype.printWithDefaultFormat=function(e){for(var n="",t=0,r=e;t<r.length;t++){var o=r[t];switch(o.type){case p.PrintArgType.SEMICOLON:break;case p.PrintArgType.COMMA:var s=14-n.length%14;n+=" ".repeat(s);break;case p.PrintArgType.VALUE:if("string"===typeof o.value){n+=""+o.value;break}if("number"===typeof o.value){n+=(o.value>=0?" ":"")+o.value+" ";break}default:throw new Error("Unknown print arg: '"+JSON.stringify(o)+"'")}}return n},e.prototype.inputLine=function(e){return r(this,void 0,void 0,(function(){var n;return o(this,(function(t){switch(t.label){case 0:return e?[4,this.platform.print(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[4,this.platform.setCursorVisibility(!0)];case 3:return t.sent(),[4,this.platform.inputLine()];case 4:return n=t.sent(),[4,this.platform.setCursorVisibility(!1)];case 5:return t.sent(),[2,n]}}))}))},e.prototype.input=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return r(this,void 0,void 0,(function(){var t,r,s,a,i,c,p,l,m,f;return o(this,(function(o){switch(o.label){case 0:return t=[],[4,this.platform.print(e)];case 1:return o.sent(),[4,this.inputLine("")];case 2:if(r=o.sent(),this.platform.shouldStopExecution)return[2,t];for(s=this.lexInput(r),a=0,i=null,c=0;c<n.length;++c){if(p=n[c],l="Error parsing value "+(c+1)+": ",c>0){if(!(a<s.length&&"COMMA"===s[a].type)){i=l+"Comma expected";break}++a}if(!(a<s.length&&"STRING"===s[a].type)){i=l+"No value provided";break}if(m=s[a].value,u.isString(p))t.push(m);else{if(!u.isNumeric(p))throw new Error("Unexpected result type "+p.type);if(f=parseFloat(m),isNaN(f)){i=l+'Invalid numeric value "'+m+'"';break}t.push(f)}++a}return t.length!==n.length?[3,3]:[2,t];case 3:return t.length<n.length?[4,this.platform.print("\n"+(i?i+"\n":"")+"Redo from start\n")]:[3,5];case 4:return o.sent(),[3,6];case 5:throw new Error("Too many results: expected "+n.length+", got "+t.length);case 6:return[3,0];case 7:return[2]}}))}))},e.prototype.lexInput=function(e){this.inputLexer.reset(e.trim());for(var n=[];;){var t=this.inputLexer.next();if(!t)break;"WHITESPACE"!==t.type&&n.push(t)}return n},e.prototype.setScreenMode=function(e){if(!n.SCREEN_MODE_CONFIGS.find((function(n){return n.mode===e})))throw new Error("Unsupported screen mode: "+e);this.currentScreenMode=e},Object.defineProperty(e.prototype,"currentScreenModeConfig",{get:function(){var e=this;return n.SCREEN_MODE_CONFIGS.find((function(n){return n.mode===e.currentScreenMode}))},enumerable:!1,configurable:!0}),e}();n.default=f},159:function(e,n,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Keywords=void 0;var o,s=r(t(160));!function(e){e.AND="and",e.AS="as",e.CALL="call",e.CASE="case",e.COLOR="color",e.CONST="const",e.DATA="data",e.DECLARE="declare",e.DEF="def",e.DEFINT="defint",e.DEFSNG="defsng",e.DEFDBL="defdbl",e.DEFLNG="deflng",e.DEFSTR="defstr",e.DIM="dim",e.DO="do",e.DOUBLE="double",e.ELSE="else",e.ELSEIF="elseif",e.END="end",e.EXIT="exit",e.FUNCTION="function",e.FOR="for",e.GOSUB="gosub",e.GOTO="goto",e.IF="if",e.IS="is",e.INPUT="input",e.INTEGER="integer",e.LET="let",e.LINE="line",e.LOCATE="locate",e.LONG="long",e.LOOP="loop",e.MOD="mod",e.NEXT="next",e.NOT="not",e.OR="or",e.PRINT="print",e.READ="read",e.REM="rem",e.RESTORE="restore",e.RETURN="return",e.SEG="seg",e.SELECT="select",e.SHARED="shared",e.SINGLE="single",e.STATIC="static",e.STEP="step",e.STOP="stop",e.STRING="string",e.SUB="sub",e.SYSTEM="system",e.SWAP="swap",e.THEN="then",e.TO="to",e.TYPE="type",e.UNTIL="until",e.USING="using",e.VIEW="view",e.WEND="wend",e.WHILE="while"}(o=n.Keywords||(n.Keywords={}));var a=s.default.states({main:{WHITESPACE:{match:/\s+/,type:function(e){return e.includes("\n")?"NEWLINE":""},lineBreaks:!0},COMMENT:{match:/'/,push:"comment"},IDENTIFIER:{match:/[a-zA-Z_][a-zA-Z0-9_]*(?:\$|%|#|&|!)?/,type:function(e){var n=s.default.keywords(e);return function(e){return n(e.toLowerCase())}}(o)},STRING_LITERAL:{match:/"[^"]*"/,value:function(e){return e.substr(1,e.length-2)}},NUMERIC_LITERAL:/(?:\d*\.\d+|\d+)/,HEX_LITERAL:{match:/&[hH][\da-fA-F]+&?/,type:function(){return"NUMERIC_LITERAL"},value:function(e){return""+parseInt(e.substr(2),16)}},OCT_LITERAL:{match:/&[oO]?[0-7]+&?/,type:function(){return"NUMERIC_LITERAL"},value:function(e){return""+parseInt(e.match(/[0-7]+/)[0],8)}},COLON:":",SEMICOLON:";",COMMA:",",DOT:".",LPAREN:"(",RPAREN:")",ADD:"+",SUB:"-",MUL:"*",EXP:"^",DIV:"/",INTDIV:"\\",EQ:"=",NE:"<>",GTE:">=",LTE:"<=",GT:">",LT:"<"},comment:{COMMENT:{match:/[^\n]+/,pop:1},NEWLINE:{match:/\n/,pop:1,lineBreaks:!0}}},"main"),i=["WHITESPACE","COMMENT","REM"];var u=new(function(){function e(e){this.mooLexer=e,this.lastToken=void 0,this.isNextTokenFirstOnLine=!0,this.tokenQueue=[]}return e.prototype.next=function(){if(this.tokenQueue.length>0)return this.tokenQueue.pop();var e;do{(e=this.mooLexer.next())&&(this.lastToken=e,e.isFirstTokenOnLine=this.isNextTokenFirstOnLine,"NEWLINE"===e.type?this.isNextTokenFirstOnLine=!0:this.isNextTokenFirstOnLine=!1,"REM"===e.type&&this.mooLexer.pushState("comment"))}while(e&&e.type&&i.includes(e.type));return e},e.prototype.peek=function(){var e=this.next();return this.tokenQueue.push(e),e},e.prototype.save=function(){return this.mooLexer.save()},e.prototype.reset=function(e,n){return this.mooLexer.reset(e,n),this.isNextTokenFirstOnLine=!0,this.lastToken=void 0,this.tokenQueue=[],this},e.prototype.formatError=function(e,n){return this.mooLexer.formatError(e,n)},e.prototype.has=function(e){return this.mooLexer.has(e)},e}())(a);n.default=u},161:function(e,n,t){"use strict";(function(e){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(o,s){function a(e){try{u(r.next(e))}catch(n){s(n)}}function i(e){try{u(r.throw(e))}catch(n){s(n)}}function u(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,i)}u((r=r.apply(e,n||[])).next())}))},s=this&&this.__generator||function(e,n){var t,r,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=n.call(e,a)}catch(i){s=[6,i],r=0}finally{t=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},a=this&&this.__spreadArray||function(e,n){for(var t=0,r=n.length,o=e.length;t<r;t++,o++)e[o]=n[t];return e},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.lookupBuiltin=n.BUILTIN_SUBS=n.BUILTIN_FNS=void 0;var u=i(t(689)),c=i(t(162)),p=t(95),l=t(38);function m(e,n){return n.map((function(n){return r(r({},e),{paramTypeSpecs:n})}))}n.BUILTIN_FNS=a(a([{name:"abs",paramTypeSpecs:[l.doubleSpec()],returnTypeSpec:l.doubleSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,Math.abs(e)]}))}))}},{name:"asc",paramTypeSpecs:[l.stringSpec()],returnTypeSpec:l.longSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){if(0===e.length)throw new Error("Expected non-empty string in ASC()");return[2,u.default.strToBuf(e[0],"cp437")[0]]}))}))}},{name:"atn",paramTypeSpecs:[l.doubleSpec()],returnTypeSpec:l.doubleSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,Math.atan(e)]}))}))}},{name:"chr$",paramTypeSpecs:[l.longSpec()],returnTypeSpec:l.stringSpec(),run:function(n){return o(this,void 0,void 0,(function(){return s(this,(function(t){return[2,u.default.bufToStr(e.from([n]),"cp437")]}))}))}},{name:"cdbl",paramTypeSpecs:[l.doubleSpec()],returnTypeSpec:l.doubleSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,e]}))}))}},{name:"cint",paramTypeSpecs:[l.doubleSpec()],returnTypeSpec:l.longSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,c.default(e)]}))}))}},{name:"clng",paramTypeSpecs:[l.doubleSpec()],returnTypeSpec:l.longSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,c.default(e)]}))}))}},{name:"cos",paramTypeSpecs:[l.doubleSpec()],returnTypeSpec:l.doubleSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,Math.cos(e)]}))}))}},{name:"csng",paramTypeSpecs:[l.doubleSpec()],returnTypeSpec:l.singleSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,e]}))}))}},{name:"csrlin",paramTypeSpecs:[],returnTypeSpec:l.longSpec(),run:function(e){var n=e.platform;return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,n.getCursorPosition()];case 1:return[2,e.sent().y+1]}}))}))}},{name:"date$",paramTypeSpecs:[],returnTypeSpec:l.stringSpec(),run:function(){return o(this,void 0,void 0,(function(){var e;return s(this,(function(n){return[2,[(e=new Date).getMonth()+1,e.getDate(),e.getFullYear()].map((function(e){return e.toString().padStart(2,"0")})).join("-")]}))}))}},{name:"exp",paramTypeSpecs:[l.doubleSpec()],returnTypeSpec:l.doubleSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,Math.exp(e)]}))}))}},{name:"fix",paramTypeSpecs:[l.doubleSpec()],returnTypeSpec:l.longSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,Math.sign(e)*Math.floor(Math.abs(e))]}))}))}},{name:"hex$",paramTypeSpecs:[l.longSpec()],returnTypeSpec:l.stringSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,e.toString(16).toUpperCase()]}))}))}},{name:"inkey$",paramTypeSpecs:[],returnTypeSpec:l.stringSpec(),run:function(e){var n=e.platform;return o(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return[4,n.getChar()];case 1:return[2,null!==(e=t.sent())&&void 0!==e?e:""]}}))}))}},{name:"input$",paramTypeSpecs:[l.longSpec()],returnTypeSpec:l.stringSpec(),run:function(e,n){var t=n.platform;return o(this,void 0,void 0,(function(){var n,r;return s(this,(function(o){switch(o.label){case 0:n=[],o.label=1;case 1:return n.length<e&&!t.shouldStopExecution?[4,t.getChar()]:[3,3];case 2:return(r=o.sent())&&n.push(r),[3,1];case 3:return[2,n.join("")]}}))}))}},{name:"instr",paramTypeSpecs:[l.stringSpec(),l.stringSpec()],returnTypeSpec:l.longSpec(),run:function(e,n){return o(this,void 0,void 0,(function(){return s(this,(function(t){return[2,e.indexOf(n)+1]}))}))}},{name:"instr",paramTypeSpecs:[l.longSpec(),l.stringSpec(),l.stringSpec()],returnTypeSpec:l.integerSpec(),run:function(e,n,t){return o(this,void 0,void 0,(function(){return s(this,(function(r){return[2,n.indexOf(t,e-1)+1]}))}))}},{name:"int",paramTypeSpecs:[l.doubleSpec()],returnTypeSpec:l.longSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,Math.floor(e)]}))}))}},{name:"lbound",paramTypeSpecs:[l.arraySpec(l.doubleSpec(),[])],returnTypeSpec:l.longSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,e.typeSpec.dimensionSpecs[0][0]]}))}))}},{name:"lbound",paramTypeSpecs:[l.arraySpec(l.doubleSpec(),[]),l.longSpec()],returnTypeSpec:l.longSpec(),run:function(e,n){return o(this,void 0,void 0,(function(){return s(this,(function(t){if(n<1||n>e.typeSpec.dimensionSpecs.length)throw new Error("Invalid dimension index: "+n);return[2,e.typeSpec.dimensionSpecs[n-1][0]]}))}))}},{name:"lcase$",paramTypeSpecs:[l.stringSpec()],returnTypeSpec:l.stringSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,e.toLowerCase()]}))}))}},{name:"left$",paramTypeSpecs:[l.stringSpec(),l.longSpec()],returnTypeSpec:l.stringSpec(),run:function(e,n){return o(this,void 0,void 0,(function(){return s(this,(function(t){return[2,e.substr(0,n)]}))}))}},{name:"len",paramTypeSpecs:[l.stringSpec()],returnTypeSpec:l.longSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,e.length]}))}))}},{name:"log",paramTypeSpecs:[l.doubleSpec()],returnTypeSpec:l.doubleSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,Math.log(e)]}))}))}},{name:"ltrim$",paramTypeSpecs:[l.stringSpec()],returnTypeSpec:l.stringSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,e.trimStart()]}))}))}},{name:"mid$",paramTypeSpecs:[l.stringSpec(),l.longSpec(),l.longSpec()],returnTypeSpec:l.stringSpec(),run:function(e,n,t){return o(this,void 0,void 0,(function(){return s(this,(function(r){return[2,e.substr(n-1,t)]}))}))}},{name:"oct$",paramTypeSpecs:[l.longSpec()],returnTypeSpec:l.stringSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,e.toString(8)]}))}))}},{name:"peek",paramTypeSpecs:[l.longSpec()],returnTypeSpec:l.longSpec(),run:function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){return[2,0]}))}))}},{name:"pos",paramTypeSpecs:[l.longSpec()],returnTypeSpec:l.longSpec(),run:function(e,n){var t=n.platform;return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,t.getCursorPosition()];case 1:return[2,e.sent().x+1]}}))}))}},{name:"right$",paramTypeSpecs:[l.stringSpec(),l.longSpec()],returnTypeSpec:l.stringSpec(),run:function(e,n){return o(this,void 0,void 0,(function(){return s(this,(function(t){return[2,e.substr(Math.max(0,e.length-n))]}))}))}}],m({name:"rnd",returnTypeSpec:l.doubleSpec(),run:function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){return[2,Math.random()]}))}))}},[[],[l.longSpec()]])),[{name:"rtrim$",paramTypeSpecs:[l.stringSpec()],returnTypeSpec:l.stringSpec(),run:function(e,n){n.args;return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,e.trimEnd()]}))}))}},{name:"sgn",paramTypeSpecs:[l.doubleSpec()],returnTypeSpec:l.longSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,Math.sign(e)]}))}))}},{name:"sin",paramTypeSpecs:[l.doubleSpec()],returnTypeSpec:l.doubleSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,Math.sin(e)]}))}))}},{name:"spc",paramTypeSpecs:[l.longSpec()],returnTypeSpec:l.stringSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2," ".repeat(e)]}))}))}},{name:"space$",paramTypeSpecs:[l.longSpec()],returnTypeSpec:l.stringSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2," ".repeat(e)]}))}))}},{name:"sqr",paramTypeSpecs:[l.doubleSpec()],returnTypeSpec:l.doubleSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,Math.sqrt(e)]}))}))}},{name:"str$",paramTypeSpecs:[l.doubleSpec()],returnTypeSpec:l.stringSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,(e>=0?" ":"")+e]}))}))}},{name:"string$",paramTypeSpecs:[l.longSpec(),l.longSpec()],returnTypeSpec:l.stringSpec(),run:function(n,t){return o(this,void 0,void 0,(function(){return s(this,(function(r){return[2,u.default.bufToStr(e.from([t]),"cp437").repeat(n)]}))}))}},{name:"string$",paramTypeSpecs:[l.longSpec(),l.stringSpec()],returnTypeSpec:l.stringSpec(),run:function(e,n){return o(this,void 0,void 0,(function(){return s(this,(function(t){if(0===n.length)throw new Error("Empty string argument to STRING$");return[2,n[0].repeat(e)]}))}))}},{name:"tab",paramTypeSpecs:[l.longSpec()],returnTypeSpec:l.stringSpec(),run:function(e,n){var t=n.platform;return o(this,void 0,void 0,(function(){var n,r,o,a;return s(this,(function(s){switch(s.label){case 0:return[4,t.getCursorPosition()];case 1:return n=s.sent(),r=n.x,o=n.y,[4,t.getScreenSize()];case 2:return a=s.sent().cols,e=(Math.max(1,e)-1)%a,[4,t.moveCursorTo(e,r<=e?o:o+1)];case 3:return s.sent(),[2,""]}}))}))}},{name:"tan",paramTypeSpecs:[l.doubleSpec()],returnTypeSpec:l.doubleSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,Math.tan(e)]}))}))}},{name:"time$",paramTypeSpecs:[],returnTypeSpec:l.stringSpec(),run:function(){return o(this,void 0,void 0,(function(){var e;return s(this,(function(n){return[2,[(e=new Date).getHours(),e.getMinutes(),e.getSeconds()].map((function(e){return e.toString().padStart(2,"0")})).join(":")]}))}))}},{name:"timer",paramTypeSpecs:[],returnTypeSpec:l.longSpec(),run:function(){return o(this,void 0,void 0,(function(){var e,n;return s(this,(function(t){return e=new Date,(n=new Date(e)).setHours(0,0,0,0),[2,(e.getTime()-n.getTime())/1e3]}))}))}},{name:"ubound",paramTypeSpecs:[l.arraySpec(l.doubleSpec(),[])],returnTypeSpec:l.longSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,e.typeSpec.dimensionSpecs[0][1]]}))}))}},{name:"ubound",paramTypeSpecs:[l.arraySpec(l.doubleSpec(),[]),l.longSpec()],returnTypeSpec:l.longSpec(),run:function(e,n){return o(this,void 0,void 0,(function(){return s(this,(function(t){if(n<1||n>e.typeSpec.dimensionSpecs.length)throw new Error("Invalid dimension index: "+n);return[2,e.typeSpec.dimensionSpecs[n-1][1]]}))}))}},{name:"ucase$",paramTypeSpecs:[l.stringSpec()],returnTypeSpec:l.stringSpec(),run:function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,e.toUpperCase()]}))}))}},{name:"val",paramTypeSpecs:[l.stringSpec()],returnTypeSpec:l.doubleSpec(),run:function(e){return o(this,void 0,void 0,(function(){var n;return s(this,(function(t){return n=parseFloat(e),[2,isNaN(n)?0:n]}))}))}}]),n.BUILTIN_SUBS=a(a(a(a(a(a(a(a(a(a([{name:"beep",paramTypeSpecs:[],run:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return o(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,e.pop().platform.beep()];case 1:return n.sent(),[2]}}))}))}}],m({name:"cls",run:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return o(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,e.pop().platform.clearScreen()];case 1:return n.sent(),[2]}}))}))}},[[],[l.longSpec()]])),m({name:"color",run:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return o(this,void 0,void 0,(function(){var n,t,r,o,a,i;return s(this,(function(s){return n=e.pop(),t=n.platform,r=n.runtime,o=function(e){if(e<0||e>=r.currentScreenModeConfig.colorMap.length)throw new Error("Invalid color: "+e);return r.currentScreenModeConfig.colorMap[e]},a=e[0],i=e[1],Number.isFinite(a)&&t.setFgColor(o(a)),Number.isFinite(i)&&t.setBgColor(o(i)),[2]}))}))}},[[l.longSpec()],[l.longSpec(),l.longSpec()],[l.longSpec(),l.longSpec(),l.longSpec()]])),m({name:"__def_seg",run:function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){return[2]}))}))}},[[],[l.longSpec()]])),m({name:"locate",run:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return o(this,void 0,void 0,(function(){var n,t,r,o,a,i,u;return s(this,(function(s){switch(s.label){case 0:return n=e.pop().platform,t=e[0],r=e[1],o=e[2],Number.isFinite(t)&&Number.isFinite(r)?[4,n.moveCursorTo(r-1,t-1)]:[3,2];case 1:return s.sent(),[3,5];case 2:return Number.isFinite(t)||Number.isFinite(r)?[4,n.getCursorPosition()]:[3,5];case 3:return a=s.sent(),i=Number.isFinite(r)?r-1:a.x,u=Number.isFinite(t)?t-1:a.y,i===a.x&&u===a.y?[3,5]:[4,n.moveCursorTo(i,u)];case 4:s.sent(),s.label=5;case 5:return Number.isFinite(o)?[4,n.setCursorVisibility(!!o)]:[3,7];case 6:s.sent(),s.label=7;case 7:return[2]}}))}))}},[[l.longSpec()],[l.longSpec(),l.longSpec()],[l.longSpec(),l.longSpec(),l.longSpec()],[l.longSpec(),l.longSpec(),l.longSpec(),l.longSpec()],[l.longSpec(),l.longSpec(),l.longSpec(),l.longSpec(),l.longSpec()]])),[{name:"play",paramTypeSpecs:[l.stringSpec()],run:function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){return[2]}))}))}},{name:"poke",paramTypeSpecs:[l.longSpec(),l.longSpec()],run:function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){return[2]}))}))}}]),m({name:"randomize",run:function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){return[2]}))}))}},[[],[l.longSpec()]])),m({name:"screen",run:function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return o(this,void 0,void 0,(function(){return s(this,(function(t){return n.pop().runtime.setScreenMode(e),[2]}))}))}},[[l.longSpec()],[l.longSpec(),l.longSpec()],[l.longSpec(),l.longSpec(),l.longSpec()],[l.longSpec(),l.longSpec(),l.longSpec(),l.longSpec()]])),m({name:"sleep",run:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return o(this,void 0,void 0,(function(){var n,t,r,o,a;return s(this,(function(s){switch(s.label){case 0:n=e.pop().platform,t=e.length>0?e[0]:0,r=(new Date).getTime(),s.label=1;case 1:return[4,n.getChar()];case 2:a=s.sent(),o=(new Date).getTime(),s.label=3;case 3:if(null===a&&(t<=0||o-r<1e3*t)&&!n.shouldStopExecution)return[3,1];s.label=4;case 4:return[2]}}))}))}},[[],[l.longSpec()]])),m({name:"__view_print",run:function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){return[2]}))}))}},[[],[l.longSpec(),l.longSpec()]])),[{name:"width",paramTypeSpecs:[l.longSpec(),l.longSpec()],run:function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){return[2]}))}))}}]),n.lookupBuiltin=function(e,n,t,r){var o=(void 0===r?{}:r).shouldReturnIfArgTypeMismatch,s=p.lookupSymbols(e,n),a=s.find((function(e){var n=e.paramTypeSpecs;return n.length===t.length&&n.every((function(e,n){return l.areMatchingElementaryTypes(e,t[n])||l.isArray(e)&&l.isArray(t[n])}))}));return null!==a&&void 0!==a?a:o&&s.length>0?s[0]:null}}).call(this,t(127).Buffer)},162:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return e-Math.floor(e)===.5?2*Math.round(e/2):Math.round(e)}},163:function(e,n,t){"use strict";var r=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(o,s){function a(e){try{u(r.next(e))}catch(n){s(n)}}function i(e){try{u(r.throw(e))}catch(n){s(n)}}function u(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,i)}u((r=r.apply(e,n||[])).next())}))},a=this&&this.__generator||function(e,n){var t,r,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=n.call(e,a)}catch(i){s=[6,i],r=0}finally{t=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ExecutionError=void 0;var u=t(691),c=i(t(94)),p=t(95),l=t(38),m=t(96),f=i(t(133)),d=i(t(134)),y=function(e){function n(n,t){var r=void 0===t?{}:t,o=r.module,s=r.stmt;return e.call(this,n,{sourceFileName:null===o||void 0===o?void 0:o.sourceFileName,loc:(null===s||void 0===s?void 0:s.loc)?{line:s.loc[0],col:s.loc[1]}:void 0})||this}return r(n,e),n}(c.default);n.ExecutionError=y;var h=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.isEndDirective=!0,n}return r(n,e),n}(Error),x=function(){function e(e,n){var t=(void 0===n?{}:n).stmtExecutionDelayUs;this.platform=e,this.currentModule=null,this.localStaticVarsMap={},this.moduleLabelIndexMap={},this.procLabelIndexMap={},this.dataCursor={stmtIdx:0,itemIdx:0},this.stmtExecutionDelayUs=null!==t&&void 0!==t?t:e.defaultStmtExecutionDelayUs}return e.prototype.executeModule=function(e){return s(this,void 0,void 0,(function(){var n,t,r,o;return a(this,(function(s){switch(s.label){case 0:return"string"!==typeof e?[3,2]:[4,this.platform.loadCompiledModule(e)];case 1:return t=s.sent(),[3,3];case 2:t=e,s.label=3;case 3:return n=t,this.currentModule=n,this.buildLabelIndexMaps(),this.localStaticVarsMap={},this.restore(),this.platform.shouldStopExecution=!1,[4,this.platform.setCursorVisibility(!1)];case 4:s.sent(),r={runtime:new d.default(this.platform),executeProc:this.executeProc.bind(this),read:this.read.bind(this),restore:this.restore.bind(this),args:{},localVars:this.initVars(n.localSymbols,[p.VarType.VAR,p.VarType.CONST]),localStaticVars:{},globalVars:this.initVars(n.globalSymbols,[p.VarType.VAR,p.VarType.CONST]),tempVars:{}},s.label=5;case 5:return s.trys.push([5,7,8,10]),[4,this.executeStmts(r,n.stmts,this.moduleLabelIndexMap)];case 6:return s.sent(),[3,10];case 7:if(!(o=s.sent()).isEndDirective)throw o;return[3,10];case 8:return this.currentModule=null,this.moduleLabelIndexMap={},this.procLabelIndexMap={},this.localStaticVarsMap={},this.restore(),this.platform.shouldStopExecution=!1,[4,this.platform.setCursorVisibility(!0)];case 9:return s.sent(),[7];case 10:return[2]}}))}))},e.prototype.stopExecution=function(){this.platform.shouldStopExecution=!0},e.prototype.executeProc=function(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return s(this,void 0,void 0,(function(){var r,s,i,u;return a(this,(function(a){switch(a.label){case 0:if(!(r=p.lookupSymbol(this.currentModule.procs,n)))throw new Error('Procedure not found: "'+n+'"');if(t.length!==r.paramSymbols.length)throw new Error("Incorrect number of arguments to "+l.procTypeName(r.type)+' "'+r.name+'": expected '+r.paramSymbols.length+", got "+t.length);for(s={},i=0;i<t.length;++i)s[r.paramSymbols[i].name]=t[i];if(this.localStaticVarsMap[r.name]||(this.localStaticVarsMap[r.name]=this.initVars(r.localSymbols,[p.VarType.STATIC_VAR])),u=o(o({},e),{args:s,localVars:this.initVars(r.localSymbols,[p.VarType.VAR,p.VarType.CONST]),localStaticVars:this.localStaticVarsMap[r.name],tempVars:{}}),!this.procLabelIndexMap[r.name])throw new Error('Label index map not found for "'+r.name+'"');return[4,this.executeStmts(u,r.stmts,this.procLabelIndexMap[r.name])];case 1:return a.sent(),l.isFnOrDefFn(r.type)?[2,u.localVars[r.name]]:[2]}}))}))},e.prototype.initVars=function(e,n){for(var t={},r=0,o=e;r<o.length;r++){var s=o[r];n.includes(s.varType)&&(t[s.name]=f.default(s.typeSpec))}return t},e.prototype.executeStmts=function(e,n,t){return s(this,void 0,void 0,(function(){var r,o,s,i;return a(this,(function(u){switch(u.label){case 0:r=[],o=0,s=function(){var s,u,c,p,l,f;return a(this,(function(a){switch(a.label){case 0:if(i.platform.shouldStopExecution)throw i.platform.shouldStopExecution=!1,new h;return s=n[o],u={module:i.currentModule,stmt:s},i.stmtExecutionDelayUs>0?[4,i.platform.delay(i.stmtExecutionDelayUs)]:[3,2];case 1:a.sent(),a.label=2;case 2:if(c=void 0,!("run"in s))return[3,6];a.label=3;case 3:return a.trys.push([3,5,,6]),[4,s.run(e)];case 4:return c=a.sent(),[3,6];case 5:throw(p=a.sent()).isEndDirective?p:new y(p.message,u);case 6:if(!c)return++o,[2,"continue"];switch(l=function(e){if(void 0===(o=t[e]))throw new y('Label not found: "'+e+'"',u)},c.type){case m.ExecutionDirectiveType.GOSUB:r.push({nextStmtIdx:o+1}),l(c.destLabel);break;case m.ExecutionDirectiveType.GOTO:l(c.destLabel);break;case m.ExecutionDirectiveType.RETURN:if(0===r.length)throw new y("RETURN without prior GOSUB",u);f=r.pop(),c.destLabel?l(c.destLabel):o=f.nextStmtIdx;break;case m.ExecutionDirectiveType.END:throw new h;case m.ExecutionDirectiveType.EXIT_PROC:o=n.length;break;default:throw new y("Unrecognized execution directive: "+JSON.stringify(c),u)}return[2]}}))},i=this,u.label=1;case 1:return o<n.length?[5,s()]:[3,3];case 2:return u.sent(),[3,1];case 3:return[2]}}))}))},e.prototype.read=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return s(this,void 0,void 0,(function(){var n,t,r;return a(this,(function(o){for(n=[],t=0;t<e.length;++t){if(!(r=this.getNextDataItem()))throw new Error("Data exhausted at item "+(t+1));try{n.push(u.getDataItem(r,e[t]))}catch(s){throw s.message="Error reading item "+(t+1)+": "+s.message,s}}return[2,n]}))}))},e.prototype.getNextDataItem=function(){for(var e=this.currentModule.stmts;;){if(this.dataCursor.stmtIdx>=e.length)return null;var n=e[this.dataCursor.stmtIdx];if("data"in n){if(!(this.dataCursor.itemIdx>=n.data.length))return n.data[this.dataCursor.itemIdx++];++this.dataCursor.stmtIdx,this.dataCursor.itemIdx=0}else++this.dataCursor.stmtIdx}},e.prototype.restore=function(e){return s(this,void 0,void 0,(function(){var n,t,r;return a(this,(function(o){if(e){if(void 0===(n=this.moduleLabelIndexMap[e]))throw new Error('Label not found: "'+e+'"');t=[n,0],this.dataCursor.stmtIdx=t[0],this.dataCursor.itemIdx=t[1]}else r=[0,0],this.dataCursor.stmtIdx=r[0],this.dataCursor.itemIdx=r[1];return[2]}))}))},e.prototype.buildLabelIndexMaps=function(){this.moduleLabelIndexMap=this.buildLabelIndexMap(this.currentModule.stmts);for(var e=0,n=this.currentModule.procs;e<n.length;e++){var t=n[e],r=t.name,o=t.stmts;this.procLabelIndexMap[r]=this.buildLabelIndexMap(o)}},e.prototype.buildLabelIndexMap=function(e){var n=this,t={};return e.forEach((function(e,r){if("label"in e){if(e.label in t)throw new y('Duplicate label "'+e.label+'"',{module:n.currentModule,stmt:e});t[e.label]=r}})),t},e}();n.default=x},164:function(e,n,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var o=t(38),s=r(t(133)),a=function(){function e(e){this._values=[],this.init(e.elementTypeSpec,e.dimensionSpecs)}return e.prototype.init=function(e,n){if(0===n.length)throw new Error("No dimension specs provided");this._typeSpec=o.arraySpec(e,n),this._values.length=0;for(var t=[this._values],r=0;r<n.length;++r){for(var a=n[r],i=a[0],u=a[1]-i+1,c=[],p=0,l=t;p<l.length;p++){var m=l[p];if(r===n.length-1)for(var f=0;f<u;++f)m.push(s.default(e));else for(f=0;f<u;++f){var d=new Array;c.push(d),m.push(d)}}t=c}},e.prototype.getIdx=function(e,n){var t=this._typeSpec.dimensionSpecs;if(!Number.isFinite(e)||e<0||e>=t.length)throw new Error("Invalid dimension in getIndex: expected number between 0 and "+(t.length-1)+", got "+e);var r=t[e],o=r[0],s=r[1];if(!Number.isFinite(n)||n<o||n>s)throw new Error("Index out of range for dimension "+(e+1)+": expected number between "+o+" and "+s+", got "+n);return n-o},Object.defineProperty(e.prototype,"values",{get:function(){return this._values},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typeSpec",{get:function(){return this._typeSpec},enumerable:!1,configurable:!0}),e}();n.default=a},165:function(e,n,t){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var s=t(38),a=o(t(133)),i=function(){function e(e){this._values={},this._typeSpec=r({},e),this.init()}return e.prototype.init=function(){for(var e=0,n=this._typeSpec.fieldSpecs;e<n.length;e++){var t=n[e];this._values[t.name]=a.default(t.typeSpec)}},e.prototype.clone=function(){for(var n=new e(this._typeSpec),t=0,r=this._typeSpec.fieldSpecs;t<r.length;t++){var o=r[t],a=this._values[o.name];n._values[o.name]=s.isUdt(o.typeSpec)?a.clone():a}return n},Object.defineProperty(e.prototype,"values",{get:function(){return this._values},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typeSpec",{get:function(){return this._typeSpec},enumerable:!1,configurable:!0}),e}();n.default=i},197:function(e,n,t){"use strict";var r=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),o=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(o,s){function a(e){try{u(r.next(e))}catch(n){s(n)}}function i(e){try{u(r.throw(e))}catch(n){s(n)}}function u(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,i)}u((r=r.apply(e,n||[])).next())}))},s=this&&this.__generator||function(e,n){var t,r,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=n.call(e,a)}catch(i){s=[6,i],r=0}finally{t=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.BrowserExecutor=n.BrowserPlatform=void 0;var i=a(t(166)),u=a(t(692)),c=a(t(163)),p=function(e){function n(n){var t=e.call(this)||this;return t.terminal=n,t.defaultStmtExecutionDelayUs=0,t}return r(n,e),n.prototype.loadCompiledModule=function(e){return o(this,void 0,void 0,(function(){var n,t;return s(this,(function(r){if(!(n=e.match(/^(?:#![^\n]+\n)?([\s\S]+)$/)))throw new Error("Empty code string");return new Function("module",n[1])(t={exports:{}}),[2,t.exports]}))}))},n.prototype.delay=function(e){return o(this,void 0,void 0,(function(){var n;return s(this,(function(t){switch(t.label){case 0:return"undefined"!==typeof window&&"undefined"!==typeof window.performance?[3,2]:[4,new Promise((function(n){return setTimeout(n,Math.round(e/1e3))}))];case 1:return t.sent(),[3,3];case 2:for(n=performance.now();1e3*(performance.now()-n)<e;);t.label=3;case 3:return[2]}}))}))},n.prototype.print=function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return this.terminal.write(e),[2]}))}))},n.prototype.inputLine=function(){return o(this,void 0,void 0,(function(){var e,n,t,r,a,u=this;return s(this,(function(c){switch(c.label){case 0:return e=[],n=0,[4,this.getCursorPosition()];case 1:return t=c.sent().x,[4,this.getScreenSize()];case 2:return r=c.sent().cols,a=[],[4,new Promise((function(c){var p=u.terminal.onData((function(a){return o(u,void 0,void 0,(function(){return s(this,(function(o){switch(a){case"\r":this.print("\n"),c();break;case"\x7f":e.length>0&&n>0&&(e.splice(--n,1),this.print(i.default.cursorBackward()),this.print(i.default.cursorSavePosition),this.print(i.default.eraseEndLine),this.print(e.slice(n).join("")),this.print(i.default.cursorRestorePosition));break;case"\x1b[3~":n<e.length&&(e.splice(n,1),this.print(i.default.cursorSavePosition),this.print(i.default.eraseEndLine),this.print(e.slice(n).join("")),this.print(i.default.cursorRestorePosition));break;case"\x1b[C":n<e.length&&(++n,this.print(a));break;case"\x1b[D":n>0&&(--n,this.print(a));break;case"\x1b[F":n<e.length&&(this.print(i.default.cursorForward(e.length-n)),n=e.length);break;case"\x1b[H":n>0&&(this.print(i.default.cursorBackward(n)),n=0);break;default:a.match(/^[\x20-\x7e]$/)&&t+e.length<r-2?(e.splice(n++,0,a),this.print(a),this.print(i.default.cursorSavePosition),this.print(e.slice(n).join("")),this.print(i.default.cursorRestorePosition)):console.log(a.split("").map((function(e){return e.charCodeAt(0)})).join(", "))}return[2]}))}))})).dispose;a.push(p);var l=setInterval((function(){u.shouldStopExecution&&c()}),20);a.push((function(){return clearInterval(l)}))}))];case 3:return c.sent(),a.forEach((function(e){return e()})),[2,e.join("")]}}))}))},n.prototype.getChar=function(){return o(this,void 0,void 0,(function(){var e,n,t=this;return s(this,(function(r){return e=null,n=this.terminal.onData((function(n){e=t.translateKeyCode(n.toString())})).dispose,[2,new Promise((function(t){setTimeout((function(){n(),t(e)}),20)}))]}))}))},n.prototype.getCursorPosition=function(){return o(this,void 0,void 0,(function(){var e=this;return s(this,(function(n){return[2,new Promise((function(n,t){var r=e.terminal.onData((function(e){r();var o=e.toString().match(/\[(\d+)\;(\d+)R/);if(o){var s=[o[1],o[2]],a=s[0],i={x:parseInt(s[1])-1,y:parseInt(a)-1};n(i)}else t()})).dispose;e.print(i.default.cursorGetPosition)}))]}))}))},n.prototype.getScreenSize=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){return[2,{rows:this.terminal.rows,cols:this.terminal.cols}]}))}))},n}(u.default);n.BrowserPlatform=p;var l=function(e){function n(n,t){return void 0===t&&(t={}),e.call(this,new p(n),t)||this}return r(n,e),n}(c.default);n.BrowserExecutor=l},245:function(e,n,t){var r={"./cal.bas":246,"./check.bas":247,"./guess.bas":248,"./nibbles.bas":249,"./strtonum.bas":250};function o(e){var n=s(e);return t(n)}function s(e){if(!t.o(r,e)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=s,e.exports=o,o.id=245},246:function(e,n,t){"use strict";t.r(n),n.default="' Example from \"Microsoft QuickBASIC: Programming in BASIC\"\r\n' Source: https://www.pcjs.org/documents/books/mspl13/basic/qbprog/\r\n\r\nDEFINT A-Z               ' Default variable type is integer\r\n\r\n' Define a data type for the names of the months and the\r\n' number of days in each:\r\nTYPE MonthType\r\n   Number AS INTEGER     ' Number of days in the month\r\n   MName AS STRING * 9   ' Name of the month\r\nEND TYPE\r\n\r\n' Declare procedures used:\r\nDECLARE FUNCTION IsLeapYear% (N%)\r\nDECLARE FUNCTION GetInput% (Prompt$, Row%, LowVal%, HighVal%)\r\n\r\nDECLARE SUB PrintCalendar (Year%, Month%)\r\nDECLARE SUB ComputeMonth (Year%, Month%, StartDay%, TotalDays%)\r\n\r\nDIM MonthData(1 TO 12) AS MonthType\r\n\r\n' Initialize month definitions from DATA statements below:\r\nFOR I = 1 TO 12\r\n   READ MonthData(I).MName, MonthData(I).Number\r\nNEXT\r\n\r\n' Main loop, repeat for as many months as desired:\r\nDO\r\n\r\n   CLS\r\n\r\n   ' Get year and month as input:\r\n   Year = GetInput(\"Year (1899 to 2099): \", 1, 1899, 2099)\r\n   Month = GetInput(\"Month (1 to 12): \", 2, 1, 12)\r\n\r\n   ' Print the calendar:\r\n   PrintCalendar Year, Month\r\n\r\n   ' Another Date?\r\n   LOCATE 13, 1         ' Locate in 13th row, 1st column\r\n   PRINT \"New Date? \";  ' Keep cursor on same line\r\n   LOCATE , , 1, 0, 13  ' Turn cursor on and make it one\r\n                        ' character high\r\n   Resp$ = INPUT$(1)    ' Wait for a key press\r\n   PRINT Resp$          ' Print the key pressed\r\n\r\nLOOP WHILE UCASE$(Resp$) = \"Y\"\r\nEND\r\n\r\n' Data for the months of a year:\r\nDATA January, 31, February, 28, March, 31\r\nDATA April, 30, May, 31, June, 30, July, 31, August, 31\r\nDATA September, 30, October, 31, November, 30, December, 31\r\n'\r\n' ====================== COMPUTEMONTH ========================\r\n'     Computes the first day and the total days in a month.\r\n' ============================================================\r\n'\r\nSUB ComputeMonth (Year, Month, StartDay, TotalDays) STATIC\r\n   SHARED MonthData() AS MonthType\r\n   CONST LEAP = 366 MOD 7\r\n   CONST NORMAL = 365 MOD 7\r\n\r\n   ' Calculate total number of days (NumDays) since 1/1/1899.\r\n\r\n   ' Start with whole years:\r\n   NumDays = 0\r\n   FOR I = 1899 TO Year - 1\r\n      IF IsLeapYear(I) THEN         ' If year is leap, add\r\n         NumDays = NumDays + LEAP   ' 366 MOD 7.\r\n      ELSE                          ' If normal year, add\r\n         NumDays = NumDays + NORMAL ' 365 MOD 7.\r\n      END IF\r\n   NEXT\r\n\r\n   ' Next, add in days from whole months:\r\n   FOR I = 1 TO Month - 1\r\n      NumDays = NumDays + MonthData(I).Number\r\n   NEXT\r\n\r\n   ' Set the number of days in the requested month:\r\n   TotalDays = MonthData(Month).Number\r\n\r\n   ' Compensate if requested year is a leap year:\r\n   IF IsLeapYear(Year) THEN\r\n\r\n      ' If after February, add one to total days:\r\n      IF Month > 2 THEN\r\n         NumDays = NumDays + 1\r\n\r\n      ' If February, add one to the month's days:\r\n      ELSEIF Month = 2 THEN\r\n         TotalDays = TotalDays + 1\r\n\r\n      END IF\r\n   END IF\r\n\r\n   ' 1/1/1899 was a Sunday, so calculating \"NumDays MOD 7\"\r\n   ' gives the day of week (Sunday = 0, Monday = 1, Tuesday = 2,\r\n   ' and so on) for the first day of the input month:\r\n   StartDay = NumDays MOD 7\r\nEND SUB\r\n'\r\n' ======================== GETINPUT ==========================\r\n'       Prompts for input, then tests for a valid range.\r\n' ============================================================\r\n'\r\nFUNCTION GetInput (Prompt$, Row, LowVal, HighVal) STATIC\r\n\r\n   ' Locate prompt at specified row, turn cursor on and\r\n   ' make it one character high:\r\n   LOCATE Row, 1, 1, 0, 13\r\n   PRINT Prompt$;\r\n\r\n   ' Save column position:\r\n   Column = POS(0)\r\n\r\n   ' Input value until it's within range:\r\n   DO\r\n      LOCATE Row, Column   ' Locate cursor at end of prompt\r\n      PRINT SPACE$(10)     ' Erase anything already there\r\n      LOCATE Row, Column   ' Relocate cursor at end of prompt\r\n      INPUT \"\", Value      ' Input value with no prompt\r\n   LOOP WHILE (Value < LowVal OR Value > HighVal)\r\n\r\n   ' Return valid input as value of function:\r\n   GetInput = Value\r\n\r\nEND FUNCTION\r\n'\r\n' ====================== ISLEAPYEAR ==========================\r\n'         Determines if a year is a leap year or not.\r\n' ============================================================\r\n'\r\nFUNCTION IsLeapYear (N) STATIC\r\n\r\n   ' If the year is evenly divisible by 4 and not divisible\r\n   ' by 100, or if the year is evenly divisible by 400, then\r\n   ' it's a leap year:\r\n   IsLeapYear = (N MOD 4 = 0 AND N MOD 100 <> 0) OR (N MOD 400 = 0)\r\nEND FUNCTION\r\n'\r\n' ===================== PRINTCALENDAR ========================\r\n'     Prints a formatted calendar given the year and month.\r\n' ============================================================\r\n'\r\nSUB PrintCalendar (Year, Month) STATIC\r\nSHARED MonthData() AS MonthType\r\n\r\n   ' Compute starting day (Su M Tu ...) and total days\r\n   ' for the month:\r\n   ComputeMonth Year, Month, StartDay, TotalDays\r\n   CLS\r\n   Header$ = RTRIM$(MonthData(Month).MName) + \",\" + STR$(Year)\r\n\r\n   ' Calculates location for centering month and year:\r\n   LeftMargin = (35 - LEN(Header$)) \\ 2\r\n\r\n   ' Print header:\r\n   PRINT TAB(LeftMargin); Header$\r\n   PRINT\r\n   PRINT \"Su    M   Tu    W   Th    F   Sa\"\r\n   PRINT\r\n\r\n   ' Recalculate and print tab to the first day\r\n   ' of the month (Su M Tu ...):\r\n   LeftMargin = 5 * StartDay + 1\r\n   PRINT TAB(LeftMargin);\r\n\r\n   ' Print out the days of the month:\r\n   FOR I = 1 TO TotalDays\r\n      PRINT USING \"##   \"; I;\r\n\r\n      ' Advance to the next line when the cursor\r\n      ' is past column 32:\r\n      IF POS(0) > 32 THEN PRINT\r\n   NEXT\r\n\r\nEND SUB\r\n"},247:function(e,n,t){"use strict";t.r(n),n.default='\' Example from "Microsoft QuickBASIC: Programming in BASIC"\n\' Source: https://www.pcjs.org/documents/books/mspl13/basic/qbprog/\n\nDIM Amount(1 TO 100)\nCONST FALSE = 0, TRUE = NOT FALSE\n\nCLS\n\' Get account\'s starting balance:\nINPUT "Type starting balance, then press <ENTER>: ", Balance\n\n\' Get transactions. Continue accepting input\n\' until the input is zero for a transaction,\n\' or until 100 transactions have been entered:\nFOR TransacNum% = 1 TO 100\n    PRINT TransacNum%;\n    PRINT ") Enter transaction amount (0 to end): ";\n    INPUT "", Amount(TransacNum%)\n    IF Amount(TransacNum%) = 0 THEN\n    TransacNum% = TransacNum% - 1\n    EXIT FOR\n    END IF\nNEXT\n\n\' Sort transactions in ascending order,\n\' using a "bubble sort":\nLimit% = TransacNum%\nDO\n    Swaps% = FALSE\n    FOR I% = 1 TO (Limit% - 1)\n\n    \' If two adjacent elements are out of order,\n    \' switch those elements:\n    IF Amount(I%) < Amount(I% + 1) THEN\n        SWAP Amount(I%), Amount(I% + 1)\n        Swaps% = I%\n    END IF\n    NEXT I%\n\n    \' Sort on next pass only to where last switch was made:\n    Limit% = Swaps%\n\n\' Sort until no elements are exchanged:\nLOOP WHILE Swaps%\n\n\' Print the sorted transaction array. If a transaction\n\' is greater than zero, print it as a "CREDIT"; if a\n\' transaction is less than zero, print it as a "DEBIT":\nFOR I% = 1 TO TransacNum%\n    IF Amount(I%) > 0 THEN\n    PRINT USING "CREDIT: $$#####.##"; Amount(I%)\n    ELSEIF Amount(I%) < 0 THEN\n    PRINT USING "DEBIT: $$#####.##"; Amount(I%)\n    END IF\n\n    \' Update balance:\n    Balance = Balance + Amount(I%)\nNEXT I%\n\n\' Print the final balance:\nPRINT\nPRINT "--------------------------"\nPRINT USING "Final Balance: $$######.##"; Balance\nEND\n '},248:function(e,n,t){"use strict";t.r(n),n.default='\' Welcome to qbjc playground!\n\'\n\' qbjc is a QBasic to JavaScript compiler. The qbjc playground\n\' lets you edit and run QBasic / QuickBASIC programs directly in\n\' the browser.\n\'\n\' To get started:\n\'\n\' - Press the blue "PLAY" button below to run this program. The\n\'   result will be displayed in the "OUTPUT" window on the right.\n\'\n\' - Feel free to modify and play around with this program. You\n\'   can also check out some other example programs using the\n\'   "Open" button at the top.\n\' \n\nCLS\nPRINT "Hi! Welcome to qbjc playground!"\nPRINT\n\nINPUT "What\'s your name? ", name$\nPRINT\nPRINT "Hello, "; name$; "! Let\'s play a game! "\n\nDO\n  PRINT\n  PlayNumberGuessingGame\n  PRINT\n  playAgain$ = InputYN$("Play again?")\n  PRINT\nLOOP WHILE playAgain$ = "Y"\n\nPRINT\nPRINT "Thanks for playing "; name$; "! Have a great day!"\nPRINT\n\n\nSUB PlayNumberGuessingGame\n  PRINT "I\'ll think of a number between 1 and 10, ";\n  PRINT "and you have 3 tries to guess it!"\n  answer = INT(RND * 10) + 1\n  remainingTries = 3\n  DO\n    PRINT\n    INPUT "Enter your guess: ", guess\n    IF answer = guess THEN\n      PRINT "Yay! You guessed the answer!"\n      EXIT DO\n    ELSE\n      remainingTries = remainingTries - 1\n      IF remainingTries <= 0 THEN\n        PRINT "Sorry, you lost! The answer was"; answer\n        EXIT DO\n      ELSEIF answer < guess THEN\n        PRINT "The answer is smaller than"; guess\n      ELSE\n        PRINT "The answer is larger than"; guess\n      END IF\n    END IF\n  LOOP\nEND SUB\n\n\nFUNCTION InputYN$(prompt$)\n  PRINT prompt$; " (Y/N)";\n  DO\n    key$ = UCASE$(INKEY$)\n  LOOP UNTIL key$ = "Y" OR key$ = "N"\n  InputYN$ = key$\nEND FUNCTION\n'},249:function(e,n,t){"use strict";t.r(n),n.default='\' Sample program from original QBasic distribution\n\' Source: https://archive.org/details/NibblesQbasic\n\n\'\n\'                         Q B a s i c   N i b b l e s\n\'\n\'                   Copyright (C) Microsoft Corporation 1990\n\'\n\' Nibbles is a game for one or two players.  Navigate your snakes\n\' around the game board trying to eat up numbers while avoiding\n\' running into walls or other snakes.  The more numbers you eat up,\n\' the more points you gain and the longer your snake becomes.\n\'\n\' To run this game, press Shift+F5.\n\'\n\' To exit QBasic, press Alt, F, X.\n\'\n\' To get help on a BASIC keyword, move the cursor to the keyword and press\n\' F1 or click the right mouse button.\n\'\n\n\'Set default data type to integer for faster game play\nDEFINT A-Z\n\n\'User-defined TYPEs\nTYPE snakeBody\n    row AS INTEGER\n    col AS INTEGER\nEND TYPE\n\n\'This type defines the player\'s snake\nTYPE snaketype\n    head      AS INTEGER\n    length    AS INTEGER\n    row       AS INTEGER\n    col       AS INTEGER\n    direction AS INTEGER\n    lives     AS INTEGER\n    score     AS INTEGER\n    scolor    AS INTEGER\n    alive     AS INTEGER\nEND TYPE\n\n\'This type is used to represent the playing screen in memory\n\'It is used to simulate graphics in text mode, and has some interesting,\n\'and slightly advanced methods to increasing the speed of operation.\n\'Instead of the normal 80x25 text graphics using chr$(219) "\u2588", we will be\n\'using chr$(220)"\u2584" and chr$(223) "\u2580" and chr$(219) "\u2588" to mimic an 80x50\n\'pixel screen.\n\'Check out sub-programs SET and POINTISTHERE to see how this is implemented\n\'feel free to copy these (as well as arenaType and the DIM ARENA stmt and the\n\'initialization code in the DrawScreen subprogram) and use them in your own\n\'programs\nTYPE arenaType\n    realRow     AS INTEGER        \'Maps the 80x50 point into the real 80x25\n    acolor      AS INTEGER        \'Stores the current color of the point\n    sister      AS INTEGER        \'Each char has 2 points in it.  .SISTER is\nEND TYPE                          \'-1 if sister point is above, +1 if below\n\n\'Sub Declarations\nDECLARE SUB SpacePause (text$)\nDECLARE SUB PrintScore (NumPlayers%, score1%, score2%, lives1%, lives2%)\nDECLARE SUB Intro ()\nDECLARE SUB GetInputs (NumPlayers, speed, diff$, monitor$)\nDECLARE SUB DrawScreen ()\nDECLARE SUB PlayNibbles (NumPlayers, speed, diff$)\nDECLARE SUB Set (row, col, acolor)\nDECLARE SUB Center (row, text$)\nDECLARE SUB DoIntro ()\nDECLARE SUB Initialize ()\nDECLARE SUB SparklePause ()\nDECLARE SUB Level (WhatToDO, sammy() AS snaketype)\nDECLARE SUB InitColors ()\nDECLARE SUB EraseSnake (snake() AS ANY, snakeBod() AS ANY, snakeNum%)\nDECLARE FUNCTION StillWantsToPlay ()\nDECLARE FUNCTION PointIsThere (row, col, backColor)\n\n\'Constants\nCONST TRUE = -1\nCONST FALSE = NOT TRUE\nCONST MAXSNAKELENGTH = 1000\nCONST STARTOVER = 1             \' Parameters to \'Level\' SUB\nCONST SAMELEVEL = 2\nCONST NEXTLEVEL = 3\n\n\'Global Variables\nDIM SHARED arena(1 TO 50, 1 TO 80) AS arenaType\nDIM SHARED curLevel, colorTable(10)\n\n    RANDOMIZE TIMER\n    GOSUB ClearKeyLocks\n    Intro\n    GetInputs NumPlayers, speed, diff$, monitor$\n    GOSUB SetColors\n    DrawScreen\n\n    DO\n      PlayNibbles NumPlayers, speed, diff$\n    LOOP WHILE StillWantsToPlay\n\n    GOSUB RestoreKeyLocks\n    COLOR 15, 0\n    CLS\nEND\n\nClearKeyLocks:\n    DEF SEG = 0                     \' Turn off CapLock, NumLock and ScrollLock\n    KeyFlags = PEEK(1047)\n    POKE 1047, &H0\n    DEF SEG\n    RETURN\n\nRestoreKeyLocks:\n    DEF SEG = 0                     \' Restore CapLock, NumLock and ScrollLock states\n    POKE 1047, KeyFlags\n    DEF SEG\n    RETURN\n\nSetColors:\n    IF monitor$ = "M" THEN\n        RESTORE mono\n    ELSE\n        RESTORE normal\n    END IF\n\n    FOR a = 1 TO 6\n        READ colorTable(a)\n    NEXT a\n    RETURN\n\n           \'snake1     snake2   Walls  Background  Dialogs-Fore  Back\nmono:   DATA 15,         7,       7,     0,          15,            0\nnormal: DATA 14,         13,      12,    1,          15,            4\nEND\n\n\'Center:\n\'  Centers text on given row\nSUB Center (row, text$)\n    LOCATE row, 41 - LEN(text$) / 2\n    PRINT text$;\nEND SUB\n\n\'DrawScreen:\n\'  Draws playing field\nSUB DrawScreen\n\n    \'initialize screen\n    VIEW PRINT\n    COLOR colorTable(1), colorTable(4)\n    CLS\n\n    \'Print title & message\n    Center 1, "Nibbles!"\n    Center 11, "Initializing Playing Field..."\n    \n    \'Initialize arena array\n    FOR row = 1 TO 50\n        FOR col = 1 TO 80\n            arena(row, col).realRow = INT((row + 1) / 2)\n            arena(row, col).sister = (row MOD 2) * 2 - 1\n        NEXT col\n    NEXT row\nEND SUB\n\n\'EraseSnake:\n\'  Erases snake to facilitate moving through playing field\nSUB EraseSnake (snake() AS snaketype, snakeBod() AS snakeBody, snakeNum)\n\n    FOR c = 0 TO 9\n        FOR b = snake(snakeNum).length - c TO 0 STEP -10\n            tail = (snake(snakeNum).head + MAXSNAKELENGTH - b) MOD MAXSNAKELENGTH\n            Set snakeBod(tail, snakeNum).row, snakeBod(tail, snakeNum).col, colorTable(4)\n        NEXT b\n    NEXT c\n    \nEND SUB\n\n\'GetInputs:\n\'  Gets player inputs\nSUB GetInputs (NumPlayers, speed, diff$, monitor$)\n\n    COLOR 7, 0\n    CLS\n\n    DO\n        LOCATE 5, 47: PRINT SPACE$(34);\n        LOCATE 5, 20\n        INPUT "How many players (1 or 2)"; num$\n    LOOP UNTIL VAL(num$) = 1 OR VAL(num$) = 2\n    NumPlayers = VAL(num$)\n\n    LOCATE 8, 21: PRINT "Skill level (1 to 100)"\n    LOCATE 9, 22: PRINT "1   = Novice"\n    LOCATE 10, 22: PRINT "90  = Expert"\n    LOCATE 11, 22: PRINT "100 = Twiddle Fingers"\n    LOCATE 12, 15: PRINT "(Computer speed may affect your skill level)"\n    DO\n        LOCATE 8, 44: PRINT SPACE$(35);\n        LOCATE 8, 43\n        INPUT gamespeed$\n    LOOP UNTIL VAL(gamespeed$) >= 1 AND VAL(gamespeed$) <= 100\n    speed = VAL(gamespeed$)\n  \n    speed = (100 - speed) * 2 + 1\n\n    DO\n        LOCATE 15, 56: PRINT SPACE$(25);\n        LOCATE 15, 15\n        INPUT "Increase game speed during play (Y or N)"; diff$\n        diff$ = UCASE$(diff$)\n    LOOP UNTIL diff$ = "Y" OR diff$ = "N"\n\n    DO\n        LOCATE 17, 46: PRINT SPACE$(34);\n        LOCATE 17, 17\n        INPUT "Monochrome or color monitor (M or C)"; monitor$\n        monitor$ = UCASE$(monitor$)\n    LOOP UNTIL monitor$ = "M" OR monitor$ = "C"\n\n    startTime# = TIMER                          \' Calculate speed of system\n    FOR i# = 1 TO 1000: NEXT i#                 \' and do some compensation\n    stopTime# = TIMER\n    speed = speed * .5 / (stopTime# - startTime#)\n\nEND SUB\n\n\'InitColors:\n\'Initializes playing field colors\nSUB InitColors\n    \n    FOR row = 1 TO 50\n        FOR col = 1 TO 80\n            arena(row, col).acolor = colorTable(4)\n        NEXT col\n    NEXT row\n\n    CLS\n   \n    \'Set (turn on) pixels for screen border\n    FOR col = 1 TO 80\n        Set 3, col, colorTable(3)\n        Set 50, col, colorTable(3)\n    NEXT col\n\n    FOR row = 4 TO 49\n        Set row, 1, colorTable(3)\n        Set row, 80, colorTable(3)\n    NEXT row\n\nEND SUB\n\n\'Intro:\n\'  Displays game introduction\nSUB Intro\n    SCREEN 0\n    WIDTH 80, 25\n    COLOR 15, 0\n    CLS\n\n    Center 4, "Q B a s i c   N i b b l e s"\n    COLOR 7\n    Center 6, "Copyright (C) Microsoft Corporation 1990"\n    Center 8, "Nibbles is a game for one or two players.  Navigate your snakes"\n    Center 9, "around the game board trying to eat up numbers while avoiding"\n    Center 10, "running into walls or other snakes.  The more numbers you eat up,"\n    Center 11, "the more points you gain and the longer your snake becomes."\n    Center 13, " Game Controls "\n    Center 15, "  General             Player 1               Player 2    "\n    Center 16, "                        (Up)                   (Up)      "\n    Center 17, "P - Pause                " + CHR$(24) + "                      W       "\n    Center 18, "                     (Left) " + CHR$(27) + "   " + CHR$(26) + " (Right)   (Left) A   D (Right)  "\n    Center 19, "                         " + CHR$(25) + "                      S       "\n    Center 20, "                       (Down)                 (Down)     "\n    Center 24, "Press any key to continue"\n\n    PLAY "MBT160O1L8CDEDCDL4ECC"\n    SparklePause\n\nEND SUB\n\n\'Level:\n\'Sets game level\nSUB Level (WhatToDO, sammy() AS snaketype) STATIC\n    \n    SELECT CASE (WhatToDO)\n\n    CASE STARTOVER\n        curLevel = 1\n    CASE NEXTLEVEL\n        curLevel = curLevel + 1\n    END SELECT\n\n    sammy(1).head = 1                       \'Initialize Snakes\n    sammy(1).length = 2\n    sammy(1).alive = TRUE\n    sammy(2).head = 1\n    sammy(2).length = 2\n    sammy(2).alive = TRUE\n\n    InitColors\n    \n    SELECT CASE curLevel\n    CASE 1\n        sammy(1).row = 25: sammy(2).row = 25\n        sammy(1).col = 50: sammy(2).col = 30\n        sammy(1).direction = 4: sammy(2).direction = 3\n\n\n    CASE 2\n        FOR i = 20 TO 60\n            Set 25, i, colorTable(3)\n        NEXT i\n        sammy(1).row = 7: sammy(2).row = 43\n        sammy(1).col = 60: sammy(2).col = 20\n        sammy(1).direction = 3: sammy(2).direction = 4\n\n    CASE 3\n        FOR i = 10 TO 40\n            Set i, 20, colorTable(3)\n            Set i, 60, colorTable(3)\n        NEXT i\n        sammy(1).row = 25: sammy(2).row = 25\n        sammy(1).col = 50: sammy(2).col = 30\n        sammy(1).direction = 1: sammy(2).direction = 2\n\n    CASE 4\n        FOR i = 4 TO 30\n            Set i, 20, colorTable(3)\n            Set 53 - i, 60, colorTable(3)\n        NEXT i\n        FOR i = 2 TO 40\n            Set 38, i, colorTable(3)\n            Set 15, 81 - i, colorTable(3)\n        NEXT i\n        sammy(1).row = 7: sammy(2).row = 43\n        sammy(1).col = 60: sammy(2).col = 20\n        sammy(1).direction = 3: sammy(2).direction = 4\n   \n    CASE 5\n        FOR i = 13 TO 39\n            Set i, 21, colorTable(3)\n            Set i, 59, colorTable(3)\n        NEXT i\n        FOR i = 23 TO 57\n            Set 11, i, colorTable(3)\n            Set 41, i, colorTable(3)\n        NEXT i\n        sammy(1).row = 25: sammy(2).row = 25\n        sammy(1).col = 50: sammy(2).col = 30\n        sammy(1).direction = 1: sammy(2).direction = 2\n\n    CASE 6\n        FOR i = 4 TO 49\n            IF i > 30 OR i < 23 THEN\n                Set i, 10, colorTable(3)\n                Set i, 20, colorTable(3)\n                Set i, 30, colorTable(3)\n                Set i, 40, colorTable(3)\n                Set i, 50, colorTable(3)\n                Set i, 60, colorTable(3)\n                Set i, 70, colorTable(3)\n            END IF\n        NEXT i\n        sammy(1).row = 7: sammy(2).row = 43\n        sammy(1).col = 65: sammy(2).col = 15\n        sammy(1).direction = 2: sammy(2).direction = 1\n\n    CASE 7\n        FOR i = 4 TO 49 STEP 2\n            Set i, 40, colorTable(3)\n        NEXT i\n        sammy(1).row = 7: sammy(2).row = 43\n        sammy(1).col = 65: sammy(2).col = 15\n        sammy(1).direction = 2: sammy(2).direction = 1\n\n    CASE 8\n        FOR i = 4 TO 40\n            Set i, 10, colorTable(3)\n            Set 53 - i, 20, colorTable(3)\n            Set i, 30, colorTable(3)\n            Set 53 - i, 40, colorTable(3)\n            Set i, 50, colorTable(3)\n            Set 53 - i, 60, colorTable(3)\n            Set i, 70, colorTable(3)\n        NEXT i\n        sammy(1).row = 7: sammy(2).row = 43\n        sammy(1).col = 65: sammy(2).col = 15\n        sammy(1).direction = 2: sammy(2).direction = 1\n\n    CASE 9\n        FOR i = 6 TO 47\n            Set i, i, colorTable(3)\n            Set i, i + 28, colorTable(3)\n        NEXT i\n        sammy(1).row = 40: sammy(2).row = 15\n        sammy(1).col = 75: sammy(2).col = 5\n        sammy(1).direction = 1: sammy(2).direction = 2\n   \n    CASE ELSE\n        FOR i = 4 TO 49 STEP 2\n            Set i, 10, colorTable(3)\n            Set i + 1, 20, colorTable(3)\n            Set i, 30, colorTable(3)\n            Set i + 1, 40, colorTable(3)\n            Set i, 50, colorTable(3)\n            Set i + 1, 60, colorTable(3)\n            Set i, 70, colorTable(3)\n        NEXT i\n        sammy(1).row = 7: sammy(2).row = 43\n        sammy(1).col = 65: sammy(2).col = 15\n        sammy(1).direction = 2: sammy(2).direction = 1\n\n    END SELECT\nEND SUB\n\n\'PlayNibbles:\n\'  Main routine that controls game play\nSUB PlayNibbles (NumPlayers, speed, diff$)\n\n    \'Initialize Snakes\n    DIM sammyBody(MAXSNAKELENGTH - 1, 1 TO 2) AS snakeBody\n    DIM sammy(1 TO 2) AS snaketype\n    sammy(1).lives = 5\n    sammy(1).score = 0\n    sammy(1).scolor = colorTable(1)\n    sammy(2).lives = 5\n    sammy(2).score = 0\n    sammy(2).scolor = colorTable(2)\n                 \n    Level STARTOVER, sammy()\n    startRow1 = sammy(1).row: startCol1 = sammy(1).col\n    startRow2 = sammy(2).row: startCol2 = sammy(2).col\n\n    curSpeed = speed\n\n    \'play Nibbles until finished\n\n    SpacePause "     Level" + STR$(curLevel) + ",  Push Space"\n    gameOver = FALSE\n    DO\n        IF NumPlayers = 1 THEN\n            sammy(2).row = 0\n        END IF\n\n        number = 1          \'Current number that snakes are trying to run into\n        nonum = TRUE        \'nonum = TRUE if a number is not on the screen\n\n        playerDied = FALSE\n        PrintScore NumPlayers, sammy(1).score, sammy(2).score, sammy(1).lives, sammy(2).lives\n        PLAY "T160O1>L20CDEDCDL10ECC"\n\n        DO\n            \'Print number if no number exists\n            IF nonum = TRUE THEN\n                DO\n                    numberRow = INT(RND(1) * 47 + 3)\n                    NumberCol = INT(RND(1) * 78 + 2)\n                    sisterRow = numberRow + arena(numberRow, NumberCol).sister\n                LOOP UNTIL NOT PointIsThere(numberRow, NumberCol, colorTable(4)) AND NOT PointIsThere(sisterRow, NumberCol, colorTable(4))\n                numberRow = arena(numberRow, NumberCol).realRow\n                nonum = FALSE\n                COLOR colorTable(1), colorTable(4)\n                LOCATE numberRow, NumberCol\n                PRINT RIGHT$(STR$(number), 1);\n                count = 0\n            END IF\n\n            \'Delay game\n            FOR a# = 1 TO curSpeed:  NEXT a#\n\n            \'Get keyboard input & Change direction accordingly\n            kbd$ = INKEY$\n            SELECT CASE kbd$\n                CASE "w", "W": IF sammy(2).direction <> 2 THEN sammy(2).direction = 1\n                CASE "s", "S": IF sammy(2).direction <> 1 THEN sammy(2).direction = 2\n                CASE "a", "A": IF sammy(2).direction <> 4 THEN sammy(2).direction = 3\n                CASE "d", "D": IF sammy(2).direction <> 3 THEN sammy(2).direction = 4\n                CASE CHR$(0) + "H": IF sammy(1).direction <> 2 THEN sammy(1).direction = 1\n                CASE CHR$(0) + "P": IF sammy(1).direction <> 1 THEN sammy(1).direction = 2\n                CASE CHR$(0) + "K": IF sammy(1).direction <> 4 THEN sammy(1).direction = 3\n                CASE CHR$(0) + "M": IF sammy(1).direction <> 3 THEN sammy(1).direction = 4\n                CASE "p", "P": SpacePause " Game Paused ... Push Space  "\n                CASE ELSE\n            END SELECT\n\n            FOR a = 1 TO NumPlayers\n                \'Move Snake\n                SELECT CASE sammy(a).direction\n                    CASE 1: sammy(a).row = sammy(a).row - 1\n                    CASE 2: sammy(a).row = sammy(a).row + 1\n                    CASE 3: sammy(a).col = sammy(a).col - 1\n                    CASE 4: sammy(a).col = sammy(a).col + 1\n                END SELECT\n\n                \'If snake hits number, respond accordingly\n                IF numberRow = INT((sammy(a).row + 1) / 2) AND NumberCol = sammy(a).col THEN\n                    PLAY "MBO0L16>CCCE"\n                    IF sammy(a).length < (MAXSNAKELENGTH - 30) THEN\n                        sammy(a).length = sammy(a).length + number * 4\n                    END IF\n                    sammy(a).score = sammy(a).score + number\n                    PrintScore NumPlayers, sammy(1).score, sammy(2).score, sammy(1).lives, sammy(2).lives\n                    number = number + 1\n                    IF number = 10 THEN\n                        EraseSnake sammy(), sammyBody(), 1\n                        EraseSnake sammy(), sammyBody(), 2\n                        LOCATE numberRow, NumberCol: PRINT " "\n                        Level NEXTLEVEL, sammy()\n                        PrintScore NumPlayers, sammy(1).score, sammy(2).score, sammy(1).lives, sammy(2).lives\n                        SpacePause "     Level" + STR$(curLevel) + ",  Push Space"\n                        IF NumPlayers = 1 THEN sammy(2).row = 0\n                        number = 1\n                        IF diff$ = "P" THEN speed = speed - 10: curSpeed = speed\n                    END IF\n                    nonum = TRUE\n                    IF curSpeed < 1 THEN curSpeed = 1\n                END IF\n            NEXT a\n\n            FOR a = 1 TO NumPlayers\n                \'If player runs into any point, or the head of the other snake, it dies.\n                IF PointIsThere(sammy(a).row, sammy(a).col, colorTable(4)) OR (sammy(1).row = sammy(2).row AND sammy(1).col = sammy(2).col) THEN\n                    PLAY "MBO0L32EFGEFDC"\n                    COLOR , colorTable(4)\n                    LOCATE numberRow, NumberCol\n                    PRINT " "\n                   \n                    playerDied = TRUE\n                    sammy(a).alive = FALSE\n                    sammy(a).lives = sammy(a).lives - 1\n\n                \'Otherwise, move the snake, and erase the tail\n                ELSE\n                    sammy(a).head = (sammy(a).head + 1) MOD MAXSNAKELENGTH\n                    sammyBody(sammy(a).head, a).row = sammy(a).row\n                    sammyBody(sammy(a).head, a).col = sammy(a).col\n                    tail = (sammy(a).head + MAXSNAKELENGTH - sammy(a).length) MOD MAXSNAKELENGTH\n                    Set sammyBody(tail, a).row, sammyBody(tail, a).col, colorTable(4)\n                    sammyBody(tail, a).row = 0\n                    Set sammy(a).row, sammy(a).col, sammy(a).scolor\n                END IF\n            NEXT a\n\n        LOOP UNTIL playerDied\n\n        curSpeed = speed                \' reset speed to initial value\n       \n        FOR a = 1 TO NumPlayers\n            EraseSnake sammy(), sammyBody(), a\n\n            \'If dead, then erase snake in really cool way\n            IF sammy(a).alive = FALSE THEN\n                \'Update score\n                sammy(a).score = sammy(a).score - 10\n                PrintScore NumPlayers, sammy(1).score, sammy(2).score, sammy(1).lives, sammy(2).lives\n                \n                IF a = 1 THEN\n                    SpacePause " Sammy Dies! Push Space! ---\x3e"\n                ELSE\n                    SpacePause " <---- Jake Dies! Push Space "\n                END IF\n            END IF\n        NEXT a\n\n        Level SAMELEVEL, sammy()\n        PrintScore NumPlayers, sammy(1).score, sammy(2).score, sammy(1).lives, sammy(2).lives\n     \n    \'Play next round, until either of snake\'s lives have run out.\n    LOOP UNTIL sammy(1).lives = 0 OR sammy(2).lives = 0\n\nEND SUB\n\n\'PointIsThere:\n\'  Checks the global  arena array to see if the boolean flag is set\nFUNCTION PointIsThere (row, col, acolor)\n    IF row <> 0 THEN\n        IF arena(row, col).acolor <> acolor THEN\n            PointIsThere = TRUE\n        ELSE\n            PointIsThere = FALSE\n        END IF\n    END IF\nEND FUNCTION\n\n\'PrintScore:\n\'  Prints players scores and number of lives remaining\nSUB PrintScore (NumPlayers, score1, score2, lives1, lives2)\n    COLOR 15, colorTable(4)\n\n    IF NumPlayers = 2 THEN\n        LOCATE 1, 1\n        PRINT USING "#,###,#00  Lives: #  <--JAKE"; score2; lives2\n    END IF\n\n    LOCATE 1, 49\n    PRINT USING "SAMMY--\x3e  Lives: #     #,###,#00"; lives1; score1\nEND SUB\n\n\'Set:\n\'  Sets row and column on playing field to given color to facilitate moving\n\'  of snakes around the field.\nSUB Set (row, col, acolor)\n    IF row <> 0 THEN\n        arena(row, col).acolor = acolor             \'assign color to arena\n        realRow = arena(row, col).realRow           \'Get real row of pixel\n        topFlag = arena(row, col).sister + 1 / 2    \'Deduce whether pixel\n                                                    \'is on top\u2580, or bottom\u2584\n        sisterRow = row + arena(row, col).sister    \'Get arena row of sister\n        sisterColor = arena(sisterRow, col).acolor  \'Determine sister\'s color\n\n        LOCATE realRow, col\n\n        IF acolor = sisterColor THEN                \'If both points are same\n            COLOR acolor, acolor                           \'Print chr$(219) "\u2588"\n            PRINT CHR$(219);\n        ELSE\n            IF topFlag THEN                         \'Since you cannot have\n                IF acolor > 7 THEN                  \'bright backgrounds\n                    COLOR acolor, sisterColor       \'determine best combo\n                    PRINT CHR$(223);                \'to use.\n                ELSE\n                    COLOR sisterColor, acolor\n                    PRINT CHR$(220);\n                END IF\n            ELSE\n                IF acolor > 7 THEN\n                    COLOR acolor, sisterColor\n                    PRINT CHR$(220);\n                ELSE\n                    COLOR sisterColor, acolor\n                    PRINT CHR$(223);\n                END IF\n            END IF\n        END IF\n    END IF\nEND SUB\n\n\'SpacePause:\n\'  Pauses game play and waits for space bar to be pressed before continuing\nSUB SpacePause (text$)\n\n    COLOR colorTable(5), colorTable(6)\n    Center 11, "\u2588\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2588"\n    Center 12, "\u2588 " + LEFT$(text$ + SPACE$(29), 29) + " \u2588"\n    Center 13, "\u2588\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2588"\n    WHILE INKEY$ <> "": WEND\n    WHILE INKEY$ <> " ": WEND\n    COLOR 15, colorTable(4)\n\n    FOR i = 21 TO 26            \' Restore the screen background\n        FOR j = 24 TO 56\n            Set i, j, arena(i, j).acolor\n        NEXT j\n    NEXT i\n\nEND SUB\n\n\'SparklePause:\n\'  Creates flashing border for intro screen\nSUB SparklePause\n\n    COLOR 4, 0\n    a$ = "*    *    *    *    *    *    *    *    *    *    *    *    *    *    *    *    *    "\n    WHILE INKEY$ <> "": WEND \'Clear keyboard buffer\n\n    WHILE INKEY$ = ""\n        FOR a = 1 TO 5\n            LOCATE 1, 1                             \'print horizontal sparkles\n            PRINT MID$(a$, a, 80);\n            LOCATE 22, 1\n            PRINT MID$(a$, 6 - a, 80);\n\n            FOR b = 2 TO 21                         \'Print Vertical sparkles\n                c = (a + b) MOD 5\n                IF c = 1 THEN\n                    LOCATE b, 80\n                    PRINT "*";\n                    LOCATE 23 - b, 1\n                    PRINT "*";\n                ELSE\n                    LOCATE b, 80\n                    PRINT " ";\n                    LOCATE 23 - b, 1\n                    PRINT " ";\n                END IF\n            NEXT b\n        NEXT a\n    WEND\n\nEND SUB\n\n\'StillWantsToPlay:\n\'  Determines if users want to play game again.\nFUNCTION StillWantsToPlay\n\n    COLOR colorTable(5), colorTable(6)\n    Center 10, "\u2588\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2588"\n    Center 11, "\u2588       G A M E   O V E R       \u2588"\n    Center 12, "\u2588                               \u2588"\n    Center 13, "\u2588      Play Again?   (Y/N)      \u2588"\n    Center 14, "\u2588\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2588"\n\n    WHILE INKEY$ <> "": WEND\n    DO\n        kbd$ = UCASE$(INKEY$)\n    LOOP UNTIL kbd$ = "Y" OR kbd$ = "N"\n\n    COLOR 15, colorTable(4)\n    Center 10, "                                 "\n    Center 11, "                                 "\n    Center 12, "                                 "\n    Center 13, "                                 "\n    Center 14, "                                 "\n\n    IF kbd$ = "Y" THEN\n        StillWantsToPlay = TRUE\n    ELSE\n        StillWantsToPlay = FALSE\n        COLOR 7, 0\n        CLS\n    END IF\n\nEND FUNCTION\n\n'},250:function(e,n,t){"use strict";t.r(n),n.default="' Example from \"Microsoft QuickBASIC: Programming in BASIC\"\r\n' Source: https://www.pcjs.org/documents/books/mspl13/basic/qbprog/\r\n\r\nDECLARE FUNCTION Filter$ (Txt$, FilterString$)\r\n\r\n' Input a line:\r\nLINE INPUT \"Enter a number with commas: \", A$\r\n\r\n' Look for only valid numeric characters (0123456789.-) in the\r\n' input string:\r\nCleanNum$ = Filter$(A$, \"0123456789.-\")\r\n\r\n' Convert the string to a number:\r\nPRINT \"The number's value = \"; VAL(CleanNum$)\r\nEND\r\n'\r\n' ========================== FILTER ==========================\r\n'         Takes unwanted characters out of a string by\r\n'        comparing them with a filter string containing\r\n'             only acceptable numeric characters\r\n' ============================================================\r\n'\r\nFUNCTION Filter$ (Txt$, FilterString$) STATIC\r\n   Temp$ = \"\"\r\n   TxtLength = LEN(Txt$)\r\n\r\n   FOR I = 1 TO TxtLength     ' Isolate each character in\r\n      C$ = MID$(Txt$, I, 1)   ' the string.\r\n\r\n      ' If the character is in the filter string, save it:\r\n      IF INSTR(FilterString$, C$) <> 0 THEN\r\n         Temp$ = Temp$ + C$\r\n      END IF\r\n   NEXT I\r\n\r\n   Filter$ = Temp$\r\nEND FUNCTION\r\n"},253:function(e,n,t){},38:function(e,n,t){"use strict";var r,o;function s(e){return[r.INTEGER,r.LONG,r.SINGLE,r.DOUBLE].includes(p(e))}function a(e){return p(e)===r.STRING}function i(e){return s(e)||a(e)}function u(e){return p(e)===r.UDT}function c(e,n){return s(e)&&s(n)||a(e)&&a(n)}function p(e){return"object"===typeof e?e.type:e}Object.defineProperty(n,"__esModule",{value:!0}),n.ProcDefType=n.procTypeName=n.isFnOrDefFn=n.ProcType=n.typeSpecName=n.areMatchingSingularTypes=n.areMatchingElementaryTypes=n.isSingularType=n.isUdt=n.isElementaryType=n.isArray=n.isString=n.isIntegral=n.isNumeric=n.arraySpec=n.stringSpec=n.doubleSpec=n.singleSpec=n.longSpec=n.integerSpec=n.DataType=void 0,function(e){e.INTEGER="integer",e.LONG="long",e.SINGLE="single",e.DOUBLE="double",e.STRING="string",e.ARRAY="array",e.UDT="udt"}(r=n.DataType||(n.DataType={})),n.integerSpec=function(){return{type:r.INTEGER}},n.longSpec=function(){return{type:r.LONG}},n.singleSpec=function(){return{type:r.SINGLE}},n.doubleSpec=function(){return{type:r.DOUBLE}},n.stringSpec=function(){return{type:r.STRING}},n.arraySpec=function(e,n){return{type:r.ARRAY,elementTypeSpec:e,dimensionSpecs:n}},n.isNumeric=s,n.isIntegral=function(e){return[r.INTEGER,r.LONG].includes(p(e))},n.isString=a,n.isArray=function(e){return p(e)===r.ARRAY},n.isElementaryType=i,n.isUdt=u,n.isSingularType=function(e){return i(e)||u(e)},n.areMatchingElementaryTypes=c,n.areMatchingSingularTypes=function(e,n){return c(e,n)||u(e)&&u(n)&&e.name===n.name},n.typeSpecName=function e(n){switch(n.type){case r.ARRAY:return e(n.elementTypeSpec)+" array";case r.UDT:return'"'+n.name+'"';default:return n.type}},function(e){e.SUB="sub",e.FN="fn",e.DEF_FN="defFn"}(o=n.ProcType||(n.ProcType={})),n.isFnOrDefFn=function(e){return e===o.FN||e===o.DEF_FN},n.procTypeName=function(e){var n;return((n={})[o.SUB]="SUB procedure",n[o.FN]="FUNCTION procedure",n[o.DEF_FN]="DEF FN procedure",n)[e]},function(e){e.BUILTIN="builtin",e.MODULE="module"}(n.ProcDefType||(n.ProcDefType={}))},668:function(e,n,t){"use strict";var r=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(o,s){function a(e){try{u(r.next(e))}catch(n){s(n)}}function i(e){try{u(r.throw(e))}catch(n){s(n)}}function u(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,i)}u((r=r.apply(e,n||[])).next())}))},o=this&&this.__generator||function(e,n){var t,r,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=n.call(e,a)}catch(i){s=[6,i],r=0}finally{t=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var a=t(81),i=s(t(683)),u=s(t(685)),c=s(t(688));n.default=function(e){var n=e.source,t=e.sourceFileName,s=void 0===t?"source.bas":t,p=e.enableBundling,l=e.enableMinify;return r(this,void 0,void 0,(function(){var e,t,r,m,f,d,y,h;return o(this,(function(o){switch(o.label){case 0:if(!(e=u.default(n,{sourceFileName:s})))throw new Error("Invalid parse tree");return c.default(e,{sourceFileName:s}),t=i.default(e,{sourceFileName:s,enableBundling:p}),r=t.code,m=t.map,f=m.toString(),l?[4,a.minify(r,{sourceMap:{filename:s,content:f}})]:[3,2];case 1:d=o.sent(),y=d.code,h=d.map,y&&h&&(r=y,f=h),o.label=2;case 2:return[2,{source:n,code:r,map:f,astModule:e}]}}))}))}},683:function(e,n,t){"use strict";var r,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)},a=this&&this.__spreadArray||function(e,n){for(var t=0,r=n.length,o=e.length;t<r;t++,o++)e[o]=n[t];return e},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.CodeGenerator=void 0;var u=i(t(34)),c=t(114),p=t(132),l=t(95),m=t(38),f=t(96),d=t(684).default,y=((r={})[p.BinaryOp.ADD]="+",r[p.BinaryOp.SUB]="-",r[p.BinaryOp.MUL]="*",r[p.BinaryOp.DIV]="/",r[p.BinaryOp.MOD]="%",r[p.BinaryOp.AND]="&&",r[p.BinaryOp.OR]="||",r[p.BinaryOp.EQ]="===",r[p.BinaryOp.NE]="!=",r[p.BinaryOp.GT]=">",r[p.BinaryOp.GTE]=">=",r[p.BinaryOp.LT]="<",r[p.BinaryOp.LTE]="<=",r),h=function(e){function n(n,t){void 0===t&&(t={});var r=e.call(this)||this;return r.module=n,r.openForStmtStates=[],r.openLoopStmtStates=[],r.indent=0,r.nextGeneratedLabelIdx=1,r.opts=s({sourceFileName:"",indentWidth:4,enableBundling:!1},t),r.sourceFileName=r.opts.sourceFileName,r}return o(n,e),n.prototype.run=function(){var e=this.visitModule(this.module);return this.bundle(e).toStringWithSourceMap()},n.prototype.bundle=function(e){var n=new c.SourceNode;return this.opts.enableBundling?(n.add("#!/usr/bin/env node\n\n"),n.add(e),n.add(d)):(n.add(e),n.add("module.exports = compiledModule;\n")),n},n.prototype.visitModule=function(e){this.indent=0;var n=[];return n.push(this.lines("const compiledModule = {",1,"sourceFileName: "+JSON.stringify(this.opts.sourceFileName)+",","localSymbols: "+JSON.stringify(e.localSymbols)+",","globalSymbols: "+JSON.stringify(e.globalSymbols)+",","")),n.push(this.lines("stmts: [","",1),this.visitStmts(e.stmts),this.lines(-1,"],","")),n.push(this.lines("procs: [","",1),this.acceptAll(e.procs),this.lines(-1,"],","")),n.push(this.lines(-1,"};","")),new c.SourceNode(null,null,this.opts.sourceFileName,u.default.flattenDeep(n))},n.prototype.visitProc=function(e){var n=[];return n.push(this.lines("{",1,this.generateLoc(e),"type: '"+e.type+"',","name: '"+e.name+"',","localSymbols: "+JSON.stringify(e.localSymbols)+",","paramSymbols: "+JSON.stringify(e.paramSymbols)+",","stmts: [","",1),this.visitStmts(e.stmts),this.lines(-1,"],",-1,"},","")),this.createSourceNode.apply(this,a([e],n))},n.prototype.visitStmts=function(e){var n=this.openForStmtStates.length,t=this.acceptAll(e);return this.openForStmtStates.length>n&&this.throwError("FOR statement without corresponding NEXT statement",this.openForStmtStates[this.openForStmtStates.length-1].forStmt),t},n.prototype.visitLabelStmt=function(e){return this.createSourceNode(e,this.generateLabelStmt(e,e.label))},n.prototype.visitDimStmt=function(e){for(var n=this,t=[],r=0,o=e.varDecls;r<o.length;r++){var s=o[r],i=s.typeExpr,u=s.symbol.typeSpec;switch(i.type){case p.DataTypeExprType.ARRAY:if(m.isArray(u)||this.throwError("Mismatch types: expected array, got "+u.type,s),e.dimType===p.DimType.SHARED&&0===i.dimensionSpecExprs.length)continue;t.push.apply(t,a(a([this.generateVarRefCode(s,s.symbol),".init(",JSON.stringify(u.elementTypeSpec),", ["],i.dimensionSpecExprs.map((function(e){var t=e.minIdxExpr,r=e.maxIdxExpr;return["[",t?n.accept(t):"0",", ",n.accept(r),"],"]}))),["]); "]))}}return t.length>0?this.createStmtSourceNode(e,(function(){return t})):new c.SourceNode},n.prototype.visitAssignStmt=function(e){var n=this;return this.createStmtSourceNode(e,(function(){return[n.accept(e.targetExpr)," = ",n.generateAssignableValueCode(e.valueExpr,e.targetExpr.typeSpec),";"]}))},n.prototype.visitConstStmt=function(e){var n=this;return this.createStmtSourceNode(e,(function(){return a([],u.default.flatMap(e.constDefs,(function(e){return[n.generateVarRefCode(e,e.symbol)+" = ",n.accept(e.valueExpr),"; "]})))}))},n.prototype.visitGotoStmt=function(e){var n=this;return this.createStmtSourceNode(e,(function(){return n.generateGotoCode(e.destLabel)}))},n.prototype.visitIfStmt=function(e){var n=this;return this.visitCondStmt(e,this.generateLabel(),(function(e){return n.accept(e.condExpr)}))},n.prototype.visitSelectStmt=function(e){var n=this,t=this.generateLabel(),r=this.generateTempVarRef(t+"_test");return this.createSourceNode(e,this.createStmtSourceNode(e,(function(){return[r+" = ",n.accept(e.testExpr),";"]})),this.visitCondStmt(e,t,(function(t){for(var o=[],s=0;s<t.condExprs.length;++s){var a=t.condExprs[s];switch(s>0&&o.push(" || "),a.type){case p.CaseExprType.VALUE:o.push(r+" === ",n.accept(a.valueExpr));break;case p.CaseExprType.RANGE:o.push("("+r+" >= ",n.accept(a.lowerBoundExpr)," && "+r+" <= ",n.accept(a.upperBoundExpr),")");break;case p.CaseExprType.COMP:o.push(r+" "+y[a.op]+" ",n.accept(a.rightExpr));break;default:n.throwError("Unknown case expression type: "+JSON.stringify(a),e)}}return o})),this.createStmtSourceNode(e,(function(){return"delete "+r+";"})))},n.prototype.visitCondStmt=function(e,n,t){for(var r=this,o=[],s=1;s<e.ifBranches.length;++s)o.push({node:e.ifBranches[s],label:n+"_elif"+s});e.elseBranch&&e.elseBranch.stmts.length>0&&o.push({node:e.elseBranch,label:n+"_else"});var i=n+"_endif";o.push({node:null,label:i});for(var c=[],p=0,l=function(e){var n=o[p],s=n.node,a=n.label;c.push(m.createStmtSourceNode(e,(function(){return u.default.flattenDeep(["if (!(",t(e),")) { "+r.generateGotoCode(a)+" }"])}))),++m.indent,c.push(m.visitStmts(e.stmts)),p<o.length-1&&c.push(m.createStmtSourceNode(e,(function(){return r.generateGotoCode(i)}))),--m.indent,c.push(m.generateLabelStmt(s,a)),++p},m=this,f=0,d=e.ifBranches;f<d.length;f++){l(d[f])}return e.elseBranch&&e.elseBranch.stmts.length>0&&(++this.indent,c.push(this.visitStmts(e.elseBranch.stmts)),--this.indent,c.push(this.generateLabelStmt(null,i))),this.createSourceNode.apply(this,a([e],c))},n.prototype.visitCondLoopStmt=function(e){var n=this,t=this.generateLabel(),r=t+"_loopStart",o=t+"_loopEnd",s=e.isCondNegated?[this.accept(e.condExpr)]:["!(",this.accept(e.condExpr),")"],i=this.createStmtSourceNode(e,(function(){return a(a(["if ("],s),[") { "+n.generateGotoCode(o)+" }"])}));++this.indent,this.openLoopStmtStates.push({loopStmt:e,endLabel:o});var u=this.visitStmts(e.stmts);this.openLoopStmtStates.pop(),--this.indent;var c=[];switch(c.push(this.generateLabelStmt(e,r)),e.structure){case p.CondLoopStructure.COND_EXPR_BEFORE_STMTS:c.push(i,u);break;case p.CondLoopStructure.COND_EXPR_AFTER_STMTS:c.push(u,i);break;default:this.throwError("Unexpected loop structure: "+JSON.stringify(e),e)}return c.push(this.createStmtSourceNode(e,(function(){return n.generateGotoCode(r)})),this.generateLabelStmt(e,o)),this.createSourceNode.apply(this,a([e],c))},n.prototype.visitUncondLoopStmt=function(e){var n=this,t=this.generateLabel(),r=t+"_loopStart",o=t+"_loopEnd",s=[];return s.push(this.generateLabelStmt(e,r)),++this.indent,this.openLoopStmtStates.push({loopStmt:e,endLabel:o}),s.push(this.visitStmts(e.stmts)),this.openLoopStmtStates.pop(),--this.indent,s.push(this.createStmtSourceNode(e,(function(){return n.generateGotoCode(r)})),this.generateLabelStmt(e,o)),this.createSourceNode.apply(this,a([e],s))},n.prototype.visitExitLoopStmt=function(e){var n=this;return 0===this.openLoopStmtStates.length&&this.throwError("EXIT DO statement outside DO loop",e),this.createStmtSourceNode(e,(function(){return n.generateGotoCode(n.openLoopStmtStates[n.openLoopStmtStates.length-1].endLabel)}))},n.prototype.visitForStmt=function(e){var n=this,t=this.generateLabel(),r=t+"_loopStart",o=t+"_loopEnd",s=this.generateTempVarRef(t+"_step"),i=this.generateTempVarRef(t+"_end");this.openForStmtStates.push({forStmt:e,startLabel:r,endLabel:o,stepValue:s,endValue:i});var u=[];return u.push(this.createStmtSourceNode(e,(function(){return a(a(a([],[n.accept(e.counterExpr)," = ",n.accept(e.startExpr),"; "]),[s+" = ",e.stepExpr?n.accept(e.stepExpr):"1","; "]),[i+" = ",n.accept(e.endExpr),";"])})),this.generateLabelStmt(e,r)),++this.indent,u.push(this.createStmtSourceNode(e,(function(){return a(a([],["const counterValue = ",n.accept(e.counterExpr),"; "]),["if (","("+s+" >= 0 && counterValue > "+i+") || ","("+s+" < 0 && counterValue < "+i+")",") { "+n.generateGotoCode(o)+" }"])}))),this.createSourceNode.apply(this,a([e],u))},n.prototype.visitNextStmt=function(e){var n=this,t=e.counterExprs.length||1;t>this.openForStmtStates.length&&this.throwError("NEXT statement without corresponding FOR statement",e);for(var r=0;r<e.counterExprs.length;++r){var o=this.accept(e.counterExprs[r]).toString(),s=this.openForStmtStates[this.openForStmtStates.length-1-r].forStmt;o!==this.accept(s.counterExpr).toString()&&this.throwError("Counter #"+(r+1)+" does not match corresponding FOR statement",e)}var i=[],u=function(t){var r=c.openForStmtStates.pop(),o=r.forStmt,s=r.startLabel,a=r.endLabel,u=r.stepValue,p=r.endValue;i.push(c.createStmtSourceNode(e,(function(){return[n.accept(o.counterExpr)," += "+u+"; ",n.generateGotoCode(s)]}))),--c.indent,i.push(c.generateLabelStmt(o,a)),i.push(c.createStmtSourceNode(o,(function(){return"delete "+u+"; delete "+p+";"})))},c=this;for(r=0;r<t;++r)u();return this.createSourceNode.apply(this,a([e],i))},n.prototype.visitExitForStmt=function(e){var n=this;return 0===this.openForStmtStates.length&&this.throwError("EXIT FOR statement outside FOR loop",e),this.createStmtSourceNode(e,(function(){return n.generateGotoCode(n.openForStmtStates[n.openForStmtStates.length-1].endLabel)}))},n.prototype.visitGosubStmt=function(e){return this.createStmtSourceNode(e,(function(){return"return { type: '"+f.ExecutionDirectiveType.GOSUB+"', destLabel: '"+e.destLabel+"' };"}))},n.prototype.visitReturnStmt=function(e){return this.createStmtSourceNode(e,(function(){return"return { type: '"+f.ExecutionDirectiveType.RETURN+"'"+(e.destLabel?", destLabel: '"+e.destLabel+"'":"")+" };"}))},n.prototype.visitCallStmt=function(e){var n=this;return this.createStmtSourceNode(e,(function(){return[n.visitProcCall(e),";"]}))},n.prototype.visitExitProcStmt=function(e){return this.createStmtSourceNode(e,(function(){return"return { type: '"+f.ExecutionDirectiveType.EXIT_PROC+"' };"}))},n.prototype.visitEndStmt=function(e){return this.createStmtSourceNode(e,(function(){return"return { type: '"+f.ExecutionDirectiveType.END+"' };"}))},n.prototype.visitSwapStmt=function(e){var n=this,t=this.generateLabel()+"_temp";return this.createStmtSourceNode(e,(function(){return[n.generateTempVarRef(t)," = ",n.accept(e.leftExpr),"; ",n.accept(e.leftExpr)," = ",n.accept(e.rightExpr),"; ",n.accept(e.rightExpr)," = ",n.generateTempVarRef(t),"; ","delete ",n.generateTempVarRef(t),";"]}))},n.prototype.visitPrintStmt=function(e){var n=this;return this.createStmtSourceNode(e,(function(){return a(a(["await ctx.runtime.print(",e.formatExpr?n.accept(e.formatExpr):"null",", "],e.args.map((function(e){return"string"===typeof e?"{ type: '"+e+"' }, ":n.createSourceNode(e,"{ type: '"+f.PrintArgType.VALUE+"', value: ",n.accept(e)," }, ")}))),[");"])}))},n.prototype.visitInputStmt=function(e){var n=this;return this.createStmtSourceNode(e,(function(){switch(e.inputType){case p.InputType.TOKENIZED:return a(["const results = await ctx.runtime.input(",JSON.stringify(e.prompt)+", ",e.targetExprs.map((function(e){return JSON.stringify(e.typeSpec)})).join(", "),"); "],e.targetExprs.map((function(e,t){return n.createSourceNode(e,n.accept(e)," = results["+t+"]; ")})));case p.InputType.LINE:return n.createSourceNode(e.targetExprs[0],n.accept(e.targetExprs[0])," = await ctx.runtime.inputLine("+JSON.stringify(e.prompt)+");");default:n.throwError("Unknown input type: "+JSON.stringify(e.inputType),e)}}))},n.prototype.visitDefTypeStmt=function(e){return new c.SourceNode},n.prototype.visitDataStmt=function(e){return this.createSourceNode(e,this.lines("{",1,this.generateLoc(e),"data: "+JSON.stringify(e.data)+",",-1,"},",""))},n.prototype.visitReadStmt=function(e){var n=this;return this.createStmtSourceNode(e,(function(){return a(["const results = await ctx.read(",e.targetExprs.map((function(e){return JSON.stringify(e.typeSpec)})).join(", "),"); "],e.targetExprs.map((function(e,t){return n.createSourceNode(e,n.accept(e)," = results["+t+"]; ")})))}))},n.prototype.visitRestoreStmt=function(e){return this.createStmtSourceNode(e,(function(){return"ctx.restore("+(e.destLabel?"'"+e.destLabel+"'":"")+");"}))},n.prototype.createStmtSourceNode=function(e,n){return this.createSourceNode(e,this.lines("{",1,""),this.lines(this.generateLoc(e),""),this.lines("async run(ctx) { "),n()," },\n",this.lines(-1,"},",""))},n.prototype.visitLiteralExpr=function(e){var n;return"string"===typeof e.value?n=JSON.stringify(e.value):"number"===typeof e.value?n=""+e.value:this.throwError("Unrecognized literal value: "+JSON.stringify(e.value),e),this.createSourceNode(e,n)},n.prototype.visitVarRefExpr=function(e){return this.createSourceNode(e,this.generateVarRefCode(e,e.symbol))},n.prototype.visitFnCallExpr=function(e){return this.visitProcCall(e)},n.prototype.visitBinaryOpExpr=function(e){var n=[];switch(e.op){case p.BinaryOp.EXP:n.push("Math.pow(",this.accept(e.leftExpr),", ",this.accept(e.rightExpr),")");break;case p.BinaryOp.INTDIV:n.push("Math.floor(",this.accept(e.leftExpr)," / ",this.accept(e.rightExpr),")");break;default:n.push("(",this.accept(e.leftExpr)," "+y[e.op]+" ",this.accept(e.rightExpr),")")}return this.createSourceNode.apply(this,a([e],n))},n.prototype.visitUnaryOpExpr=function(e){var n,t=((n={})[p.UnaryOp.NEG]="-",n[p.UnaryOp.NOT]="!",n[p.UnaryOp.PARENS]="",n);return this.createSourceNode(e,"(",t[e.op],this.accept(e.rightExpr),")")},n.prototype.visitSubscriptExpr=function(e){var n=this;return this.createSourceNode.apply(this,a([e,this.accept(e.arrayExpr),".values"],e.indexExprs.map((function(t,r){return["[",n.generateSubscriptCode(e.arrayExpr,r,t),"]"]}))))},n.prototype.generateSubscriptCode=function(e,n,t){return[this.accept(e),".getIdx("+n+", ",this.accept(t),")"]},n.prototype.visitMemberExpr=function(e){return this.createSourceNode(e,this.accept(e.udtExpr),".values['"+e.fieldName+"']")},n.prototype.visitProcCall=function(e){for(var n,t=this,r=[],o=[],i=null,u=0,c=0;c<e.argExprs.length;++c){var f=e.argExprs[c],d=e.argTypeProps[c],y=d.paramTypeSpec;if(d.shouldPassByRef)switch(f.type){case p.ExprType.VAR_REF:r.push(this.createSourceNode(f,f.symbol.varType===l.VarType.ARG?"ctx.args['"+f.symbol.name+"']":"["+this.generateVarContainerCode(f,f.symbol)+", '"+f.symbol.name+"']"));break;case p.ExprType.SUBSCRIPT:var h=this.accept(s(s({},f),{indexExprs:f.indexExprs.slice(0,f.indexExprs.length-1)})),x=this.generateSubscriptCode(f.arrayExpr,f.indexExprs.length-1,f.indexExprs[f.indexExprs.length-1]);r.push(this.createSourceNode(f,"[",h,", ",x,"]"));break;case p.ExprType.MEMBER:r.push(this.createSourceNode(f,"[",this.accept(f.udtExpr),".values, ","'"+f.fieldName+"']"));break;default:this.throwError("Unknown pass-by-reference expression type: "+JSON.stringify(f),f)}else{i||(i=this.generateLabel());var b=i+"_"+u++;o.push({name:b,argExpr:f,paramTypeSpec:y}),r.push("[ctx.tempVars, '"+b+"']")}}var S=((n={})[m.ProcDefType.BUILTIN]="ctx.runtime.executeBuiltinProc('"+e.name+"', "+JSON.stringify(e.argExprs.map((function(e){return e.typeSpec}))),n[m.ProcDefType.MODULE]="ctx.executeProc(ctx, '"+e.name+"'",n);return this.createSourceNode.apply(this,a(a([e,"(await (async () => {\n",this.lines(1)],o.map((function(e){var n=e.name,r=e.argExpr,o=e.paramTypeSpec;return[t.lines(t.generateTempVarRef(n)+" = "),t.generateAssignableValueCode(r,o),";\n"]}))),[this.lines.apply(this,a(a(["const result = await "+S[e.procDefType]+", "+r.join(", ")+");"],o.map((function(e){var n=e.name;return"delete "+t.generateTempVarRef(n)+";"}))),["return result;",-1,"})())"]))]))},n.prototype.createSourceNode=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return new c.SourceNode(e.loc.line,e.loc.col,this.opts.sourceFileName,u.default.flattenDeep(n))},n.prototype.lines=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var t=[],r=0,o=e;r<o.length;r++){var s=o[r];if("string"===typeof s){var a=s?" ".repeat(this.opts.indentWidth*this.indent):"";t.push(a+s)}else{if("number"!==typeof s)throw new Error("Unexpected line value: "+JSON.stringify(s));this.indent+=s}}return t.join("\n")},n.prototype.generateLabel=function(){return"$"+this.nextGeneratedLabelIdx++},n.prototype.generateLoc=function(e){return e.loc?"loc: ["+e.loc.line+", "+e.loc.col+"],":""},n.prototype.generateLabelStmt=function(e,n){return this.lines.apply(this,a(a(["{",1],e?[this.generateLoc(e)]:[]),["label: '"+n+"',",-1,"},",""]))},n.prototype.generateVarRefCode=function(e,n){var t=this.generateVarContainerCode(e,n);return n.varType===l.VarType.ARG?t+"['"+n.name+"'][0]["+t+"['"+n.name+"'][1]]":t+"['"+n.name+"']"},n.prototype.generateVarContainerCode=function(e,n){if(n.varType===l.VarType.ARG)return"ctx.args";if(n.varScope===l.VarScope.LOCAL)switch(n.varType){case l.VarType.STATIC_VAR:return"ctx.localStaticVars";case l.VarType.VAR:case l.VarType.CONST:return"ctx.localVars";default:this.throwError("Unexpected local var type: "+JSON.stringify(n.varType),e)}else{if(n.varScope===l.VarScope.GLOBAL)return"ctx.globalVars";this.throwError("Unknown variable type or scope: "+JSON.stringify(n),e)}},n.prototype.generateAssignableValueCode=function(e,n){var t=e.typeSpec,r=this.accept(e);return m.isIntegral(n)&&!m.isIntegral(t)?["ctx.runtime.roundHalfToEven(",r,")"]:m.isUdt(n)?[r,".clone()"]:r},n.prototype.generateGotoCode=function(e){return"return { type: '"+f.ExecutionDirectiveType.GOTO+"', destLabel: '"+e+"' };"},n.prototype.generateTempVarRef=function(e){return"ctx.tempVars['"+e+"']"},n}(p.AstVisitor);n.CodeGenerator=h,n.default=function(e,n){return void 0===n&&(n={}),new h(e,n).run()}},684:function(e,n){e.exports={default:"/******/ (() => { // webpackBootstrap\n/******/ \tvar __webpack_modules__ = ({\n\n/***/ 575:\n/***/ ((module) => {\n\n\"use strict\";\n\nconst ansiEscapes = module.exports;\n// TODO: remove this in the next major version\nmodule.exports.default = ansiEscapes;\n\nconst ESC = '\\u001B[';\nconst OSC = '\\u001B]';\nconst BEL = '\\u0007';\nconst SEP = ';';\nconst isTerminalApp = process.env.TERM_PROGRAM === 'Apple_Terminal';\n\nansiEscapes.cursorTo = (x, y) => {\n\tif (typeof x !== 'number') {\n\t\tthrow new TypeError('The `x` argument is required');\n\t}\n\n\tif (typeof y !== 'number') {\n\t\treturn ESC + (x + 1) + 'G';\n\t}\n\n\treturn ESC + (y + 1) + ';' + (x + 1) + 'H';\n};\n\nansiEscapes.cursorMove = (x, y) => {\n\tif (typeof x !== 'number') {\n\t\tthrow new TypeError('The `x` argument is required');\n\t}\n\n\tlet ret = '';\n\n\tif (x < 0) {\n\t\tret += ESC + (-x) + 'D';\n\t} else if (x > 0) {\n\t\tret += ESC + x + 'C';\n\t}\n\n\tif (y < 0) {\n\t\tret += ESC + (-y) + 'A';\n\t} else if (y > 0) {\n\t\tret += ESC + y + 'B';\n\t}\n\n\treturn ret;\n};\n\nansiEscapes.cursorUp = (count = 1) => ESC + count + 'A';\nansiEscapes.cursorDown = (count = 1) => ESC + count + 'B';\nansiEscapes.cursorForward = (count = 1) => ESC + count + 'C';\nansiEscapes.cursorBackward = (count = 1) => ESC + count + 'D';\n\nansiEscapes.cursorLeft = ESC + 'G';\nansiEscapes.cursorSavePosition = isTerminalApp ? '\\u001B7' : ESC + 's';\nansiEscapes.cursorRestorePosition = isTerminalApp ? '\\u001B8' : ESC + 'u';\nansiEscapes.cursorGetPosition = ESC + '6n';\nansiEscapes.cursorNextLine = ESC + 'E';\nansiEscapes.cursorPrevLine = ESC + 'F';\nansiEscapes.cursorHide = ESC + '?25l';\nansiEscapes.cursorShow = ESC + '?25h';\n\nansiEscapes.eraseLines = count => {\n\tlet clear = '';\n\n\tfor (let i = 0; i < count; i++) {\n\t\tclear += ansiEscapes.eraseLine + (i < count - 1 ? ansiEscapes.cursorUp() : '');\n\t}\n\n\tif (count) {\n\t\tclear += ansiEscapes.cursorLeft;\n\t}\n\n\treturn clear;\n};\n\nansiEscapes.eraseEndLine = ESC + 'K';\nansiEscapes.eraseStartLine = ESC + '1K';\nansiEscapes.eraseLine = ESC + '2K';\nansiEscapes.eraseDown = ESC + 'J';\nansiEscapes.eraseUp = ESC + '1J';\nansiEscapes.eraseScreen = ESC + '2J';\nansiEscapes.scrollUp = ESC + 'S';\nansiEscapes.scrollDown = ESC + 'T';\n\nansiEscapes.clearScreen = '\\u001Bc';\n\nansiEscapes.clearTerminal = process.platform === 'win32' ?\n\t`${ansiEscapes.eraseScreen}${ESC}0f` :\n\t// 1. Erases the screen (Only done in case `2` is not supported)\n\t// 2. Erases the whole screen including scrollback buffer\n\t// 3. Moves cursor to the top-left position\n\t// More info: https://www.real-world-systems.com/docs/ANSIcode.html\n\t`${ansiEscapes.eraseScreen}${ESC}3J${ESC}H`;\n\nansiEscapes.beep = BEL;\n\nansiEscapes.link = (text, url) => {\n\treturn [\n\t\tOSC,\n\t\t'8',\n\t\tSEP,\n\t\tSEP,\n\t\turl,\n\t\tBEL,\n\t\ttext,\n\t\tOSC,\n\t\t'8',\n\t\tSEP,\n\t\tSEP,\n\t\tBEL\n\t].join('');\n};\n\nansiEscapes.image = (buffer, options = {}) => {\n\tlet ret = `${OSC}1337;File=inline=1`;\n\n\tif (options.width) {\n\t\tret += `;width=${options.width}`;\n\t}\n\n\tif (options.height) {\n\t\tret += `;height=${options.height}`;\n\t}\n\n\tif (options.preserveAspectRatio === false) {\n\t\tret += ';preserveAspectRatio=0';\n\t}\n\n\treturn ret + ':' + buffer.toString('base64') + BEL;\n};\n\nansiEscapes.iTerm = {\n\tsetCwd: (cwd = process.cwd()) => `${OSC}50;CurrentDir=${cwd}${BEL}`,\n\n\tannotation: (message, options = {}) => {\n\t\tlet ret = `${OSC}1337;`;\n\n\t\tconst hasX = typeof options.x !== 'undefined';\n\t\tconst hasY = typeof options.y !== 'undefined';\n\t\tif ((hasX || hasY) && !(hasX && hasY && typeof options.length !== 'undefined')) {\n\t\t\tthrow new Error('`x`, `y` and `length` must be defined when `x` or `y` is defined');\n\t\t}\n\n\t\tmessage = message.replace(/\\|/g, '');\n\n\t\tret += options.isHidden ? 'AddHiddenAnnotation=' : 'AddAnnotation=';\n\n\t\tif (options.length > 0) {\n\t\t\tret +=\n\t\t\t\t\t(hasX ?\n\t\t\t\t\t\t[message, options.length, options.x, options.y] :\n\t\t\t\t\t\t[options.length, message]).join('|');\n\t\t} else {\n\t\t\tret += message;\n\t\t}\n\n\t\treturn ret + BEL;\n\t}\n};\n\n\n/***/ }),\n\n/***/ 566:\n/***/ ((module, __unused_webpack_exports, __nccwpck_require__) => {\n\n\"use strict\";\n/* module decorator */ module = __nccwpck_require__.nmd(module);\n\n\nconst ANSI_BACKGROUND_OFFSET = 10;\n\nconst wrapAnsi256 = (offset = 0) => code => `\\u001B[${38 + offset};5;${code}m`;\n\nconst wrapAnsi16m = (offset = 0) => (red, green, blue) => `\\u001B[${38 + offset};2;${red};${green};${blue}m`;\n\nfunction assembleStyles() {\n\tconst codes = new Map();\n\tconst styles = {\n\t\tmodifier: {\n\t\t\treset: [0, 0],\n\t\t\t// 21 isn't widely supported and 22 does the same thing\n\t\t\tbold: [1, 22],\n\t\t\tdim: [2, 22],\n\t\t\titalic: [3, 23],\n\t\t\tunderline: [4, 24],\n\t\t\toverline: [53, 55],\n\t\t\tinverse: [7, 27],\n\t\t\thidden: [8, 28],\n\t\t\tstrikethrough: [9, 29]\n\t\t},\n\t\tcolor: {\n\t\t\tblack: [30, 39],\n\t\t\tred: [31, 39],\n\t\t\tgreen: [32, 39],\n\t\t\tyellow: [33, 39],\n\t\t\tblue: [34, 39],\n\t\t\tmagenta: [35, 39],\n\t\t\tcyan: [36, 39],\n\t\t\twhite: [37, 39],\n\n\t\t\t// Bright color\n\t\t\tblackBright: [90, 39],\n\t\t\tredBright: [91, 39],\n\t\t\tgreenBright: [92, 39],\n\t\t\tyellowBright: [93, 39],\n\t\t\tblueBright: [94, 39],\n\t\t\tmagentaBright: [95, 39],\n\t\t\tcyanBright: [96, 39],\n\t\t\twhiteBright: [97, 39]\n\t\t},\n\t\tbgColor: {\n\t\t\tbgBlack: [40, 49],\n\t\t\tbgRed: [41, 49],\n\t\t\tbgGreen: [42, 49],\n\t\t\tbgYellow: [43, 49],\n\t\t\tbgBlue: [44, 49],\n\t\t\tbgMagenta: [45, 49],\n\t\t\tbgCyan: [46, 49],\n\t\t\tbgWhite: [47, 49],\n\n\t\t\t// Bright color\n\t\t\tbgBlackBright: [100, 49],\n\t\t\tbgRedBright: [101, 49],\n\t\t\tbgGreenBright: [102, 49],\n\t\t\tbgYellowBright: [103, 49],\n\t\t\tbgBlueBright: [104, 49],\n\t\t\tbgMagentaBright: [105, 49],\n\t\t\tbgCyanBright: [106, 49],\n\t\t\tbgWhiteBright: [107, 49]\n\t\t}\n\t};\n\n\t// Alias bright black as gray (and grey)\n\tstyles.color.gray = styles.color.blackBright;\n\tstyles.bgColor.bgGray = styles.bgColor.bgBlackBright;\n\tstyles.color.grey = styles.color.blackBright;\n\tstyles.bgColor.bgGrey = styles.bgColor.bgBlackBright;\n\n\tfor (const [groupName, group] of Object.entries(styles)) {\n\t\tfor (const [styleName, style] of Object.entries(group)) {\n\t\t\tstyles[styleName] = {\n\t\t\t\topen: `\\u001B[${style[0]}m`,\n\t\t\t\tclose: `\\u001B[${style[1]}m`\n\t\t\t};\n\n\t\t\tgroup[styleName] = styles[styleName];\n\n\t\t\tcodes.set(style[0], style[1]);\n\t\t}\n\n\t\tObject.defineProperty(styles, groupName, {\n\t\t\tvalue: group,\n\t\t\tenumerable: false\n\t\t});\n\t}\n\n\tObject.defineProperty(styles, 'codes', {\n\t\tvalue: codes,\n\t\tenumerable: false\n\t});\n\n\tstyles.color.close = '\\u001B[39m';\n\tstyles.bgColor.close = '\\u001B[49m';\n\n\tstyles.color.ansi256 = wrapAnsi256();\n\tstyles.color.ansi16m = wrapAnsi16m();\n\tstyles.bgColor.ansi256 = wrapAnsi256(ANSI_BACKGROUND_OFFSET);\n\tstyles.bgColor.ansi16m = wrapAnsi16m(ANSI_BACKGROUND_OFFSET);\n\n\t// From https://github.com/Qix-/color-convert/blob/3f0e0d4e92e235796ccb17f6e85c72094a651f49/conversions.js\n\tObject.defineProperties(styles, {\n\t\trgbToAnsi256: {\n\t\t\tvalue: (red, green, blue) => {\n\t\t\t\t// We use the extended greyscale palette here, with the exception of\n\t\t\t\t// black and white. normal palette only has 4 greyscale shades.\n\t\t\t\tif (red === green && green === blue) {\n\t\t\t\t\tif (red < 8) {\n\t\t\t\t\t\treturn 16;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (red > 248) {\n\t\t\t\t\t\treturn 231;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn Math.round(((red - 8) / 247) * 24) + 232;\n\t\t\t\t}\n\n\t\t\t\treturn 16 +\n\t\t\t\t\t(36 * Math.round(red / 255 * 5)) +\n\t\t\t\t\t(6 * Math.round(green / 255 * 5)) +\n\t\t\t\t\tMath.round(blue / 255 * 5);\n\t\t\t},\n\t\t\tenumerable: false\n\t\t},\n\t\thexToRgb: {\n\t\t\tvalue: hex => {\n\t\t\t\tconst matches = /(?<colorString>[a-f\\d]{6}|[a-f\\d]{3})/i.exec(hex.toString(16));\n\t\t\t\tif (!matches) {\n\t\t\t\t\treturn [0, 0, 0];\n\t\t\t\t}\n\n\t\t\t\tlet {colorString} = matches.groups;\n\n\t\t\t\tif (colorString.length === 3) {\n\t\t\t\t\tcolorString = colorString.split('').map(character => character + character).join('');\n\t\t\t\t}\n\n\t\t\t\tconst integer = Number.parseInt(colorString, 16);\n\n\t\t\t\treturn [\n\t\t\t\t\t(integer >> 16) & 0xFF,\n\t\t\t\t\t(integer >> 8) & 0xFF,\n\t\t\t\t\tinteger & 0xFF\n\t\t\t\t];\n\t\t\t},\n\t\t\tenumerable: false\n\t\t},\n\t\thexToAnsi256: {\n\t\t\tvalue: hex => styles.rgbToAnsi256(...styles.hexToRgb(hex)),\n\t\t\tenumerable: false\n\t\t}\n\t});\n\n\treturn styles;\n}\n\n// Make the export immutable\nObject.defineProperty(module, 'exports', {\n\tenumerable: true,\n\tget: assembleStyles\n});\n\n\n/***/ }),\n\n/***/ 721:\n/***/ ((module) => {\n\nvar hasOwn = Object.prototype.hasOwnProperty;\nvar toString = Object.prototype.toString;\n\nfunction isPlainObject(obj) {\n\tif (!obj || toString.call(obj) !== '[object Object]' || obj.nodeType || obj.setInterval)\n\t\treturn false;\n\n\tvar has_own_constructor = hasOwn.call(obj, 'constructor');\n\tvar has_is_property_of_method = hasOwn.call(obj.constructor.prototype, 'isPrototypeOf');\n\t// Not own constructor property must be Object\n\tif (obj.constructor && !has_own_constructor && !has_is_property_of_method)\n\t\treturn false;\n\n\t// Own properties are enumerated firstly, so to speed up,\n\t// if last one is own, then all properties are own.\n\tvar key;\n\tfor ( key in obj ) {}\n\n\treturn key === undefined || hasOwn.call( obj, key );\n};\n\nmodule.exports = function extend() {\n\tvar options, name, src, copy, copyIsArray, clone,\n\t    target = arguments[0] || {},\n\t    i = 1,\n\t    length = arguments.length,\n\t    deep = false;\n\n\t// Handle a deep copy situation\n\tif ( typeof target === \"boolean\" ) {\n\t\tdeep = target;\n\t\ttarget = arguments[1] || {};\n\t\t// skip the boolean and the target\n\t\ti = 2;\n\t}\n\n\t// Handle case when target is a string or something (possible in deep copy)\n\tif ( typeof target !== \"object\" && typeof target !== \"function\") {\n\t\ttarget = {};\n\t}\n\n\tfor ( ; i < length; i++ ) {\n\t\t// Only deal with non-null/undefined values\n\t\tif ( (options = arguments[ i ]) != null ) {\n\t\t\t// Extend the base object\n\t\t\tfor ( name in options ) {\n\t\t\t\tsrc = target[ name ];\n\t\t\t\tcopy = options[ name ];\n\n\t\t\t\t// Prevent never-ending loop\n\t\t\t\tif ( target === copy ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Recurse if we're merging plain objects or arrays\n\t\t\t\tif ( deep && copy && ( isPlainObject(copy) || (copyIsArray = Array.isArray(copy)) ) ) {\n\t\t\t\t\tif ( copyIsArray ) {\n\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\tclone = src && Array.isArray(src) ? src : [];\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tclone = src && isPlainObject(src) ? src : {};\n\t\t\t\t\t}\n\n\t\t\t\t\t// Never move original objects, clone them\n\t\t\t\t\ttarget[ name ] = extend( deep, clone, copy );\n\n\t\t\t\t// Don't bring in undefined values\n\t\t\t\t} else if ( copy !== undefined ) {\n\t\t\t\t\ttarget[ name ] = copy;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the modified object\n\treturn target;\n};\n\n\n/***/ }),\n\n/***/ 357:\n/***/ (function(module) {\n\n(function(root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define([], factory) /* global define */\n  } else if ( true && module.exports) {\n    module.exports = factory()\n  } else {\n    root.moo = factory()\n  }\n}(this, function() {\n  'use strict';\n\n  var hasOwnProperty = Object.prototype.hasOwnProperty\n  var toString = Object.prototype.toString\n  var hasSticky = typeof new RegExp().sticky === 'boolean'\n\n  /***************************************************************************/\n\n  function isRegExp(o) { return o && toString.call(o) === '[object RegExp]' }\n  function isObject(o) { return o && typeof o === 'object' && !isRegExp(o) && !Array.isArray(o) }\n\n  function reEscape(s) {\n    return s.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&')\n  }\n  function reGroups(s) {\n    var re = new RegExp('|' + s)\n    return re.exec('').length - 1\n  }\n  function reCapture(s) {\n    return '(' + s + ')'\n  }\n  function reUnion(regexps) {\n    if (!regexps.length) return '(?!)'\n    var source =  regexps.map(function(s) {\n      return \"(?:\" + s + \")\"\n    }).join('|')\n    return \"(?:\" + source + \")\"\n  }\n\n  function regexpOrLiteral(obj) {\n    if (typeof obj === 'string') {\n      return '(?:' + reEscape(obj) + ')'\n\n    } else if (isRegExp(obj)) {\n      // TODO: consider /u support\n      if (obj.ignoreCase) throw new Error('RegExp /i flag not allowed')\n      if (obj.global) throw new Error('RegExp /g flag is implied')\n      if (obj.sticky) throw new Error('RegExp /y flag is implied')\n      if (obj.multiline) throw new Error('RegExp /m flag is implied')\n      return obj.source\n\n    } else {\n      throw new Error('Not a pattern: ' + obj)\n    }\n  }\n\n  function objectToRules(object) {\n    var keys = Object.getOwnPropertyNames(object)\n    var result = []\n    for (var i = 0; i < keys.length; i++) {\n      var key = keys[i]\n      var thing = object[key]\n      var rules = [].concat(thing)\n      if (key === 'include') {\n        for (var j = 0; j < rules.length; j++) {\n          result.push({include: rules[j]})\n        }\n        continue\n      }\n      var match = []\n      rules.forEach(function(rule) {\n        if (isObject(rule)) {\n          if (match.length) result.push(ruleOptions(key, match))\n          result.push(ruleOptions(key, rule))\n          match = []\n        } else {\n          match.push(rule)\n        }\n      })\n      if (match.length) result.push(ruleOptions(key, match))\n    }\n    return result\n  }\n\n  function arrayToRules(array) {\n    var result = []\n    for (var i = 0; i < array.length; i++) {\n      var obj = array[i]\n      if (obj.include) {\n        var include = [].concat(obj.include)\n        for (var j = 0; j < include.length; j++) {\n          result.push({include: include[j]})\n        }\n        continue\n      }\n      if (!obj.type) {\n        throw new Error('Rule has no type: ' + JSON.stringify(obj))\n      }\n      result.push(ruleOptions(obj.type, obj))\n    }\n    return result\n  }\n\n  function ruleOptions(type, obj) {\n    if (!isObject(obj)) {\n      obj = { match: obj }\n    }\n    if (obj.include) {\n      throw new Error('Matching rules cannot also include states')\n    }\n\n    // nb. error and fallback imply lineBreaks\n    var options = {\n      defaultType: type,\n      lineBreaks: !!obj.error || !!obj.fallback,\n      pop: false,\n      next: null,\n      push: null,\n      error: false,\n      fallback: false,\n      value: null,\n      type: null,\n      shouldThrow: false,\n    }\n\n    // Avoid Object.assign(), so we support IE9+\n    for (var key in obj) {\n      if (hasOwnProperty.call(obj, key)) {\n        options[key] = obj[key]\n      }\n    }\n\n    // type transform cannot be a string\n    if (typeof options.type === 'string' && type !== options.type) {\n      throw new Error(\"Type transform cannot be a string (type '\" + options.type + \"' for token '\" + type + \"')\")\n    }\n\n    // convert to array\n    var match = options.match\n    options.match = Array.isArray(match) ? match : match ? [match] : []\n    options.match.sort(function(a, b) {\n      return isRegExp(a) && isRegExp(b) ? 0\n           : isRegExp(b) ? -1 : isRegExp(a) ? +1 : b.length - a.length\n    })\n    return options\n  }\n\n  function toRules(spec) {\n    return Array.isArray(spec) ? arrayToRules(spec) : objectToRules(spec)\n  }\n\n  var defaultErrorRule = ruleOptions('error', {lineBreaks: true, shouldThrow: true})\n  function compileRules(rules, hasStates) {\n    var errorRule = null\n    var fast = Object.create(null)\n    var fastAllowed = true\n    var unicodeFlag = null\n    var groups = []\n    var parts = []\n\n    // If there is a fallback rule, then disable fast matching\n    for (var i = 0; i < rules.length; i++) {\n      if (rules[i].fallback) {\n        fastAllowed = false\n      }\n    }\n\n    for (var i = 0; i < rules.length; i++) {\n      var options = rules[i]\n\n      if (options.include) {\n        // all valid inclusions are removed by states() preprocessor\n        throw new Error('Inheritance is not allowed in stateless lexers')\n      }\n\n      if (options.error || options.fallback) {\n        // errorRule can only be set once\n        if (errorRule) {\n          if (!options.fallback === !errorRule.fallback) {\n            throw new Error(\"Multiple \" + (options.fallback ? \"fallback\" : \"error\") + \" rules not allowed (for token '\" + options.defaultType + \"')\")\n          } else {\n            throw new Error(\"fallback and error are mutually exclusive (for token '\" + options.defaultType + \"')\")\n          }\n        }\n        errorRule = options\n      }\n\n      var match = options.match.slice()\n      if (fastAllowed) {\n        while (match.length && typeof match[0] === 'string' && match[0].length === 1) {\n          var word = match.shift()\n          fast[word.charCodeAt(0)] = options\n        }\n      }\n\n      // Warn about inappropriate state-switching options\n      if (options.pop || options.push || options.next) {\n        if (!hasStates) {\n          throw new Error(\"State-switching options are not allowed in stateless lexers (for token '\" + options.defaultType + \"')\")\n        }\n        if (options.fallback) {\n          throw new Error(\"State-switching options are not allowed on fallback tokens (for token '\" + options.defaultType + \"')\")\n        }\n      }\n\n      // Only rules with a .match are included in the RegExp\n      if (match.length === 0) {\n        continue\n      }\n      fastAllowed = false\n\n      groups.push(options)\n\n      // Check unicode flag is used everywhere or nowhere\n      for (var j = 0; j < match.length; j++) {\n        var obj = match[j]\n        if (!isRegExp(obj)) {\n          continue\n        }\n\n        if (unicodeFlag === null) {\n          unicodeFlag = obj.unicode\n        } else if (unicodeFlag !== obj.unicode && options.fallback === false) {\n          throw new Error('If one rule is /u then all must be')\n        }\n      }\n\n      // convert to RegExp\n      var pat = reUnion(match.map(regexpOrLiteral))\n\n      // validate\n      var regexp = new RegExp(pat)\n      if (regexp.test(\"\")) {\n        throw new Error(\"RegExp matches empty string: \" + regexp)\n      }\n      var groupCount = reGroups(pat)\n      if (groupCount > 0) {\n        throw new Error(\"RegExp has capture groups: \" + regexp + \"\\nUse (?: \u2026 ) instead\")\n      }\n\n      // try and detect rules matching newlines\n      if (!options.lineBreaks && regexp.test('\\n')) {\n        throw new Error('Rule should declare lineBreaks: ' + regexp)\n      }\n\n      // store regex\n      parts.push(reCapture(pat))\n    }\n\n\n    // If there's no fallback rule, use the sticky flag so we only look for\n    // matches at the current index.\n    //\n    // If we don't support the sticky flag, then fake it using an irrefutable\n    // match (i.e. an empty pattern).\n    var fallbackRule = errorRule && errorRule.fallback\n    var flags = hasSticky && !fallbackRule ? 'ym' : 'gm'\n    var suffix = hasSticky || fallbackRule ? '' : '|'\n\n    if (unicodeFlag === true) flags += \"u\"\n    var combined = new RegExp(reUnion(parts) + suffix, flags)\n    return {regexp: combined, groups: groups, fast: fast, error: errorRule || defaultErrorRule}\n  }\n\n  function compile(rules) {\n    var result = compileRules(toRules(rules))\n    return new Lexer({start: result}, 'start')\n  }\n\n  function checkStateGroup(g, name, map) {\n    var state = g && (g.push || g.next)\n    if (state && !map[state]) {\n      throw new Error(\"Missing state '\" + state + \"' (in token '\" + g.defaultType + \"' of state '\" + name + \"')\")\n    }\n    if (g && g.pop && +g.pop !== 1) {\n      throw new Error(\"pop must be 1 (in token '\" + g.defaultType + \"' of state '\" + name + \"')\")\n    }\n  }\n  function compileStates(states, start) {\n    var all = states.$all ? toRules(states.$all) : []\n    delete states.$all\n\n    var keys = Object.getOwnPropertyNames(states)\n    if (!start) start = keys[0]\n\n    var ruleMap = Object.create(null)\n    for (var i = 0; i < keys.length; i++) {\n      var key = keys[i]\n      ruleMap[key] = toRules(states[key]).concat(all)\n    }\n    for (var i = 0; i < keys.length; i++) {\n      var key = keys[i]\n      var rules = ruleMap[key]\n      var included = Object.create(null)\n      for (var j = 0; j < rules.length; j++) {\n        var rule = rules[j]\n        if (!rule.include) continue\n        var splice = [j, 1]\n        if (rule.include !== key && !included[rule.include]) {\n          included[rule.include] = true\n          var newRules = ruleMap[rule.include]\n          if (!newRules) {\n            throw new Error(\"Cannot include nonexistent state '\" + rule.include + \"' (in state '\" + key + \"')\")\n          }\n          for (var k = 0; k < newRules.length; k++) {\n            var newRule = newRules[k]\n            if (rules.indexOf(newRule) !== -1) continue\n            splice.push(newRule)\n          }\n        }\n        rules.splice.apply(rules, splice)\n        j--\n      }\n    }\n\n    var map = Object.create(null)\n    for (var i = 0; i < keys.length; i++) {\n      var key = keys[i]\n      map[key] = compileRules(ruleMap[key], true)\n    }\n\n    for (var i = 0; i < keys.length; i++) {\n      var name = keys[i]\n      var state = map[name]\n      var groups = state.groups\n      for (var j = 0; j < groups.length; j++) {\n        checkStateGroup(groups[j], name, map)\n      }\n      var fastKeys = Object.getOwnPropertyNames(state.fast)\n      for (var j = 0; j < fastKeys.length; j++) {\n        checkStateGroup(state.fast[fastKeys[j]], name, map)\n      }\n    }\n\n    return new Lexer(map, start)\n  }\n\n  function keywordTransform(map) {\n    var reverseMap = Object.create(null)\n    var byLength = Object.create(null)\n    var types = Object.getOwnPropertyNames(map)\n    for (var i = 0; i < types.length; i++) {\n      var tokenType = types[i]\n      var item = map[tokenType]\n      var keywordList = Array.isArray(item) ? item : [item]\n      keywordList.forEach(function(keyword) {\n        (byLength[keyword.length] = byLength[keyword.length] || []).push(keyword)\n        if (typeof keyword !== 'string') {\n          throw new Error(\"keyword must be string (in keyword '\" + tokenType + \"')\")\n        }\n        reverseMap[keyword] = tokenType\n      })\n    }\n\n    // fast string lookup\n    // https://jsperf.com/string-lookups\n    function str(x) { return JSON.stringify(x) }\n    var source = ''\n    source += 'switch (value.length) {\\n'\n    for (var length in byLength) {\n      var keywords = byLength[length]\n      source += 'case ' + length + ':\\n'\n      source += 'switch (value) {\\n'\n      keywords.forEach(function(keyword) {\n        var tokenType = reverseMap[keyword]\n        source += 'case ' + str(keyword) + ': return ' + str(tokenType) + '\\n'\n      })\n      source += '}\\n'\n    }\n    source += '}\\n'\n    return Function('value', source) // type\n  }\n\n  /***************************************************************************/\n\n  var Lexer = function(states, state) {\n    this.startState = state\n    this.states = states\n    this.buffer = ''\n    this.stack = []\n    this.reset()\n  }\n\n  Lexer.prototype.reset = function(data, info) {\n    this.buffer = data || ''\n    this.index = 0\n    this.line = info ? info.line : 1\n    this.col = info ? info.col : 1\n    this.queuedToken = info ? info.queuedToken : null\n    this.queuedThrow = info ? info.queuedThrow : null\n    this.setState(info ? info.state : this.startState)\n    this.stack = info && info.stack ? info.stack.slice() : []\n    return this\n  }\n\n  Lexer.prototype.save = function() {\n    return {\n      line: this.line,\n      col: this.col,\n      state: this.state,\n      stack: this.stack.slice(),\n      queuedToken: this.queuedToken,\n      queuedThrow: this.queuedThrow,\n    }\n  }\n\n  Lexer.prototype.setState = function(state) {\n    if (!state || this.state === state) return\n    this.state = state\n    var info = this.states[state]\n    this.groups = info.groups\n    this.error = info.error\n    this.re = info.regexp\n    this.fast = info.fast\n  }\n\n  Lexer.prototype.popState = function() {\n    this.setState(this.stack.pop())\n  }\n\n  Lexer.prototype.pushState = function(state) {\n    this.stack.push(this.state)\n    this.setState(state)\n  }\n\n  var eat = hasSticky ? function(re, buffer) { // assume re is /y\n    return re.exec(buffer)\n  } : function(re, buffer) { // assume re is /g\n    var match = re.exec(buffer)\n    // will always match, since we used the |(?:) trick\n    if (match[0].length === 0) {\n      return null\n    }\n    return match\n  }\n\n  Lexer.prototype._getGroup = function(match) {\n    var groupCount = this.groups.length\n    for (var i = 0; i < groupCount; i++) {\n      if (match[i + 1] !== undefined) {\n        return this.groups[i]\n      }\n    }\n    throw new Error('Cannot find token type for matched text')\n  }\n\n  function tokenToString() {\n    return this.value\n  }\n\n  Lexer.prototype.next = function() {\n    var index = this.index\n\n    // If a fallback token matched, we don't need to re-run the RegExp\n    if (this.queuedGroup) {\n      var token = this._token(this.queuedGroup, this.queuedText, index)\n      this.queuedGroup = null\n      this.queuedText = \"\"\n      return token\n    }\n\n    var buffer = this.buffer\n    if (index === buffer.length) {\n      return // EOF\n    }\n\n    // Fast matching for single characters\n    var group = this.fast[buffer.charCodeAt(index)]\n    if (group) {\n      return this._token(group, buffer.charAt(index), index)\n    }\n\n    // Execute RegExp\n    var re = this.re\n    re.lastIndex = index\n    var match = eat(re, buffer)\n\n    // Error tokens match the remaining buffer\n    var error = this.error\n    if (match == null) {\n      return this._token(error, buffer.slice(index, buffer.length), index)\n    }\n\n    var group = this._getGroup(match)\n    var text = match[0]\n\n    if (error.fallback && match.index !== index) {\n      this.queuedGroup = group\n      this.queuedText = text\n\n      // Fallback tokens contain the unmatched portion of the buffer\n      return this._token(error, buffer.slice(index, match.index), index)\n    }\n\n    return this._token(group, text, index)\n  }\n\n  Lexer.prototype._token = function(group, text, offset) {\n    // count line breaks\n    var lineBreaks = 0\n    if (group.lineBreaks) {\n      var matchNL = /\\n/g\n      var nl = 1\n      if (text === '\\n') {\n        lineBreaks = 1\n      } else {\n        while (matchNL.exec(text)) { lineBreaks++; nl = matchNL.lastIndex }\n      }\n    }\n\n    var token = {\n      type: (typeof group.type === 'function' && group.type(text)) || group.defaultType,\n      value: typeof group.value === 'function' ? group.value(text) : text,\n      text: text,\n      toString: tokenToString,\n      offset: offset,\n      lineBreaks: lineBreaks,\n      line: this.line,\n      col: this.col,\n    }\n    // nb. adding more props to token object will make V8 sad!\n\n    var size = text.length\n    this.index += size\n    this.line += lineBreaks\n    if (lineBreaks !== 0) {\n      this.col = size - nl + 1\n    } else {\n      this.col += size\n    }\n\n    // throw, if no rule with {error: true}\n    if (group.shouldThrow) {\n      throw new Error(this.formatError(token, \"invalid syntax\"))\n    }\n\n    if (group.pop) this.popState()\n    else if (group.push) this.pushState(group.push)\n    else if (group.next) this.setState(group.next)\n\n    return token\n  }\n\n  if (typeof Symbol !== 'undefined' && Symbol.iterator) {\n    var LexerIterator = function(lexer) {\n      this.lexer = lexer\n    }\n\n    LexerIterator.prototype.next = function() {\n      var token = this.lexer.next()\n      return {value: token, done: !token}\n    }\n\n    LexerIterator.prototype[Symbol.iterator] = function() {\n      return this\n    }\n\n    Lexer.prototype[Symbol.iterator] = function() {\n      return new LexerIterator(this)\n    }\n  }\n\n  Lexer.prototype.formatError = function(token, message) {\n    if (token == null) {\n      // An undefined token indicates EOF\n      var text = this.buffer.slice(this.index)\n      var token = {\n        text: text,\n        offset: this.index,\n        lineBreaks: text.indexOf('\\n') === -1 ? 0 : 1,\n        line: this.line,\n        col: this.col,\n      }\n    }\n    var start = Math.max(0, token.offset - token.col + 1)\n    var eol = token.lineBreaks ? token.text.indexOf('\\n') : token.text.length\n    var firstLine = this.buffer.substring(start, token.offset + eol)\n    message += \" at line \" + token.line + \" col \" + token.col + \":\\n\\n\"\n    message += \"  \" + firstLine + \"\\n\"\n    message += \"  \" + Array(token.col).join(\" \") + \"^\"\n    return message\n  }\n\n  Lexer.prototype.clone = function() {\n    return new Lexer(this.states, this.state)\n  }\n\n  Lexer.prototype.has = function(tokenType) {\n    return true\n  }\n\n\n  return {\n    compile: compile,\n    states: compileStates,\n    error: Object.freeze({error: true}),\n    fallback: Object.freeze({fallback: true}),\n    keywords: keywordTransform,\n  }\n\n}));\n\n\n/***/ }),\n\n/***/ 7:\n/***/ ((module, __unused_webpack_exports, __nccwpck_require__) => {\n\n\"use strict\";\n/* module decorator */ module = __nccwpck_require__.nmd(module);\n\n\nvar Module = __nccwpck_require__(282);\nvar path = __nccwpck_require__(622);\n\nmodule.exports = function requireFromString(code, filename, opts) {\n\tif (typeof filename === 'object') {\n\t\topts = filename;\n\t\tfilename = undefined;\n\t}\n\n\topts = opts || {};\n\tfilename = filename || '';\n\n\topts.appendPaths = opts.appendPaths || [];\n\topts.prependPaths = opts.prependPaths || [];\n\n\tif (typeof code !== 'string') {\n\t\tthrow new Error('code must be a string, not ' + typeof code);\n\t}\n\n\tvar paths = Module._nodeModulePaths(path.dirname(filename));\n\n\tvar parent = module.parent;\n\tvar m = new Module(filename, parent);\n\tm.filename = filename;\n\tm.paths = [].concat(opts.prependPaths).concat(paths).concat(opts.appendPaths);\n\tm._compile(code, filename);\n\n\tvar exports = m.exports;\n\tparent && parent.children && parent.children.splice(parent.children.indexOf(m), 1);\n\n\treturn exports;\n};\n\n\n/***/ }),\n\n/***/ 770:\n/***/ ((module, __unused_webpack_exports, __nccwpck_require__) => {\n\nvar extend = __nccwpck_require__(721);\r\n\r\nvar singlebyte = function(){\r\n   /* jshint indent: false */\r\n   if(!( this instanceof singlebyte )){\r\n      return new singlebyte();\r\n   }\r\n\r\n   this.encodings = [];\r\n\r\n   // CP437\r\n   this.learnEncoding('cp437', this.extendASCII([\r\n       0xC7,   0xFC,   0xE9,   0xE2,   0xE4,   0xE0,   0xE5,   0xE7,\r\n       0xEA,   0xEB,   0xE8,   0xEF,   0xEE,   0xEC,   0xC4,   0xC5,\r\n       0xC9,   0xE6,   0xC6,   0xF4,   0xF6,   0xF2,   0xFB,   0xF9,\r\n       0xFF,   0xD6,   0xDC,   0xA2,   0xA3,   0xA5,  0x20A7, 0x192,\r\n       0xE1,   0xED,   0xF3,   0xFA,   0xF1,   0xD1,   0xAA,   0xBA,\r\n       0xBF,  0x2310,  0xAC,   0xBD,   0xBC,   0xA1,   0xAB,   0xBB,\r\n      0x2591, 0x2592, 0x2593, 0x2502, 0x2524, 0x2561, 0x2562, 0x2556,\r\n      0x2555, 0x2563, 0x2551, 0x2557, 0x255D, 0x255C, 0x255B, 0x2510,\r\n      0x2514, 0x2534, 0x252C, 0x251C, 0x2500, 0x253C, 0x255E, 0x255F,\r\n      0x255A, 0x2554, 0x2569, 0x2566, 0x2560, 0x2550, 0x256C, 0x2567,\r\n      0x2568, 0x2564, 0x2565, 0x2559, 0x2558, 0x2552, 0x2553, 0x256B,\r\n      0x256A, 0x2518, 0x250C, 0x2588, 0x2584, 0x258C, 0x2590, 0x2580,\r\n      0x3B1,  0x3B2,  0x393,  0x3C0,  0x3A3,  0x3C3,  0x3BC,  0x3C4,\r\n      0x3A6,  0x398,  0x3A9,  0x3B4,  0x221E, 0x3C6,  0x3B5,  0x2229,\r\n      0x2261,  0xB1,  0x2265, 0x2264, 0x2320, 0x2321,  0xF7,  0x2248,\r\n      0xB0,   0x2219,  0xB7,  0x221A, 0x207F,  0xB2,  0x25A0,  0xA0\r\n   ]));\r\n\r\n   // CP850\r\n   this.learnEncoding('cp850', this.extendASCII([\r\n       0xC7,   0xFC,   0xE9,   0xE2,   0xE4,   0xE0,   0xE5,   0xE7,\r\n       0xEA,   0xEB,   0xE8,   0xEF,   0xEE,   0xEC,   0xC4,   0xC5,\r\n       0xC9,   0xE6,   0xC6,   0xF4,   0xF6,   0xF2,   0xFB,   0xF9,\r\n       0xFF,   0xD6,   0xDC,   0xF8,   0xA3,   0xD8,   0xD7,  0x192,\r\n       0xE1,   0xED,   0xF3,   0xFA,   0xF1,   0xD1,   0xAA,   0xBA,\r\n       0xBF,   0xAE,   0xAC,   0xBD,   0xBC,   0xA1,   0xAB,   0xBB,\r\n      0x2591, 0x2592, 0x2593, 0x2502, 0x2524,  0xC1,   0xC2,   0xC0,\r\n       0xA9,  0x2563, 0x2551, 0x2557, 0x255D,  0xA2,   0xA5,  0x2510,\r\n      0x2514, 0x2534, 0x252C, 0x251C, 0x2500, 0x253C,  0xE3,   0xC3,\r\n      0x255A, 0x2554, 0x2569, 0x2566, 0x2560, 0x2550, 0x256C,  0xA4,\r\n       0xF0,   0xD0,   0xCA,   0xCB,   0xC8,  0x131,   0xCD,   0xCE,\r\n       0xCF,  0x2518, 0x250C, 0x2588, 0x2584,  0xA6,   0xCC,  0x2580,\r\n       0xD3,   0xDF,   0xD4,   0xD2,   0xF5,   0xD5,   0xB5,   0xFE,\r\n       0xDE,   0xDA,   0xDB,   0xD9,   0xFD,   0xDD,   0xAF,   0xB4,\r\n       0xAD,   0xB1,  0x2017,  0xBE,   0xB6,   0xA7,   0xF7,   0xB8,\r\n       0xB0,   0xA8,   0xB7,   0xB9,   0xB3,   0xB2,  0x25A0,  0xA0\r\n   ]));\r\n\r\n   // CP858\r\n   this.learnEncoding('cp858', this.extendASCII([\r\n       0xC7,   0xFC,   0xE9,   0xE2,   0xE4,   0xE0,   0xE5,   0xE7,\r\n       0xEA,   0xEB,   0xE8,   0xEF,   0xEE,   0xEC,   0xC4,   0xC5,\r\n       0xC9,   0xE6,   0xC6,   0xF4,   0xF6,   0xF2,   0xFB,   0xF9,\r\n       0xFF,   0xD6,   0xDC,   0xF8,   0xA3,   0xD8,   0xD7,  0x192,\r\n       0xE1,   0xED,   0xF3,   0xFA,   0xF1,   0xD1,   0xAA,   0xBA,\r\n       0xBF,   0xAE,   0xAC,   0xBD,   0xBC,   0xA1,   0xAB,   0xBB,\r\n      0x2591, 0x2592, 0x2593, 0x2502, 0x2524,  0xC1,   0xC2,   0xC0,\r\n       0xA9,  0x2563, 0x2551, 0x2557, 0x255D,  0xA2,   0xA5,  0x2510,\r\n      0x2514, 0x2534, 0x252C, 0x251C, 0x2500, 0x253C,  0xE3,   0xC3,\r\n      0x255A, 0x2554, 0x2569, 0x2566, 0x2560, 0x2550, 0x256C,  0xA4,\r\n       0xF0,   0xD0,   0xCA,   0xCB,   0xC8,  0x20AC,   0xCD,   0xCE,\r\n       0xCF,  0x2518, 0x250C, 0x2588, 0x2584,  0xA6,   0xCC,  0x2580,\r\n       0xD3,   0xDF,   0xD4,   0xD2,   0xF5,   0xD5,   0xB5,   0xFE,\r\n       0xDE,   0xDA,   0xDB,   0xD9,   0xFD,   0xDD,   0xAF,   0xB4,\r\n       0xAD,   0xB1,  0x2017,  0xBE,   0xB6,   0xA7,   0xF7,   0xB8,\r\n       0xB0,   0xA8,   0xB7,   0xB9,   0xB3,   0xB2,  0x25A0,  0xA0\r\n   ]));\r\n\r\n   // CP808\r\n   this.learnEncoding('cp808', this.extendASCII([\r\n      0x410,  0x411,  0x412,  0x413,  0x414,  0x415,  0x416,  0x417,\r\n      0x418,  0x419,  0x41A,  0x41B,  0x41C,  0x41D,  0x41E,  0x41F,\r\n      0x420,  0x421,  0x422,  0x423,  0x424,  0x425,  0x426,  0x427,\r\n      0x428,  0x429,  0x42A,  0x42B,  0x42C,  0x42D,  0x42E,  0x42F,\r\n      0x430,  0x431,  0x432,  0x433,  0x434,  0x435,  0x436,  0x437,\r\n      0x438,  0x439,  0x43A,  0x43B,  0x43C,  0x43D,  0x43E,  0x43F,\r\n      0x2591, 0x2592, 0x2593, 0x2502, 0x2524, 0x2561, 0x2562, 0x2556,\r\n      0x2555, 0x2563, 0x2551, 0x2557, 0x255D, 0x255C, 0x255B, 0x2510,\r\n      0x2514, 0x2534, 0x252C, 0x251C, 0x2500, 0x253C, 0x255E, 0x255F,\r\n      0x255A, 0x2554, 0x2569, 0x2566, 0x2560, 0x2550, 0x256C, 0x2567,\r\n      0x2568, 0x2564, 0x2565, 0x2559, 0x2558, 0x2552, 0x2553, 0x256B,\r\n      0x256A, 0x2518, 0x250C, 0x2588, 0x2584, 0x258C, 0x2590, 0x2580,\r\n      0x440,  0x441,  0x442,  0x443,  0x444,  0x445,  0x446,  0x447,\r\n      0x448,  0x449,  0x44A,  0x44B,  0x44C,  0x44D,  0x44E,  0x44F,\r\n      0x401,  0x451,  0x404,  0x454,  0x407,  0x457,  0x40E,  0x45E,\r\n       0xB0,  0x2219,  0xB7,  0x221A, 0x2116, 0x20AC, 0x25A0,  0xA0\r\n   ]));\r\n\r\n   // CP866\r\n   this.learnEncoding('cp866', this.extendASCII([\r\n      0x410,  0x411,  0x412,  0x413,  0x414,  0x415,  0x416,  0x417,\r\n      0x418,  0x419,  0x41A,  0x41B,  0x41C,  0x41D,  0x41E,  0x41F,\r\n      0x420,  0x421,  0x422,  0x423,  0x424,  0x425,  0x426,  0x427,\r\n      0x428,  0x429,  0x42A,  0x42B,  0x42C,  0x42D,  0x42E,  0x42F,\r\n      0x430,  0x431,  0x432,  0x433,  0x434,  0x435,  0x436,  0x437,\r\n      0x438,  0x439,  0x43A,  0x43B,  0x43C,  0x43D,  0x43E,  0x43F,\r\n      0x2591, 0x2592, 0x2593, 0x2502, 0x2524, 0x2561, 0x2562, 0x2556,\r\n      0x2555, 0x2563, 0x2551, 0x2557, 0x255D, 0x255C, 0x255B, 0x2510,\r\n      0x2514, 0x2534, 0x252C, 0x251C, 0x2500, 0x253C, 0x255E, 0x255F,\r\n      0x255A, 0x2554, 0x2569, 0x2566, 0x2560, 0x2550, 0x256C, 0x2567,\r\n      0x2568, 0x2564, 0x2565, 0x2559, 0x2558, 0x2552, 0x2553, 0x256B,\r\n      0x256A, 0x2518, 0x250C, 0x2588, 0x2584, 0x258C, 0x2590, 0x2580,\r\n      0x440,  0x441,  0x442,  0x443,  0x444,  0x445,  0x446,  0x447,\r\n      0x448,  0x449,  0x44A,  0x44B,  0x44C,  0x44D,  0x44E,  0x44F,\r\n      0x401,  0x451,  0x404,  0x454,  0x407,  0x457,  0x40E,  0x45E,\r\n       0xB0,  0x2219,  0xB7,  0x221A, 0x2116,  0xA4,  0x25A0,  0xA0\r\n   ]));\r\n\r\n   // CP1125\r\n   this.learnEncoding('cp1125', this.extendASCII([\r\n      0x410,  0x411,  0x412,  0x413,  0x414,  0x415,  0x416,  0x417,\r\n      0x418,  0x419,  0x41A,  0x41B,  0x41C,  0x41D,  0x41E,  0x41F,\r\n      0x420,  0x421,  0x422,  0x423,  0x424,  0x425,  0x426,  0x427,\r\n      0x428,  0x429,  0x42A,  0x42B,  0x42C,  0x42D,  0x42E,  0x42F,\r\n      0x430,  0x431,  0x432,  0x433,  0x434,  0x435,  0x436,  0x437,\r\n      0x438,  0x439,  0x43A,  0x43B,  0x43C,  0x43D,  0x43E,  0x43F,\r\n      0x2591, 0x2592, 0x2593, 0x2502, 0x2524, 0x2561, 0x2562, 0x2556,\r\n      0x2555, 0x2563, 0x2551, 0x2557, 0x255D, 0x255C, 0x255B, 0x2510,\r\n      0x2514, 0x2534, 0x252C, 0x251C, 0x2500, 0x253C, 0x255E, 0x255F,\r\n      0x255A, 0x2554, 0x2569, 0x2566, 0x2560, 0x2550, 0x256C, 0x2567,\r\n      0x2568, 0x2564, 0x2565, 0x2559, 0x2558, 0x2552, 0x2553, 0x256B,\r\n      0x256A, 0x2518, 0x250C, 0x2588, 0x2584, 0x258C, 0x2590, 0x2580,\r\n      0x440,  0x441,  0x442,  0x443,  0x444,  0x445,  0x446,  0x447,\r\n      0x448,  0x449,  0x44A,  0x44B,  0x44C,  0x44D,  0x44E,  0x44F,\r\n      0x401,  0x451,  0x490,  0x491,  0x404,  0x454,  0x406,  0x456,\r\n      0x407,  0x457,   0xB7,  0x221A, 0x2116,  0xA4,  0x25A0,  0xA0\r\n   ]));\r\n\r\n   // KOI8-R\r\n   this.learnEncoding('koi8-r', this.extendASCII([\r\n      0x2500, 0x2502, 0x250C, 0x2510, 0x2514, 0x2518, 0x251C, 0x2524,\r\n      0x252C, 0x2534, 0x253C, 0x2580, 0x2584, 0x2588, 0x258C, 0x2590,\r\n      0x2591, 0x2592, 0x2593, 0x2320, 0x25A0, 0x2219, 0x221A, 0x2248,\r\n      0x2264, 0x2265,  0xA0,  0x2321,  0xB0,   0xB2,   0xB7,   0xF7,\r\n      0x2550, 0x2551, 0x2552, 0x451,  0x2553, 0x2554, 0x2555, 0x2556,\r\n      0x2557, 0x2558, 0x2559, 0x255A, 0x255B, 0x255C, 0x255D, 0x255E,\r\n      0x255F, 0x2560, 0x2561, 0x401,  0x2562, 0x2563, 0x2564, 0x2565,\r\n      0x2566, 0x2567, 0x2568, 0x2569, 0x256A, 0x256B, 0x256C,  0xA9,\r\n      0x44E,  0x430,  0x431,  0x446,  0x434,  0x435,  0x444,  0x433,\r\n      0x445,  0x438,  0x439,  0x43A,  0x43B,  0x43C,  0x43D,  0x043E,\r\n      0x43F,  0x44F,  0x440,  0x441,  0x442,  0x443,  0x436,  0x432,\r\n      0x44C,  0x44B,  0x437,  0x448,  0x44D,  0x449,  0x447,  0x44A,\r\n      0x42E,  0x410,  0x411,  0x426,  0x414,  0x415,  0x424,  0x413,\r\n      0x425,  0x418,  0x419,  0x41A,  0x41B,  0x41C,  0x41D,  0x41E,\r\n      0x41F,  0x42F,  0x420,  0x421,  0x422,  0x423,  0x416,  0x412,\r\n      0x42C,  0x42B,  0x417,  0x428,  0x42D,  0x429,  0x427,  0x42A\r\n   ]));\r\n\r\n   // KOI8-U\r\n   this.learnEncoding('koi8-u', this.extendASCII([\r\n      0x2500, 0x2502, 0x250C, 0x2510, 0x2514, 0x2518, 0x251C, 0x2524,\r\n      0x252C, 0x2534, 0x253C, 0x2580, 0x2584, 0x2588, 0x258C, 0x2590,\r\n      0x2591, 0x2592, 0x2593, 0x2320, 0x25A0, 0x2219, 0x221A, 0x2248,\r\n      0x2264, 0x2265,  0xA0,  0x2321,  0xB0,   0xB2,   0xB7,   0xF7,\r\n      0x2550, 0x2551, 0x2552, 0x451,  0x454,  0x2554, 0x456,  0x457,\r\n      0x2557, 0x2558, 0x2559, 0x255A, 0x255B, 0x491,  0x255D, 0x255E,\r\n      0x255F, 0x2560, 0x2561, 0x401,  0x404,  0x2563, 0x406,  0x407,\r\n      0x2566, 0x2567, 0x2568, 0x2569, 0x256A, 0x490,  0x256C,  0xA9,\r\n      0x44E,  0x430,  0x431,  0x446,  0x434,  0x435,  0x444,  0x433,\r\n      0x445,  0x438,  0x439,  0x43A,  0x43B,  0x43C,  0x43D,  0x043E,\r\n      0x43F,  0x44F,  0x440,  0x441,  0x442,  0x443,  0x436,  0x432,\r\n      0x44C,  0x44B,  0x437,  0x448,  0x44D,  0x449,  0x447,  0x44A,\r\n      0x42E,  0x410,  0x411,  0x426,  0x414,  0x415,  0x424,  0x413,\r\n      0x425,  0x418,  0x419,  0x41A,  0x41B,  0x41C,  0x41D,  0x41E,\r\n      0x41F,  0x42F,  0x420,  0x421,  0x422,  0x423,  0x416,  0x412,\r\n      0x42C,  0x42B,  0x417,  0x428,  0x42D,  0x429,  0x427,  0x42A\r\n   ]));\r\n\r\n   // KOI8-RU\r\n   this.learnEncoding('koi8-ru', this.extendASCII([\r\n      0x2500, 0x2502, 0x250C, 0x2510, 0x2514, 0x2518, 0x251C, 0x2524,\r\n      0x252C, 0x2534, 0x253C, 0x2580, 0x2584, 0x2588, 0x258C, 0x2590,\r\n      0x2591, 0x2592, 0x2593, 0x2320, 0x25A0, 0x2219, 0x221A, 0x2248,\r\n      0x2264, 0x2265,  0xA0,  0x2321,  0xB0,   0xB2,   0xB7,   0xF7,\r\n      0x2550, 0x2551, 0x2552, 0x451,  0x454,  0x2554, 0x456,  0x457,\r\n      0x2557, 0x2558, 0x2559, 0x255A, 0x255B, 0x491,  0x45E,  0x255E,\r\n      0x255F, 0x2560, 0x2561, 0x401,  0x404,  0x2563, 0x406,  0x407,\r\n      0x2566, 0x2567, 0x2568, 0x2569, 0x256A, 0x490,  0x40E,   0xA9,\r\n      0x44E,  0x430,  0x431,  0x446,  0x434,  0x435,  0x444,  0x433,\r\n      0x445,  0x438,  0x439,  0x43A,  0x43B,  0x43C,  0x43D,  0x043E,\r\n      0x43F,  0x44F,  0x440,  0x441,  0x442,  0x443,  0x436,  0x432,\r\n      0x44C,  0x44B,  0x437,  0x448,  0x44D,  0x449,  0x447,  0x44A,\r\n      0x42E,  0x410,  0x411,  0x426,  0x414,  0x415,  0x424,  0x413,\r\n      0x425,  0x418,  0x419,  0x41A,  0x41B,  0x41C,  0x41D,  0x41E,\r\n      0x41F,  0x42F,  0x420,  0x421,  0x422,  0x423,  0x416,  0x412,\r\n      0x42C,  0x42B,  0x417,  0x428,  0x42D,  0x429,  0x427,  0x42A\r\n   ]));\r\n\r\n   // LATIN-1 aka ISO 8859-1 (Western European)\r\n   this.learnEncoding('latin-1', this.extendASCII([\r\n      0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87,\r\n      0x88, 0x89, 0x8A, 0x8B, 0x8C, 0x8D, 0x8E, 0x8F,\r\n      0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97,\r\n      0x98, 0x99, 0x9A, 0x9B, 0x9C, 0x9D, 0x9E, 0x9F,\r\n      0xA0, 0xA1, 0xA2, 0xA3, 0xA4, 0xA5, 0xA6, 0xA7,\r\n      0xA8, 0xA9, 0xAA, 0xAB, 0xAC, 0xAD, 0xAE, 0xAF,\r\n      0xB0, 0xB1, 0xB2, 0xB3, 0xB4, 0xB5, 0xB6, 0xB7,\r\n      0xB8, 0xB9, 0xBA, 0xBB, 0xBC, 0xBD, 0xBE, 0xBF,\r\n      0xC0, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7,\r\n      0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF,\r\n      0xD0, 0xD1, 0xD2, 0xD3, 0xD4, 0xD5, 0xD6, 0xD7,\r\n      0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE, 0xDF,\r\n      0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,\r\n      0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF,\r\n      0xF0, 0xF1, 0xF2, 0xF3, 0xF4, 0xF5, 0xF6, 0xF7,\r\n      0xF8, 0xF9, 0xFA, 0xFB, 0xFC, 0xFD, 0xFE, 0xFF\r\n   ]));\r\n\r\n   // Windows-1252\r\n   this.learnEncoding('cp1252', this.extendASCII([\r\n      0x20AC,  0x81,  0x201A, 0x192,  0x201E, 0x2026, 0x2020, 0x2021,\r\n      0x2C6,  0x2030, 0x160,  0x2039, 0x152,   0x8D,  0x017D,  0x8F,\r\n       0x90,  0x2018, 0x2019, 0x201C, 0x201D, 0x2022, 0x2013, 0x2014,\r\n      0x02DC, 0x2122, 0x161,  0x203A, 0x0153,  0x9D,  0x17E,  0x178,\r\n       0xA0,   0xA1,   0xA2,   0xA3,   0xA4,   0xA5,   0xA6,   0xA7,\r\n       0xA8,   0xA9,   0xAA,   0xAB,   0xAC,   0xAD,   0xAE,   0xAF,\r\n       0xB0,   0xB1,   0xB2,   0xB3,   0xB4,   0xB5,   0xB6,   0xB7,\r\n       0xB8,   0xB9,   0xBA,   0xBB,   0xBC,   0xBD,   0xBE,   0xBF,\r\n       0xC0,   0xC1,   0xC2,   0xC3,   0xC4,   0xC5,   0xC6,   0xC7,\r\n       0xC8,   0xC9,   0xCA,   0xCB,   0xCC,   0xCD,   0xCE,   0xCF,\r\n       0xD0,   0xD1,   0xD2,   0xD3,   0xD4,   0xD5,   0xD6,   0xD7,\r\n       0xD8,   0xD9,   0xDA,   0xDB,   0xDC,   0xDD,   0xDE,   0xDF,\r\n       0xE0,   0xE1,   0xE2,   0xE3,   0xE4,   0xE5,   0xE6,   0xE7,\r\n       0xE8,   0xE9,   0xEA,   0xEB,   0xEC,   0xED,   0xEE,   0xEF,\r\n       0xF0,   0xF1,   0xF2,   0xF3,   0xF4,   0xF5,   0xF6,   0xF7,\r\n       0xF8,   0xF9,   0xFA,   0xFB,   0xFC,   0xFD,   0xFE,   0xFF\r\n   ]));\r\n};\r\n\r\nsinglebyte.prototype.isEncoding = function(encodingName){\r\n   if( Buffer.isEncoding(encodingName) ) return true;\r\n   for( var i = 0; i < this.encodings.length; i++ ){\r\n      if( this.encodings[i].name === encodingName ) return true;\r\n   }\r\n   return false;\r\n};\r\n\r\nsinglebyte.prototype.learnEncoding = function(encodingName, encodingTable){\r\n   /*jshint bitwise: false */\r\n   if( Buffer.isEncoding(encodingName) ){\r\n      throw new Error(this.errors.BUFFER_ENCODING);\r\n   }\r\n\r\n   if( encodingTable.length !== 256 ){\r\n      throw new Error(this.errors.INVALID_TABLE_LENGTH);\r\n   }\r\n\r\n   var _this = this;\r\n   encodingTable = encodingTable.map(function(item){\r\n      var nextCode = item |0;\r\n      if( 0 > nextCode || nextCode > 0x10FFFF ){\r\n         throw new Error(_this.errors.OUT_OF_UNICODE);\r\n      }\r\n      return item;\r\n   });\r\n\r\n   if( this.isEncoding(encodingName) ){\r\n      for( var i = 0; i < this.encodings.length; i++ ){\r\n         if( this.encodings[i].name === encodingName ){\r\n            this.encodings[i].table = encodingTable;\r\n            return;\r\n         }\r\n      }\r\n   } else {\r\n      this.encodings.push({\r\n         name:  encodingName,\r\n         table: encodingTable\r\n      });\r\n   }\r\n};\r\n\r\nsinglebyte.prototype.getEncodingTable = function(encodingName){\r\n   for( var i = 0; i < this.encodings.length; i++ ){\r\n      if( this.encodings[i].name === encodingName ){\r\n         return this.encodings[i].table;\r\n      }\r\n   }\r\n   return null;\r\n};\r\n\r\nsinglebyte.prototype.extendASCII = function(extensionTable){\r\n   if( extensionTable.length !== 128 ){\r\n      throw new Error(this.errors.INVALID_EXTENSION);\r\n   }\r\n\r\n   var output = [];\r\n   for( var i = 0; i < 128; i++ ) output.push(i);\r\n   return output.concat(extensionTable);\r\n};\r\n\r\nsinglebyte.prototype.bufToStr = function(buf, encoding, start, end){\r\n   /* jshint bitwise: false */\r\n   if(!( Buffer.isBuffer(buf) )){\r\n      throw new Error(this.errors.NOT_A_BUFFER);\r\n   }\r\n   if( Buffer.isEncoding(encoding) ){\r\n      return buf.toString(encoding, start, end);\r\n   }\r\n   var table = this.getEncodingTable(encoding);\r\n   if( table === null ) throw new Error(this.errors.UNKNOWN_ENCODING);\r\n\r\n   if( typeof end   === 'undefined' ) end   = buf.length;\r\n   if( typeof start === 'undefined' ) start = 0;\r\n\r\n   var output = '';\r\n   var sourceValue;\r\n   for( var i = start; i < end; i++ ){\r\n      sourceValue = table[ buf[i] ];\r\n      if( sourceValue <= 0xFFFF ){\r\n         output += String.fromCharCode(sourceValue);\r\n      } else if( 0x10000 <= sourceValue && sourceValue <= 0x10FFFF ){\r\n         sourceValue -= 0x10000;\r\n         output += String.fromCharCode( 0xD800 + (sourceValue >> 10) );\r\n         output += String.fromCharCode( 0xDC00 + (sourceValue & 0x3FF) );\r\n      } else throw new Error(this.errors.OUT_OF_UNICODE);\r\n   }\r\n   return output;\r\n};\r\n\r\nvar strToBufDefaults = {\r\n   defaultCode: 0x3F   // '?'\r\n};\r\n\r\nsinglebyte.prototype.strToBuf = function(str, encoding, encodingOptions){\r\n   if( Buffer.isEncoding(encoding) ){\r\n      return new Buffer(str, encoding);\r\n   }\r\n   str = '' + str;\r\n   var options = extend({}, strToBufDefaults, encodingOptions);\r\n   var table = this.getEncodingTable(encoding);\r\n   if( table === null ) throw new Error(this.errors.UNKNOWN_ENCODING);\r\n   var output = [];\r\n   for( var i = 0; i < str.length; i++ ){\r\n      var charUnicode;\r\n      var thisCharCode = str.charCodeAt(i);\r\n      if( 0xD800 <= thisCharCode && thisCharCode <= 0xDBFF &&\r\n         i+1 < str.length\r\n      ){\r\n         var nextCharCode = str.charCodeAt(i+1);\r\n         if( 0xDC00 <= nextCharCode && nextCharCode <= 0xDFFF ){\r\n            charUnicode = 0x10000 + (thisCharCode - 0xD800)*0x400 +\r\n               (nextCharCode - 0xDC00);\r\n            i++;\r\n         } else {\r\n            charUnicode = thisCharCode;\r\n         }\r\n      } else {\r\n         charUnicode = thisCharCode;\r\n      }\r\n\r\n      var codeFoundIndex = table.indexOf(charUnicode);\r\n      if( codeFoundIndex < 0 ){\r\n         output.push(options.defaultCode);\r\n      } else {\r\n         output.push(codeFoundIndex);\r\n      }\r\n   }\r\n   return new Buffer(output);\r\n};\r\n\r\nsinglebyte.prototype.errors = {\r\n   NOT_A_BUFFER : 'The given source is not a buffer!',\r\n   UNKNOWN_ENCODING : 'The given encoding is not defined!',\r\n   INVALID_TABLE_LENGTH : 'The encoding table must have 256 elements!',\r\n   INVALID_EXTENSION : 'The ASCII extension table must have 128 elements!',\r\n   BUFFER_ENCODING : \"Cannot redefine a\xa0Node's encoding!\",\r\n   OUT_OF_UNICODE : \"An encoding table's element is greater than 0x10FFFF!\"\r\n};\r\n\r\nmodule.exports = singlebyte();\n\n/***/ }),\n\n/***/ 962:\n/***/ ((__unused_webpack_module, exports, __nccwpck_require__) => {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.getDataItem = exports.dataItemTypeName = void 0;\nvar types_1 = __nccwpck_require__(521);\nfunction dataItemTypeName(_a) {\n    var _ = _a[0], value = _a[1];\n    return value === null ? 'null' : typeof value;\n}\nexports.dataItemTypeName = dataItemTypeName;\n/** Converts a data item to the expected type. */\nfunction getDataItem(item, expectedTypeSpec) {\n    var _ = item[0], value = item[1];\n    if (types_1.isNumeric(expectedTypeSpec)) {\n        switch (typeof value) {\n            case 'number':\n                return value;\n            case 'object':\n                return 0;\n            default:\n                throwDataItemTypeError(item, expectedTypeSpec);\n        }\n    }\n    else if (types_1.isString(expectedTypeSpec)) {\n        switch (typeof value) {\n            case 'string':\n                return value;\n            case 'object':\n                return '';\n            default:\n                throwDataItemTypeError(item, expectedTypeSpec);\n        }\n    }\n    else {\n        throw new Error(\"Unknown expected type spec: \" + JSON.stringify(expectedTypeSpec));\n    }\n}\nexports.getDataItem = getDataItem;\nfunction throwDataItemTypeError(item, expectedTypeSpec) {\n    var _a = item[0], line = _a[0], col = _a[1], _ = item[1];\n    throw new Error(\"expected \" + types_1.typeSpecName(expectedTypeSpec) + \", \" +\n        (\"got \" + dataItemTypeName(item) + \" data item \") +\n        (\"(defined at \" + line + \":\" + col + \")\"));\n}\n\n\n/***/ }),\n\n/***/ 813:\n/***/ (function(__unused_webpack_module, exports) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\n/** An error with source file and location info. */\nvar ErrorWithLoc = /** @class */ (function (_super) {\n    __extends(ErrorWithLoc, _super);\n    function ErrorWithLoc(message, _a) {\n        var _b = _a === void 0 ? {} : _a, sourceFileName = _b.sourceFileName, loc = _b.loc;\n        var _this = _super.call(this, message) || this;\n        if (loc) {\n            var sourceFileNamePrefix = sourceFileName ? sourceFileName + \":\" : '';\n            var locPrefix = loc.line + \":\" + loc.col;\n            _this.message = \"\" + sourceFileNamePrefix + locPrefix + \" - \" + _this.message;\n            _this.loc = loc;\n        }\n        return _this;\n    }\n    return ErrorWithLoc;\n}(Error));\nexports.default = ErrorWithLoc;\n\n\n/***/ }),\n\n/***/ 345:\n/***/ ((__unused_webpack_module, exports) => {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\n/** Round a number to integer using BASIC's round-half-to-even rule. */\nfunction roundHalfToEven(n) {\n    if (n - Math.floor(n) === 0.5) {\n        return Math.round(n / 2) * 2;\n    }\n    else {\n        return Math.round(n);\n    }\n}\nexports.default = roundHalfToEven;\n\n\n/***/ }),\n\n/***/ 973:\n/***/ ((__unused_webpack_module, exports) => {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.lookupSymbols = exports.lookupSymbol = exports.VarScope = exports.VarType = void 0;\n/** Type of a variable symbol. */\nvar VarType;\n(function (VarType) {\n    /** Regular variable. */\n    VarType[\"VAR\"] = \"var\";\n    /** Static variable. */\n    VarType[\"STATIC_VAR\"] = \"staticVar\";\n    /** Constant. */\n    VarType[\"CONST\"] = \"const\";\n    /** FUNCTION or SUB argument. */\n    VarType[\"ARG\"] = \"arg\";\n})(VarType = exports.VarType || (exports.VarType = {}));\n/** Scope of a variable symbol. */\nvar VarScope;\n(function (VarScope) {\n    VarScope[\"LOCAL\"] = \"local\";\n    VarScope[\"GLOBAL\"] = \"global\";\n})(VarScope = exports.VarScope || (exports.VarScope = {}));\nfunction lookupSymbol(symbolTable, name) {\n    var _a;\n    return ((_a = symbolTable.find(function (symbol) { return symbol.name.toLowerCase() === name.toLowerCase(); })) !== null && _a !== void 0 ? _a : null);\n}\nexports.lookupSymbol = lookupSymbol;\nfunction lookupSymbols(symbolTable, name) {\n    return symbolTable.filter(function (symbol) { return symbol.name.toLowerCase() === name.toLowerCase(); });\n}\nexports.lookupSymbols = lookupSymbols;\n\n\n/***/ }),\n\n/***/ 521:\n/***/ ((__unused_webpack_module, exports) => {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.ProcDefType = exports.procTypeName = exports.isFnOrDefFn = exports.ProcType = exports.typeSpecName = exports.areMatchingSingularTypes = exports.areMatchingElementaryTypes = exports.isSingularType = exports.isUdt = exports.isElementaryType = exports.isArray = exports.isString = exports.isIntegral = exports.isNumeric = exports.arraySpec = exports.stringSpec = exports.doubleSpec = exports.singleSpec = exports.longSpec = exports.integerSpec = exports.DataType = void 0;\n/** Overall type of the value. */\nvar DataType;\n(function (DataType) {\n    /** 16-bit integer */\n    DataType[\"INTEGER\"] = \"integer\";\n    /** 32-bit integer */\n    DataType[\"LONG\"] = \"long\";\n    /** 32-bit floating point. */\n    DataType[\"SINGLE\"] = \"single\";\n    /** 64-bit floating point. */\n    DataType[\"DOUBLE\"] = \"double\";\n    /** String. */\n    DataType[\"STRING\"] = \"string\";\n    /** Array. */\n    DataType[\"ARRAY\"] = \"array\";\n    /** User-defined data type, a.k.a. records. */\n    DataType[\"UDT\"] = \"udt\";\n})(DataType = exports.DataType || (exports.DataType = {}));\n// Helpers for creating DataTypeSpec instances.\nfunction integerSpec() {\n    return { type: DataType.INTEGER };\n}\nexports.integerSpec = integerSpec;\nfunction longSpec() {\n    return { type: DataType.LONG };\n}\nexports.longSpec = longSpec;\nfunction singleSpec() {\n    return { type: DataType.SINGLE };\n}\nexports.singleSpec = singleSpec;\nfunction doubleSpec() {\n    return { type: DataType.DOUBLE };\n}\nexports.doubleSpec = doubleSpec;\nfunction stringSpec() {\n    return { type: DataType.STRING };\n}\nexports.stringSpec = stringSpec;\nfunction arraySpec(elementTypeSpec, dimensionSpecs) {\n    return { type: DataType.ARRAY, elementTypeSpec: elementTypeSpec, dimensionSpecs: dimensionSpecs };\n}\nexports.arraySpec = arraySpec;\n// Helpers for type checking.\nfunction isNumeric(t) {\n    return [\n        DataType.INTEGER,\n        DataType.LONG,\n        DataType.SINGLE,\n        DataType.DOUBLE,\n    ].includes(getType(t));\n}\nexports.isNumeric = isNumeric;\nfunction isIntegral(t) {\n    return [DataType.INTEGER, DataType.LONG].includes(getType(t));\n}\nexports.isIntegral = isIntegral;\nfunction isString(t) {\n    return getType(t) === DataType.STRING;\n}\nexports.isString = isString;\nfunction isArray(t) {\n    return getType(t) === DataType.ARRAY;\n}\nexports.isArray = isArray;\nfunction isElementaryType(t) {\n    return isNumeric(t) || isString(t);\n}\nexports.isElementaryType = isElementaryType;\nfunction isUdt(t) {\n    return getType(t) === DataType.UDT;\n}\nexports.isUdt = isUdt;\nfunction isSingularType(t) {\n    return isElementaryType(t) || isUdt(t);\n}\nexports.isSingularType = isSingularType;\nfunction areMatchingElementaryTypes(typeSpec1, typeSpec2) {\n    return ((isNumeric(typeSpec1) && isNumeric(typeSpec2)) ||\n        (isString(typeSpec1) && isString(typeSpec2)));\n}\nexports.areMatchingElementaryTypes = areMatchingElementaryTypes;\nfunction areMatchingSingularTypes(typeSpec1, typeSpec2) {\n    return (areMatchingElementaryTypes(typeSpec1, typeSpec2) ||\n        (isUdt(typeSpec1) && isUdt(typeSpec2) && typeSpec1.name === typeSpec2.name));\n}\nexports.areMatchingSingularTypes = areMatchingSingularTypes;\nfunction typeSpecName(t) {\n    switch (t.type) {\n        case DataType.ARRAY:\n            return typeSpecName(t.elementTypeSpec) + \" array\";\n        case DataType.UDT:\n            return \"\\\"\" + t.name + \"\\\"\";\n        default:\n            return t.type;\n    }\n}\nexports.typeSpecName = typeSpecName;\nfunction getType(t) {\n    return typeof t === 'object' ? t.type : t;\n}\n/** Type of a procedure. */\nvar ProcType;\n(function (ProcType) {\n    /** SUB procedure. */\n    ProcType[\"SUB\"] = \"sub\";\n    /** FUNCTION procedure. */\n    ProcType[\"FN\"] = \"fn\";\n    /** DEF FN procedure. */\n    ProcType[\"DEF_FN\"] = \"defFn\";\n})(ProcType = exports.ProcType || (exports.ProcType = {}));\nfunction isFnOrDefFn(procType) {\n    return procType === ProcType.FN || procType === ProcType.DEF_FN;\n}\nexports.isFnOrDefFn = isFnOrDefFn;\n/** Returns the user-facing name of a ProcType. */\nfunction procTypeName(procType) {\n    var _a;\n    var NAMES = (_a = {},\n        _a[ProcType.SUB] = 'SUB procedure',\n        _a[ProcType.FN] = 'FUNCTION procedure',\n        _a[ProcType.DEF_FN] = 'DEF FN procedure',\n        _a);\n    return NAMES[procType];\n}\nexports.procTypeName = procTypeName;\n/** The type of a procedure definition. */\nvar ProcDefType;\n(function (ProcDefType) {\n    /** Built-in function. */\n    ProcDefType[\"BUILTIN\"] = \"builtin\";\n    /** User-defined function in the current module. */\n    ProcDefType[\"MODULE\"] = \"module\";\n})(ProcDefType = exports.ProcDefType || (exports.ProcDefType = {}));\n\n\n/***/ }),\n\n/***/ 168:\n/***/ ((__unused_webpack_module, exports) => {\n\n\"use strict\";\n\nvar _a;\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\n/** Returns a VT100 escape sequence prefixed by \"ESC [\". */\nfunction ESC(c) {\n    return \"\\u001B[\" + c;\n}\n/** Returns a DOS keyboard scan code prefixed by NUL. */\nfunction NUL(n) {\n    return String.fromCharCode(0, n);\n}\n/** Map ANSI / VT100 sequences to DOS keyboard scan codes. */\nvar ANSI_TERMINAL_KEY_CODE_MAP = (_a = {},\n    _a[ESC('A')] = NUL(72),\n    _a[ESC('B')] = NUL(80),\n    _a[ESC('C')] = NUL(77),\n    _a[ESC('D')] = NUL(75),\n    _a);\nexports.default = ANSI_TERMINAL_KEY_CODE_MAP;\n\n\n/***/ }),\n\n/***/ 769:\n/***/ (function(__unused_webpack_module, exports, __nccwpck_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nvar ansi_escapes_1 = __importDefault(__nccwpck_require__(575));\nvar ansi_styles_1 = __importDefault(__nccwpck_require__(566));\nvar ansi_terminal_key_code_map_1 = __importDefault(__nccwpck_require__(168));\nvar runtime_1 = __nccwpck_require__(753);\n/** RuntimePlatform implementing screen manipulation using ANSI escape codes.\n *\n * Ideally this functionality could be made into a mixin, but 1) it relies on this.print() etc and\n * so must be a class and 2) abstract classes don't support mixins yet:\n * https://github.com/microsoft/TypeScript/issues/35356\n */\nvar AnsiTerminalPlatform = /** @class */ (function (_super) {\n    __extends(AnsiTerminalPlatform, _super);\n    function AnsiTerminalPlatform() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    AnsiTerminalPlatform.prototype.moveCursorTo = function (x, y) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.print(ansi_escapes_1.default.cursorTo(x, y))];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AnsiTerminalPlatform.prototype.setCursorVisibility = function (isCursorVisible) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.print(isCursorVisible ? ansi_escapes_1.default.cursorShow : ansi_escapes_1.default.cursorHide)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AnsiTerminalPlatform.prototype.clearScreen = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.print(ansi_escapes_1.default.eraseScreen)];\n                    case 1:\n                        _a.sent();\n                        return [4 /*yield*/, this.moveCursorTo(0, 0)];\n                    case 2:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AnsiTerminalPlatform.prototype.setFgColor = function (colorName) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.print(ansi_styles_1.default[colorName].open)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AnsiTerminalPlatform.prototype.setBgColor = function (colorName) {\n        return __awaiter(this, void 0, void 0, function () {\n            var bgColorName;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        bgColorName = \"bg\" + colorName[0].toUpperCase() + colorName.substr(1);\n                        return [4 /*yield*/, this.print(ansi_styles_1.default[bgColorName].open)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AnsiTerminalPlatform.prototype.beep = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.print(ansi_escapes_1.default.beep)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Translates an ANSI / VT100 key code to the DOS equivalent. */\n    AnsiTerminalPlatform.prototype.translateKeyCode = function (c) {\n        var _a;\n        return (_a = ansi_terminal_key_code_map_1.default[c]) !== null && _a !== void 0 ? _a : c;\n    };\n    return AnsiTerminalPlatform;\n}(runtime_1.RuntimePlatform));\nexports.default = AnsiTerminalPlatform;\n\n\n/***/ }),\n\n/***/ 562:\n/***/ (function(__unused_webpack_module, exports, __nccwpck_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from) {\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\n        to[j] = from[i];\n    return to;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.lookupBuiltin = exports.BUILTIN_SUBS = exports.BUILTIN_FNS = void 0;\nvar singlebyte_1 = __importDefault(__nccwpck_require__(770));\nvar round_half_to_even_1 = __importDefault(__nccwpck_require__(345));\nvar symbol_table_1 = __nccwpck_require__(973);\nvar types_1 = __nccwpck_require__(521);\n/** Built-in functions. */\nexports.BUILTIN_FNS = __spreadArray(__spreadArray([\n    {\n        name: 'abs',\n        paramTypeSpecs: [types_1.doubleSpec()],\n        returnTypeSpec: types_1.doubleSpec(),\n        run: function (n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, Math.abs(n)];\n                });\n            });\n        },\n    },\n    {\n        name: 'asc',\n        paramTypeSpecs: [types_1.stringSpec()],\n        returnTypeSpec: types_1.longSpec(),\n        run: function (s) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    if (s.length === 0) {\n                        throw new Error('Expected non-empty string in ASC()');\n                    }\n                    // We could use iconv-lite here instead:\n                    // return iconv.encode(s[0], 'cp437')[0];\n                    return [2 /*return*/, singlebyte_1.default.strToBuf(s[0], 'cp437')[0]];\n                });\n            });\n        },\n    },\n    {\n        name: 'atn',\n        paramTypeSpecs: [types_1.doubleSpec()],\n        returnTypeSpec: types_1.doubleSpec(),\n        run: function (n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, Math.atan(n)];\n                });\n            });\n        },\n    },\n    {\n        name: 'chr$',\n        paramTypeSpecs: [types_1.longSpec()],\n        returnTypeSpec: types_1.stringSpec(),\n        run: function (n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    // We could use iconv-lite here instead:\n                    // return iconv.decode(Buffer.from([n]), 'cp437');\n                    return [2 /*return*/, singlebyte_1.default.bufToStr(Buffer.from([n]), 'cp437')];\n                });\n            });\n        },\n    },\n    {\n        name: 'cdbl',\n        paramTypeSpecs: [types_1.doubleSpec()],\n        returnTypeSpec: types_1.doubleSpec(),\n        run: function (n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, n];\n                });\n            });\n        },\n    },\n    {\n        name: 'cint',\n        paramTypeSpecs: [types_1.doubleSpec()],\n        returnTypeSpec: types_1.longSpec(),\n        run: function (n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, round_half_to_even_1.default(n)];\n                });\n            });\n        },\n    },\n    {\n        name: 'clng',\n        paramTypeSpecs: [types_1.doubleSpec()],\n        returnTypeSpec: types_1.longSpec(),\n        run: function (n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, round_half_to_even_1.default(n)];\n                });\n            });\n        },\n    },\n    {\n        name: 'cos',\n        paramTypeSpecs: [types_1.doubleSpec()],\n        returnTypeSpec: types_1.doubleSpec(),\n        run: function (n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, Math.cos(n)];\n                });\n            });\n        },\n    },\n    {\n        name: 'csng',\n        paramTypeSpecs: [types_1.doubleSpec()],\n        returnTypeSpec: types_1.singleSpec(),\n        run: function (n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, n];\n                });\n            });\n        },\n    },\n    {\n        name: 'csrlin',\n        paramTypeSpecs: [],\n        returnTypeSpec: types_1.longSpec(),\n        run: function (_a) {\n            var platform = _a.platform;\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_b) {\n                    switch (_b.label) {\n                        case 0: return [4 /*yield*/, platform.getCursorPosition()];\n                        case 1: return [2 /*return*/, (_b.sent()).y + 1];\n                    }\n                });\n            });\n        },\n    },\n    {\n        name: 'date$',\n        paramTypeSpecs: [],\n        returnTypeSpec: types_1.stringSpec(),\n        run: function () {\n            return __awaiter(this, void 0, void 0, function () {\n                var now;\n                return __generator(this, function (_a) {\n                    now = new Date();\n                    return [2 /*return*/, [now.getMonth() + 1, now.getDate(), now.getFullYear()]\n                            .map(function (p) { return p.toString().padStart(2, '0'); })\n                            .join('-')];\n                });\n            });\n        },\n    },\n    {\n        name: 'exp',\n        paramTypeSpecs: [types_1.doubleSpec()],\n        returnTypeSpec: types_1.doubleSpec(),\n        run: function (n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, Math.exp(n)];\n                });\n            });\n        },\n    },\n    {\n        name: 'fix',\n        paramTypeSpecs: [types_1.doubleSpec()],\n        returnTypeSpec: types_1.longSpec(),\n        run: function (n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, Math.sign(n) * Math.floor(Math.abs(n))];\n                });\n            });\n        },\n    },\n    {\n        name: 'hex$',\n        paramTypeSpecs: [types_1.longSpec()],\n        returnTypeSpec: types_1.stringSpec(),\n        run: function (n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, n.toString(16).toUpperCase()];\n                });\n            });\n        },\n    },\n    {\n        name: 'inkey$',\n        paramTypeSpecs: [],\n        returnTypeSpec: types_1.stringSpec(),\n        run: function (_a) {\n            var platform = _a.platform;\n            return __awaiter(this, void 0, void 0, function () {\n                var c;\n                return __generator(this, function (_b) {\n                    switch (_b.label) {\n                        case 0: return [4 /*yield*/, platform.getChar()];\n                        case 1:\n                            c = _b.sent();\n                            return [2 /*return*/, c !== null && c !== void 0 ? c : ''];\n                    }\n                });\n            });\n        },\n    },\n    {\n        name: 'input$',\n        paramTypeSpecs: [types_1.longSpec()],\n        returnTypeSpec: types_1.stringSpec(),\n        run: function (n, _a) {\n            var platform = _a.platform;\n            return __awaiter(this, void 0, void 0, function () {\n                var result, c;\n                return __generator(this, function (_b) {\n                    switch (_b.label) {\n                        case 0:\n                            result = [];\n                            _b.label = 1;\n                        case 1:\n                            if (!(result.length < n && !platform.shouldStopExecution)) return [3 /*break*/, 3];\n                            return [4 /*yield*/, platform.getChar()];\n                        case 2:\n                            c = _b.sent();\n                            if (c) {\n                                result.push(c);\n                            }\n                            return [3 /*break*/, 1];\n                        case 3: return [2 /*return*/, result.join('')];\n                    }\n                });\n            });\n        },\n    },\n    {\n        name: 'instr',\n        paramTypeSpecs: [types_1.stringSpec(), types_1.stringSpec()],\n        returnTypeSpec: types_1.longSpec(),\n        run: function (haystack, needle) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, haystack.indexOf(needle) + 1];\n                });\n            });\n        },\n    },\n    {\n        name: 'instr',\n        paramTypeSpecs: [types_1.longSpec(), types_1.stringSpec(), types_1.stringSpec()],\n        returnTypeSpec: types_1.integerSpec(),\n        run: function (start, haystack, needle) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, haystack.indexOf(needle, start - 1) + 1];\n                });\n            });\n        },\n    },\n    {\n        name: 'int',\n        paramTypeSpecs: [types_1.doubleSpec()],\n        returnTypeSpec: types_1.longSpec(),\n        run: function (n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, Math.floor(n)];\n                });\n            });\n        },\n    },\n    {\n        name: 'lbound',\n        paramTypeSpecs: [types_1.arraySpec(types_1.doubleSpec(), [])],\n        returnTypeSpec: types_1.longSpec(),\n        run: function (array) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, array.typeSpec.dimensionSpecs[0][0]];\n                });\n            });\n        },\n    },\n    {\n        name: 'lbound',\n        paramTypeSpecs: [types_1.arraySpec(types_1.doubleSpec(), []), types_1.longSpec()],\n        returnTypeSpec: types_1.longSpec(),\n        run: function (array, dimensionIdx) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    if (dimensionIdx < 1 ||\n                        dimensionIdx > array.typeSpec.dimensionSpecs.length) {\n                        throw new Error(\"Invalid dimension index: \" + dimensionIdx);\n                    }\n                    return [2 /*return*/, array.typeSpec.dimensionSpecs[dimensionIdx - 1][0]];\n                });\n            });\n        },\n    },\n    {\n        name: 'lcase$',\n        paramTypeSpecs: [types_1.stringSpec()],\n        returnTypeSpec: types_1.stringSpec(),\n        run: function (s) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, s.toLowerCase()];\n                });\n            });\n        },\n    },\n    {\n        name: 'left$',\n        paramTypeSpecs: [types_1.stringSpec(), types_1.longSpec()],\n        returnTypeSpec: types_1.stringSpec(),\n        run: function (s, n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, s.substr(0, n)];\n                });\n            });\n        },\n    },\n    {\n        name: 'len',\n        paramTypeSpecs: [types_1.stringSpec()],\n        returnTypeSpec: types_1.longSpec(),\n        run: function (s) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, s.length];\n                });\n            });\n        },\n    },\n    {\n        name: 'log',\n        paramTypeSpecs: [types_1.doubleSpec()],\n        returnTypeSpec: types_1.doubleSpec(),\n        run: function (n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, Math.log(n)];\n                });\n            });\n        },\n    },\n    {\n        name: 'ltrim$',\n        paramTypeSpecs: [types_1.stringSpec()],\n        returnTypeSpec: types_1.stringSpec(),\n        run: function (s) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, s.trimStart()];\n                });\n            });\n        },\n    },\n    {\n        name: 'mid$',\n        paramTypeSpecs: [types_1.stringSpec(), types_1.longSpec(), types_1.longSpec()],\n        returnTypeSpec: types_1.stringSpec(),\n        run: function (s, startIdx, length) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, s.substr(startIdx - 1, length)];\n                });\n            });\n        },\n    },\n    {\n        name: 'oct$',\n        paramTypeSpecs: [types_1.longSpec()],\n        returnTypeSpec: types_1.stringSpec(),\n        run: function (n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, n.toString(8)];\n                });\n            });\n        },\n    },\n    {\n        name: 'peek',\n        paramTypeSpecs: [types_1.longSpec()],\n        returnTypeSpec: types_1.longSpec(),\n        run: function () {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    // STUB\n                    return [2 /*return*/, 0];\n                });\n            });\n        },\n    },\n    {\n        name: 'pos',\n        paramTypeSpecs: [types_1.longSpec()],\n        returnTypeSpec: types_1.longSpec(),\n        run: function (_, _a) {\n            var platform = _a.platform;\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_b) {\n                    switch (_b.label) {\n                        case 0: return [4 /*yield*/, platform.getCursorPosition()];\n                        case 1: return [2 /*return*/, (_b.sent()).x + 1];\n                    }\n                });\n            });\n        },\n    },\n    {\n        name: 'right$',\n        paramTypeSpecs: [types_1.stringSpec(), types_1.longSpec()],\n        returnTypeSpec: types_1.stringSpec(),\n        run: function (s, n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, s.substr(Math.max(0, s.length - n))];\n                });\n            });\n        },\n    }\n], overload({\n    name: 'rnd',\n    returnTypeSpec: types_1.doubleSpec(),\n    run: function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, Math.random()];\n            });\n        });\n    },\n}, [[], [types_1.longSpec()]])), [\n    {\n        name: 'rtrim$',\n        paramTypeSpecs: [types_1.stringSpec()],\n        returnTypeSpec: types_1.stringSpec(),\n        run: function (s, _a) {\n            var args = _a.args;\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_b) {\n                    return [2 /*return*/, s.trimEnd()];\n                });\n            });\n        },\n    },\n    {\n        name: 'sgn',\n        paramTypeSpecs: [types_1.doubleSpec()],\n        returnTypeSpec: types_1.longSpec(),\n        run: function (n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, Math.sign(n)];\n                });\n            });\n        },\n    },\n    {\n        name: 'sin',\n        paramTypeSpecs: [types_1.doubleSpec()],\n        returnTypeSpec: types_1.doubleSpec(),\n        run: function (n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, Math.sin(n)];\n                });\n            });\n        },\n    },\n    {\n        name: 'spc',\n        paramTypeSpecs: [types_1.longSpec()],\n        returnTypeSpec: types_1.stringSpec(),\n        run: function (n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, ' '.repeat(n)];\n                });\n            });\n        },\n    },\n    {\n        name: 'space$',\n        paramTypeSpecs: [types_1.longSpec()],\n        returnTypeSpec: types_1.stringSpec(),\n        run: function (n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, ' '.repeat(n)];\n                });\n            });\n        },\n    },\n    {\n        name: 'sqr',\n        paramTypeSpecs: [types_1.doubleSpec()],\n        returnTypeSpec: types_1.doubleSpec(),\n        run: function (n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, Math.sqrt(n)];\n                });\n            });\n        },\n    },\n    {\n        name: 'str$',\n        paramTypeSpecs: [types_1.doubleSpec()],\n        returnTypeSpec: types_1.stringSpec(),\n        run: function (n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, \"\" + (n >= 0 ? ' ' : '') + n];\n                });\n            });\n        },\n    },\n    {\n        name: 'string$',\n        paramTypeSpecs: [types_1.longSpec(), types_1.longSpec()],\n        returnTypeSpec: types_1.stringSpec(),\n        run: function (m, n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, singlebyte_1.default.bufToStr(Buffer.from([n]), 'cp437').repeat(m)];\n                });\n            });\n        },\n    },\n    {\n        name: 'string$',\n        paramTypeSpecs: [types_1.longSpec(), types_1.stringSpec()],\n        returnTypeSpec: types_1.stringSpec(),\n        run: function (m, s) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    if (s.length === 0) {\n                        throw new Error(\"Empty string argument to STRING$\");\n                    }\n                    return [2 /*return*/, s[0].repeat(m)];\n                });\n            });\n        },\n    },\n    {\n        name: 'tab',\n        paramTypeSpecs: [types_1.longSpec()],\n        returnTypeSpec: types_1.stringSpec(),\n        run: function (col, _a) {\n            var platform = _a.platform;\n            return __awaiter(this, void 0, void 0, function () {\n                var _b, x, y, cols;\n                return __generator(this, function (_c) {\n                    switch (_c.label) {\n                        case 0: return [4 /*yield*/, platform.getCursorPosition()];\n                        case 1:\n                            _b = _c.sent(), x = _b.x, y = _b.y;\n                            return [4 /*yield*/, platform.getScreenSize()];\n                        case 2:\n                            cols = (_c.sent()).cols;\n                            col = (Math.max(1, col) - 1) % cols;\n                            return [4 /*yield*/, platform.moveCursorTo(col, x <= col ? y : y + 1)];\n                        case 3:\n                            _c.sent();\n                            return [2 /*return*/, ''];\n                    }\n                });\n            });\n        },\n    },\n    {\n        name: 'tan',\n        paramTypeSpecs: [types_1.doubleSpec()],\n        returnTypeSpec: types_1.doubleSpec(),\n        run: function (n) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, Math.tan(n)];\n                });\n            });\n        },\n    },\n    {\n        name: 'time$',\n        paramTypeSpecs: [],\n        returnTypeSpec: types_1.stringSpec(),\n        run: function () {\n            return __awaiter(this, void 0, void 0, function () {\n                var now;\n                return __generator(this, function (_a) {\n                    now = new Date();\n                    return [2 /*return*/, [now.getHours(), now.getMinutes(), now.getSeconds()]\n                            .map(function (p) { return p.toString().padStart(2, '0'); })\n                            .join(':')];\n                });\n            });\n        },\n    },\n    {\n        name: 'timer',\n        paramTypeSpecs: [],\n        returnTypeSpec: types_1.longSpec(),\n        run: function () {\n            return __awaiter(this, void 0, void 0, function () {\n                var now, midnight, result;\n                return __generator(this, function (_a) {\n                    now = new Date();\n                    midnight = new Date(now);\n                    midnight.setHours(0, 0, 0, 0);\n                    result = (now.getTime() - midnight.getTime()) / 1000;\n                    return [2 /*return*/, result];\n                });\n            });\n        },\n    },\n    {\n        name: 'ubound',\n        paramTypeSpecs: [types_1.arraySpec(types_1.doubleSpec(), [])],\n        returnTypeSpec: types_1.longSpec(),\n        run: function (array) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, array.typeSpec.dimensionSpecs[0][1]];\n                });\n            });\n        },\n    },\n    {\n        name: 'ubound',\n        paramTypeSpecs: [types_1.arraySpec(types_1.doubleSpec(), []), types_1.longSpec()],\n        returnTypeSpec: types_1.longSpec(),\n        run: function (array, dimensionIdx) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    if (dimensionIdx < 1 ||\n                        dimensionIdx > array.typeSpec.dimensionSpecs.length) {\n                        throw new Error(\"Invalid dimension index: \" + dimensionIdx);\n                    }\n                    return [2 /*return*/, array.typeSpec.dimensionSpecs[dimensionIdx - 1][1]];\n                });\n            });\n        },\n    },\n    {\n        name: 'ucase$',\n        paramTypeSpecs: [types_1.stringSpec()],\n        returnTypeSpec: types_1.stringSpec(),\n        run: function (s) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, s.toUpperCase()];\n                });\n            });\n        },\n    },\n    {\n        name: 'val',\n        paramTypeSpecs: [types_1.stringSpec()],\n        returnTypeSpec: types_1.doubleSpec(),\n        run: function (s) {\n            return __awaiter(this, void 0, void 0, function () {\n                var v;\n                return __generator(this, function (_a) {\n                    v = parseFloat(s);\n                    return [2 /*return*/, isNaN(v) ? 0 : v];\n                });\n            });\n        },\n    },\n]);\n/** Simple statements implemented as built-in subs. */\nexports.BUILTIN_SUBS = __spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([\n    {\n        name: 'beep',\n        paramTypeSpecs: [],\n        run: function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            return __awaiter(this, void 0, void 0, function () {\n                var platform;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            platform = args.pop().platform;\n                            return [4 /*yield*/, platform.beep()];\n                        case 1:\n                            _a.sent();\n                            return [2 /*return*/];\n                    }\n                });\n            });\n        },\n    }\n], overload({\n    name: 'cls',\n    run: function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return __awaiter(this, void 0, void 0, function () {\n            var platform;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        platform = args.pop().platform;\n                        return [4 /*yield*/, platform.clearScreen()];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    },\n}, [[], [types_1.longSpec()]])), overload({\n    name: 'color',\n    run: function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, platform, runtime, getColorName, fg, bg;\n            return __generator(this, function (_b) {\n                _a = args.pop(), platform = _a.platform, runtime = _a.runtime;\n                getColorName = function (n) {\n                    if (n < 0 || n >= runtime.currentScreenModeConfig.colorMap.length) {\n                        throw new Error(\"Invalid color: \" + n);\n                    }\n                    return runtime.currentScreenModeConfig.colorMap[n];\n                };\n                fg = args[0], bg = args[1];\n                if (Number.isFinite(fg)) {\n                    platform.setFgColor(getColorName(fg));\n                }\n                if (Number.isFinite(bg)) {\n                    platform.setBgColor(getColorName(bg));\n                }\n                return [2 /*return*/];\n            });\n        });\n    },\n}, [\n    [types_1.longSpec()],\n    [types_1.longSpec(), types_1.longSpec()],\n    [types_1.longSpec(), types_1.longSpec(), types_1.longSpec()],\n])), overload({\n    name: '__def_seg',\n    run: function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/];\n            });\n        });\n    },\n}, [[], [types_1.longSpec()]])), overload({\n    name: 'locate',\n    run: function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return __awaiter(this, void 0, void 0, function () {\n            var platform, row, col, cursor, origPos, newX, newY;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        platform = args.pop().platform;\n                        row = args[0], col = args[1], cursor = args[2];\n                        if (!(Number.isFinite(row) && Number.isFinite(col))) return [3 /*break*/, 2];\n                        return [4 /*yield*/, platform.moveCursorTo(col - 1, row - 1)];\n                    case 1:\n                        _a.sent();\n                        return [3 /*break*/, 5];\n                    case 2:\n                        if (!(Number.isFinite(row) || Number.isFinite(col))) return [3 /*break*/, 5];\n                        return [4 /*yield*/, platform.getCursorPosition()];\n                    case 3:\n                        origPos = _a.sent();\n                        newX = Number.isFinite(col) ? col - 1 : origPos.x;\n                        newY = Number.isFinite(row) ? row - 1 : origPos.y;\n                        if (!(newX !== origPos.x || newY !== origPos.y)) return [3 /*break*/, 5];\n                        return [4 /*yield*/, platform.moveCursorTo(newX, newY)];\n                    case 4:\n                        _a.sent();\n                        _a.label = 5;\n                    case 5:\n                        if (!Number.isFinite(cursor)) return [3 /*break*/, 7];\n                        return [4 /*yield*/, platform.setCursorVisibility(!!cursor)];\n                    case 6:\n                        _a.sent();\n                        _a.label = 7;\n                    case 7: return [2 /*return*/];\n                }\n            });\n        });\n    },\n}, [\n    [types_1.longSpec()],\n    [types_1.longSpec(), types_1.longSpec()],\n    [types_1.longSpec(), types_1.longSpec(), types_1.longSpec()],\n    [types_1.longSpec(), types_1.longSpec(), types_1.longSpec(), types_1.longSpec()],\n    [types_1.longSpec(), types_1.longSpec(), types_1.longSpec(), types_1.longSpec(), types_1.longSpec()],\n])), [\n    {\n        name: 'play',\n        paramTypeSpecs: [types_1.stringSpec()],\n        run: function () {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/];\n                });\n            });\n        },\n    },\n    {\n        name: 'poke',\n        paramTypeSpecs: [types_1.longSpec(), types_1.longSpec()],\n        run: function () {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/];\n                });\n            });\n        },\n    }\n]), overload({\n    name: 'randomize',\n    run: function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/];\n            });\n        });\n    },\n}, [[], [types_1.longSpec()]])), overload({\n    name: 'screen',\n    run: function (mode) {\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        return __awaiter(this, void 0, void 0, function () {\n            var runtime;\n            return __generator(this, function (_a) {\n                runtime = args.pop().runtime;\n                runtime.setScreenMode(mode);\n                return [2 /*return*/];\n            });\n        });\n    },\n}, [\n    [types_1.longSpec()],\n    [types_1.longSpec(), types_1.longSpec()],\n    [types_1.longSpec(), types_1.longSpec(), types_1.longSpec()],\n    [types_1.longSpec(), types_1.longSpec(), types_1.longSpec(), types_1.longSpec()],\n])), overload({\n    name: 'sleep',\n    run: function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return __awaiter(this, void 0, void 0, function () {\n            var platform, numSeconds, startTimeMs, nowMs, c;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        platform = args.pop().platform;\n                        numSeconds = args.length > 0 ? args[0] : 0;\n                        startTimeMs = new Date().getTime();\n                        _a.label = 1;\n                    case 1: return [4 /*yield*/, platform.getChar()];\n                    case 2:\n                        c = _a.sent();\n                        nowMs = new Date().getTime();\n                        _a.label = 3;\n                    case 3:\n                        if (c === null &&\n                            (numSeconds <= 0 || nowMs - startTimeMs < numSeconds * 1000) &&\n                            !platform.shouldStopExecution) return [3 /*break*/, 1];\n                        _a.label = 4;\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    },\n}, [[], [types_1.longSpec()]])), overload({\n    name: '__view_print',\n    run: function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/];\n            });\n        });\n    },\n}, [[], [types_1.longSpec(), types_1.longSpec()]])), [\n    {\n        name: 'width',\n        paramTypeSpecs: [types_1.longSpec(), types_1.longSpec()],\n        run: function () {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    return [2 /*return*/];\n                });\n            });\n        },\n    },\n]);\n/** Helper function to generate multiple signatures that map to the same built-in proc. */\nfunction overload(proc, paramTypeSpecsList) {\n    return paramTypeSpecsList.map(function (paramTypeSpecs) {\n        return (__assign(__assign({}, proc), { paramTypeSpecs: paramTypeSpecs }));\n    });\n}\nfunction lookupBuiltin(procs, name, argTypeSpecs, _a) {\n    var _b = _a === void 0 ? {} : _a, shouldReturnIfArgTypeMismatch = _b.shouldReturnIfArgTypeMismatch;\n    var builtinFnsMatchingName = symbol_table_1.lookupSymbols(procs, name);\n    var builtinFn = builtinFnsMatchingName.find(function (_a) {\n        var paramTypeSpecs = _a.paramTypeSpecs;\n        return paramTypeSpecs.length === argTypeSpecs.length &&\n            paramTypeSpecs.every(function (paramTypeSpec, i) {\n                return types_1.areMatchingElementaryTypes(paramTypeSpec, argTypeSpecs[i]) ||\n                    (types_1.isArray(paramTypeSpec) && types_1.isArray(argTypeSpecs[i]));\n            });\n    });\n    return (builtinFn !== null && builtinFn !== void 0 ? builtinFn : (shouldReturnIfArgTypeMismatch && builtinFnsMatchingName.length > 0\n        ? builtinFnsMatchingName[0]\n        : null));\n}\nexports.lookupBuiltin = lookupBuiltin;\n\n\n/***/ }),\n\n/***/ 308:\n/***/ ((__unused_webpack_module, exports) => {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.PrintArgType = exports.ExecutionDirectiveType = void 0;\nvar ExecutionDirectiveType;\n(function (ExecutionDirectiveType) {\n    ExecutionDirectiveType[\"GOTO\"] = \"goto\";\n    ExecutionDirectiveType[\"GOSUB\"] = \"gosub\";\n    ExecutionDirectiveType[\"RETURN\"] = \"return\";\n    ExecutionDirectiveType[\"END\"] = \"end\";\n    ExecutionDirectiveType[\"EXIT_PROC\"] = \"exitProc\";\n})(ExecutionDirectiveType = exports.ExecutionDirectiveType || (exports.ExecutionDirectiveType = {}));\n/** Type of an argument to print(). */\nvar PrintArgType;\n(function (PrintArgType) {\n    PrintArgType[\"COMMA\"] = \"comma\";\n    PrintArgType[\"SEMICOLON\"] = \"semicolon\";\n    PrintArgType[\"VALUE\"] = \"value\";\n})(PrintArgType = exports.PrintArgType || (exports.PrintArgType = {}));\n\n\n/***/ }),\n\n/***/ 586:\n/***/ (function(__unused_webpack_module, exports, __nccwpck_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.ExecutionError = void 0;\nvar data_item_1 = __nccwpck_require__(962);\nvar error_with_loc_1 = __importDefault(__nccwpck_require__(813));\nvar symbol_table_1 = __nccwpck_require__(973);\nvar types_1 = __nccwpck_require__(521);\nvar compiled_code_1 = __nccwpck_require__(308);\nvar init_value_1 = __importDefault(__nccwpck_require__(176));\nvar runtime_1 = __importDefault(__nccwpck_require__(753));\nvar ExecutionError = /** @class */ (function (_super) {\n    __extends(ExecutionError, _super);\n    function ExecutionError(message, _a) {\n        var _b = _a === void 0 ? {} : _a, module = _b.module, stmt = _b.stmt;\n        return _super.call(this, message, {\n            sourceFileName: module === null || module === void 0 ? void 0 : module.sourceFileName,\n            loc: (stmt === null || stmt === void 0 ? void 0 : stmt.loc) ? { line: stmt.loc[0], col: stmt.loc[1] } : undefined,\n        }) || this;\n    }\n    return ExecutionError;\n}(error_with_loc_1.default));\nexports.ExecutionError = ExecutionError;\n/** Exception thrown to signal program termination via END. */\nvar EndDirective = /** @class */ (function (_super) {\n    __extends(EndDirective, _super);\n    function EndDirective() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.isEndDirective = true;\n        return _this;\n    }\n    return EndDirective;\n}(Error));\n/** Manages the execution of a compiled program. */\nvar Executor = /** @class */ (function () {\n    function Executor(platform, _a) {\n        var _b = _a === void 0 ? {} : _a, stmtExecutionDelayUs = _b.stmtExecutionDelayUs;\n        this.platform = platform;\n        /** Current module being executed. */\n        this.currentModule = null;\n        /** Static vars, indexed by proc name. */\n        this.localStaticVarsMap = {};\n        /** Label index map for module-level statements. */\n        this.moduleLabelIndexMap = {};\n        /** Label index map for procs. */\n        this.procLabelIndexMap = {};\n        /** Cursor for READ. */\n        this.dataCursor = {\n            stmtIdx: 0,\n            itemIdx: 0,\n        };\n        this.stmtExecutionDelayUs =\n            stmtExecutionDelayUs !== null && stmtExecutionDelayUs !== void 0 ? stmtExecutionDelayUs : platform.defaultStmtExecutionDelayUs;\n    }\n    /** Executes a compiled module. */\n    Executor.prototype.executeModule = function (moduleOrCode) {\n        return __awaiter(this, void 0, void 0, function () {\n            var module, _a, ctx, e_1;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        if (!(typeof moduleOrCode === 'string')) return [3 /*break*/, 2];\n                        return [4 /*yield*/, this.platform.loadCompiledModule(moduleOrCode)];\n                    case 1:\n                        _a = _b.sent();\n                        return [3 /*break*/, 3];\n                    case 2:\n                        _a = moduleOrCode;\n                        _b.label = 3;\n                    case 3:\n                        module = _a;\n                        this.currentModule = module;\n                        this.buildLabelIndexMaps();\n                        this.localStaticVarsMap = {};\n                        this.restore();\n                        this.platform.shouldStopExecution = false;\n                        return [4 /*yield*/, this.platform.setCursorVisibility(false)];\n                    case 4:\n                        _b.sent();\n                        ctx = {\n                            runtime: new runtime_1.default(this.platform),\n                            executeProc: this.executeProc.bind(this),\n                            read: this.read.bind(this),\n                            restore: this.restore.bind(this),\n                            args: {},\n                            localVars: this.initVars(module.localSymbols, [\n                                symbol_table_1.VarType.VAR,\n                                symbol_table_1.VarType.CONST,\n                            ]),\n                            localStaticVars: {},\n                            globalVars: this.initVars(module.globalSymbols, [\n                                symbol_table_1.VarType.VAR,\n                                symbol_table_1.VarType.CONST,\n                            ]),\n                            tempVars: {},\n                        };\n                        _b.label = 5;\n                    case 5:\n                        _b.trys.push([5, 7, 8, 10]);\n                        return [4 /*yield*/, this.executeStmts(ctx, module.stmts, this.moduleLabelIndexMap)];\n                    case 6:\n                        _b.sent();\n                        return [3 /*break*/, 10];\n                    case 7:\n                        e_1 = _b.sent();\n                        if (e_1.isEndDirective) {\n                            // Swallow error\n                        }\n                        else {\n                            throw e_1;\n                        }\n                        return [3 /*break*/, 10];\n                    case 8:\n                        this.currentModule = null;\n                        this.moduleLabelIndexMap = {};\n                        this.procLabelIndexMap = {};\n                        this.localStaticVarsMap = {};\n                        this.restore();\n                        this.platform.shouldStopExecution = false;\n                        return [4 /*yield*/, this.platform.setCursorVisibility(true)];\n                    case 9:\n                        _b.sent();\n                        return [7 /*endfinally*/];\n                    case 10: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Sets flag to stop execution. */\n    Executor.prototype.stopExecution = function () {\n        this.platform.shouldStopExecution = true;\n    };\n    Executor.prototype.executeProc = function (prevCtx, name) {\n        var argPtrs = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n            argPtrs[_i - 2] = arguments[_i];\n        }\n        return __awaiter(this, void 0, void 0, function () {\n            var proc, args, i, ctx;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        proc = symbol_table_1.lookupSymbol(this.currentModule.procs, name);\n                        if (!proc) {\n                            throw new Error(\"Procedure not found: \\\"\" + name + \"\\\"\");\n                        }\n                        // Init args.\n                        if (argPtrs.length !== proc.paramSymbols.length) {\n                            throw new Error('Incorrect number of arguments to ' +\n                                (types_1.procTypeName(proc.type) + \" \\\"\" + proc.name + \"\\\": \") +\n                                (\"expected \" + proc.paramSymbols.length + \", got \" + argPtrs.length));\n                        }\n                        args = {};\n                        for (i = 0; i < argPtrs.length; ++i) {\n                            args[proc.paramSymbols[i].name] = argPtrs[i];\n                        }\n                        // Init static vars.\n                        if (!this.localStaticVarsMap[proc.name]) {\n                            this.localStaticVarsMap[proc.name] = this.initVars(proc.localSymbols, [\n                                symbol_table_1.VarType.STATIC_VAR,\n                            ]);\n                        }\n                        ctx = __assign(__assign({}, prevCtx), { args: args, localVars: this.initVars(proc.localSymbols, [symbol_table_1.VarType.VAR, symbol_table_1.VarType.CONST]), localStaticVars: this.localStaticVarsMap[proc.name], tempVars: {} });\n                        if (!this.procLabelIndexMap[proc.name]) {\n                            throw new Error(\"Label index map not found for \\\"\" + proc.name + \"\\\"\");\n                        }\n                        return [4 /*yield*/, this.executeStmts(ctx, proc.stmts, this.procLabelIndexMap[proc.name])];\n                    case 1:\n                        _a.sent();\n                        // Return value.\n                        if (types_1.isFnOrDefFn(proc.type)) {\n                            return [2 /*return*/, ctx.localVars[proc.name]];\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Executor.prototype.initVars = function (varSymbolTable, includeVarTypes) {\n        var container = {};\n        for (var _i = 0, varSymbolTable_1 = varSymbolTable; _i < varSymbolTable_1.length; _i++) {\n            var symbol = varSymbolTable_1[_i];\n            if (!includeVarTypes.includes(symbol.varType)) {\n                continue;\n            }\n            container[symbol.name] = init_value_1.default(symbol.typeSpec);\n        }\n        return container;\n    };\n    Executor.prototype.executeStmts = function (ctx, stmts, labelIndexMap) {\n        return __awaiter(this, void 0, void 0, function () {\n            var gosubStates, stmtIdx, _loop_1, this_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        gosubStates = [];\n                        stmtIdx = 0;\n                        _loop_1 = function () {\n                            var stmt, errorArgs, directive, e_2, gotoLabel, gosubState;\n                            return __generator(this, function (_b) {\n                                switch (_b.label) {\n                                    case 0:\n                                        if (this_1.platform.shouldStopExecution) {\n                                            this_1.platform.shouldStopExecution = false;\n                                            throw new EndDirective();\n                                        }\n                                        stmt = stmts[stmtIdx];\n                                        errorArgs = { module: this_1.currentModule, stmt: stmt };\n                                        if (!(this_1.stmtExecutionDelayUs > 0)) return [3 /*break*/, 2];\n                                        return [4 /*yield*/, this_1.platform.delay(this_1.stmtExecutionDelayUs)];\n                                    case 1:\n                                        _b.sent();\n                                        _b.label = 2;\n                                    case 2:\n                                        directive = void 0;\n                                        if (!('run' in stmt)) return [3 /*break*/, 6];\n                                        _b.label = 3;\n                                    case 3:\n                                        _b.trys.push([3, 5, , 6]);\n                                        return [4 /*yield*/, stmt.run(ctx)];\n                                    case 4:\n                                        directive = _b.sent();\n                                        return [3 /*break*/, 6];\n                                    case 5:\n                                        e_2 = _b.sent();\n                                        if (e_2.isEndDirective) {\n                                            throw e_2;\n                                        }\n                                        else {\n                                            throw new ExecutionError(e_2.message, errorArgs);\n                                        }\n                                        return [3 /*break*/, 6];\n                                    case 6:\n                                        if (!directive) {\n                                            ++stmtIdx;\n                                            return [2 /*return*/, \"continue\"];\n                                        }\n                                        gotoLabel = function (label) {\n                                            stmtIdx = labelIndexMap[label];\n                                            if (stmtIdx === undefined) {\n                                                throw new ExecutionError(\"Label not found: \\\"\" + label + \"\\\"\", errorArgs);\n                                            }\n                                        };\n                                        switch (directive.type) {\n                                            case compiled_code_1.ExecutionDirectiveType.GOSUB:\n                                                gosubStates.push({\n                                                    nextStmtIdx: stmtIdx + 1,\n                                                });\n                                                gotoLabel(directive.destLabel);\n                                                break;\n                                            case compiled_code_1.ExecutionDirectiveType.GOTO:\n                                                gotoLabel(directive.destLabel);\n                                                break;\n                                            case compiled_code_1.ExecutionDirectiveType.RETURN:\n                                                if (gosubStates.length === 0) {\n                                                    throw new ExecutionError(\"RETURN without prior GOSUB\", errorArgs);\n                                                }\n                                                gosubState = gosubStates.pop();\n                                                if (directive.destLabel) {\n                                                    gotoLabel(directive.destLabel);\n                                                }\n                                                else {\n                                                    stmtIdx = gosubState.nextStmtIdx;\n                                                }\n                                                break;\n                                            case compiled_code_1.ExecutionDirectiveType.END:\n                                                throw new EndDirective();\n                                            case compiled_code_1.ExecutionDirectiveType.EXIT_PROC:\n                                                stmtIdx = stmts.length;\n                                                break;\n                                            default:\n                                                throw new ExecutionError(\"Unrecognized execution directive: \" + JSON.stringify(directive), errorArgs);\n                                        }\n                                        return [2 /*return*/];\n                                }\n                            });\n                        };\n                        this_1 = this;\n                        _a.label = 1;\n                    case 1:\n                        if (!(stmtIdx < stmts.length)) return [3 /*break*/, 3];\n                        return [5 /*yield**/, _loop_1()];\n                    case 2:\n                        _a.sent();\n                        return [3 /*break*/, 1];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Executor.prototype.read = function () {\n        var resultTypes = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            resultTypes[_i] = arguments[_i];\n        }\n        return __awaiter(this, void 0, void 0, function () {\n            var results, i, dataItem;\n            return __generator(this, function (_a) {\n                results = [];\n                for (i = 0; i < resultTypes.length; ++i) {\n                    dataItem = this.getNextDataItem();\n                    if (!dataItem) {\n                        throw new Error(\"Data exhausted at item \" + (i + 1));\n                    }\n                    try {\n                        results.push(data_item_1.getDataItem(dataItem, resultTypes[i]));\n                    }\n                    catch (e) {\n                        e.message = \"Error reading item \" + (i + 1) + \": \" + e.message;\n                        throw e;\n                    }\n                }\n                return [2 /*return*/, results];\n            });\n        });\n    };\n    Executor.prototype.getNextDataItem = function () {\n        var stmts = this.currentModule.stmts;\n        for (;;) {\n            if (this.dataCursor.stmtIdx >= stmts.length) {\n                return null;\n            }\n            var stmt = stmts[this.dataCursor.stmtIdx];\n            if (!('data' in stmt)) {\n                ++this.dataCursor.stmtIdx;\n                continue;\n            }\n            if (this.dataCursor.itemIdx >= stmt.data.length) {\n                ++this.dataCursor.stmtIdx;\n                this.dataCursor.itemIdx = 0;\n                continue;\n            }\n            return stmt.data[this.dataCursor.itemIdx++];\n        }\n    };\n    Executor.prototype.restore = function (destLabel) {\n        return __awaiter(this, void 0, void 0, function () {\n            var stmtIdx;\n            var _a, _b;\n            return __generator(this, function (_c) {\n                if (destLabel) {\n                    stmtIdx = this.moduleLabelIndexMap[destLabel];\n                    if (stmtIdx === undefined) {\n                        throw new Error(\"Label not found: \\\"\" + destLabel + \"\\\"\");\n                    }\n                    _a = [stmtIdx, 0], this.dataCursor.stmtIdx = _a[0], this.dataCursor.itemIdx = _a[1];\n                }\n                else {\n                    _b = [0, 0], this.dataCursor.stmtIdx = _b[0], this.dataCursor.itemIdx = _b[1];\n                }\n                return [2 /*return*/];\n            });\n        });\n    };\n    Executor.prototype.buildLabelIndexMaps = function () {\n        this.moduleLabelIndexMap = this.buildLabelIndexMap(this.currentModule.stmts);\n        for (var _i = 0, _a = this.currentModule.procs; _i < _a.length; _i++) {\n            var _b = _a[_i], name_1 = _b.name, stmts = _b.stmts;\n            this.procLabelIndexMap[name_1] = this.buildLabelIndexMap(stmts);\n        }\n    };\n    Executor.prototype.buildLabelIndexMap = function (stmts) {\n        var _this = this;\n        var labelIndexMap = {};\n        stmts.forEach(function (stmt, idx) {\n            if ('label' in stmt) {\n                if (stmt.label in labelIndexMap) {\n                    throw new ExecutionError(\"Duplicate label \\\"\" + stmt.label + \"\\\"\", {\n                        module: _this.currentModule,\n                        stmt: stmt,\n                    });\n                }\n                labelIndexMap[stmt.label] = idx;\n            }\n        });\n        return labelIndexMap;\n    };\n    return Executor;\n}());\nexports.default = Executor;\n\n\n/***/ }),\n\n/***/ 176:\n/***/ (function(__unused_webpack_module, exports, __nccwpck_require__) {\n\n\"use strict\";\n\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nvar _a;\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nvar types_1 = __nccwpck_require__(521);\nvar qb_array_1 = __importDefault(__nccwpck_require__(59));\nvar qb_udt_1 = __importDefault(__nccwpck_require__(83));\n/** Initial value for elementary data types. */\nvar ELEMENTARY_TYPE_INIT_VALUES = (_a = {},\n    _a[types_1.DataType.INTEGER] = 0,\n    _a[types_1.DataType.LONG] = 0,\n    _a[types_1.DataType.SINGLE] = 0.0,\n    _a[types_1.DataType.DOUBLE] = 0.0,\n    _a[types_1.DataType.STRING] = '',\n    _a);\nfunction initValue(typeSpec) {\n    var dataType = typeSpec.type;\n    if (types_1.isElementaryType(dataType)) {\n        return ELEMENTARY_TYPE_INIT_VALUES[dataType];\n    }\n    switch (typeSpec.type) {\n        case types_1.DataType.ARRAY:\n            return new qb_array_1.default(typeSpec);\n        case types_1.DataType.UDT:\n            return new qb_udt_1.default(typeSpec);\n        default:\n            throw new Error(\"Unknown type: \" + JSON.stringify(typeSpec));\n    }\n}\nexports.default = initValue;\n\n\n/***/ }),\n\n/***/ 999:\n/***/ (function(__unused_webpack_module, exports, __nccwpck_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.NodeExecutor = exports.NodePlatform = void 0;\nvar ansi_escapes_1 = __importDefault(__nccwpck_require__(575));\nvar perf_hooks_1 = __nccwpck_require__(630);\nvar require_from_string_1 = __importDefault(__nccwpck_require__(7));\nvar ansi_terminal_platform_1 = __importDefault(__nccwpck_require__(769));\nvar executor_1 = __importDefault(__nccwpck_require__(586));\n/** RuntimePlatform for Node.JS on TTY. */\nvar NodePlatform = /** @class */ (function (_super) {\n    __extends(NodePlatform, _super);\n    function NodePlatform() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        // When running in Node, delay is implemented using setImmediate and won't\n        // block other functionality. So we can safely set a higher delay value for\n        // better compatibility.\n        _this.defaultStmtExecutionDelayUs = 5;\n        return _this;\n    }\n    NodePlatform.prototype.loadCompiledModule = function (code) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, require_from_string_1.default(code)];\n            });\n        });\n    };\n    NodePlatform.prototype.delay = function (delayInUs) {\n        return __awaiter(this, void 0, void 0, function () {\n            var t0;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        t0 = perf_hooks_1.performance.now();\n                        _a.label = 1;\n                    case 1:\n                        if (!((perf_hooks_1.performance.now() - t0) * 1000 < delayInUs)) return [3 /*break*/, 3];\n                        return [4 /*yield*/, new Promise(function (resolve) { return setImmediate(resolve); })];\n                    case 2:\n                        _a.sent();\n                        return [3 /*break*/, 1];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NodePlatform.prototype.print = function (s) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                process.stdout.write(s);\n                return [2 /*return*/];\n            });\n        });\n    };\n    NodePlatform.prototype.inputLine = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, new Promise(function (resolve) {\n                        process.stdin.resume();\n                        process.stdin.setRawMode(false);\n                        process.stdin.once('data', function (chunk) {\n                            process.stdin.pause();\n                            resolve(chunk.toString());\n                        });\n                    })];\n            });\n        });\n    };\n    NodePlatform.prototype.getChar = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var result, callbackFn;\n            var _this = this;\n            return __generator(this, function (_a) {\n                result = null;\n                process.stdin.resume();\n                process.stdin.setRawMode(true);\n                callbackFn = function (chunk) {\n                    result = _this.translateKeyCode(chunk.toString());\n                    // Handle Ctrl-C\n                    if (result === String.fromCharCode(3)) {\n                        throw new Error('Received Ctrl-C, aborting');\n                    }\n                    process.stdin.pause();\n                };\n                process.stdin.once('data', callbackFn);\n                return [2 /*return*/, new Promise(function (resolve) {\n                        setTimeout(function () {\n                            if (result === null) {\n                                process.stdin.removeListener('data', callbackFn);\n                                process.stdin.pause();\n                            }\n                            resolve(result);\n                        }, 20);\n                    })];\n            });\n        });\n    };\n    NodePlatform.prototype.getCursorPosition = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var originalIsRaw;\n            return __generator(this, function (_a) {\n                // Based on https://github.com/bubkoo/get-cursor-position/blob/master/index.js\n                process.stdin.resume();\n                originalIsRaw = process.stdin.isRaw;\n                process.stdin.setRawMode(true);\n                return [2 /*return*/, new Promise(function (resolve, reject) {\n                        process.stdin.once('data', function (chunk) {\n                            process.stdin.pause();\n                            process.stdin.setRawMode(originalIsRaw);\n                            var match = chunk.toString().match(/\\[(\\d+)\\;(\\d+)R/);\n                            if (match) {\n                                var _a = [match[1], match[2]], row = _a[0], col = _a[1];\n                                var result = {\n                                    // ANSI row & col numbers are 1-based.\n                                    x: parseInt(col) - 1,\n                                    y: parseInt(row) - 1,\n                                };\n                                resolve(result);\n                            }\n                            else {\n                                reject();\n                            }\n                        });\n                        process.stdout.write(ansi_escapes_1.default.cursorGetPosition);\n                    })];\n            });\n        });\n    };\n    NodePlatform.prototype.getScreenSize = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var origPos, bottomRightPos;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getCursorPosition()];\n                    case 1:\n                        origPos = _a.sent();\n                        return [4 /*yield*/, this.moveCursorTo(10000, 10000)];\n                    case 2:\n                        _a.sent();\n                        return [4 /*yield*/, this.getCursorPosition()];\n                    case 3:\n                        bottomRightPos = _a.sent();\n                        return [4 /*yield*/, this.moveCursorTo(origPos.x, origPos.y)];\n                    case 4:\n                        _a.sent();\n                        return [2 /*return*/, {\n                                rows: bottomRightPos.y + 1,\n                                cols: bottomRightPos.x + 1,\n                            }];\n                }\n            });\n        });\n    };\n    return NodePlatform;\n}(ansi_terminal_platform_1.default));\nexports.NodePlatform = NodePlatform;\nvar NodeExecutor = /** @class */ (function (_super) {\n    __extends(NodeExecutor, _super);\n    function NodeExecutor(opts) {\n        if (opts === void 0) { opts = {}; }\n        return _super.call(this, new NodePlatform(), opts) || this;\n    }\n    return NodeExecutor;\n}(executor_1.default));\nexports.NodeExecutor = NodeExecutor;\n\n\n/***/ }),\n\n/***/ 421:\n/***/ (function(module, exports, __nccwpck_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nvar node_platform_1 = __nccwpck_require__(999);\n/** Executes the bundled module.\n *\n * This is the main execution entrypoint to a compiled program.\n */\nfunction run(opts) {\n    if (opts === void 0) { opts = {}; }\n    return __awaiter(this, void 0, void 0, function () {\n        var stmtExecutionDelayUs;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    if (process.env.DELAY) {\n                        stmtExecutionDelayUs = parseInt(process.env.DELAY);\n                        if (isNaN(stmtExecutionDelayUs)) {\n                            stmtExecutionDelayUs = undefined;\n                        }\n                    }\n                    return [4 /*yield*/, new node_platform_1.NodeExecutor(__assign({ stmtExecutionDelayUs: stmtExecutionDelayUs }, opts)).executeModule(compiledModule)];\n                case 1: return [2 /*return*/, _a.sent()];\n            }\n        });\n    });\n}\nmodule.exports = __assign(__assign({}, (typeof compiledModule === 'undefined' ? {} : compiledModule)), { run: run });\n// When invoked directly as part of a compiled program, execute the bundled module.\nif (require.main === require.cache[eval('__filename')]) {\n    run();\n}\n\n\n/***/ }),\n\n/***/ 59:\n/***/ (function(__unused_webpack_module, exports, __nccwpck_require__) {\n\n\"use strict\";\n\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nvar types_1 = __nccwpck_require__(521);\nvar init_value_1 = __importDefault(__nccwpck_require__(176));\n/** Runtime representation for QBasic arrays. */\nvar QbArray = /** @class */ (function () {\n    function QbArray(arrayTypeSpec) {\n        /** The underlying array storing the actual elements. */\n        this._values = [];\n        this.init(arrayTypeSpec.elementTypeSpec, arrayTypeSpec.dimensionSpecs);\n    }\n    /** Initializes the array with the provided spec, discarding any previous contents. */\n    QbArray.prototype.init = function (elementTypeSpec, dimensionSpecs) {\n        if (dimensionSpecs.length === 0) {\n            throw new Error('No dimension specs provided');\n        }\n        this._typeSpec = types_1.arraySpec(elementTypeSpec, dimensionSpecs);\n        this._values.length = 0;\n        var currentDimensionArrays = [this._values];\n        for (var i = 0; i < dimensionSpecs.length; ++i) {\n            var _a = dimensionSpecs[i], minIdx = _a[0], maxIdx = _a[1];\n            var numElements = maxIdx - minIdx + 1;\n            var nextDimensionArrays = [];\n            for (var _i = 0, currentDimensionArrays_1 = currentDimensionArrays; _i < currentDimensionArrays_1.length; _i++) {\n                var dimensionArray = currentDimensionArrays_1[_i];\n                if (i === dimensionSpecs.length - 1) {\n                    for (var j = 0; j < numElements; ++j) {\n                        dimensionArray.push(init_value_1.default(elementTypeSpec));\n                    }\n                }\n                else {\n                    for (var j = 0; j < numElements; ++j) {\n                        var nextDimensionArray = new Array();\n                        nextDimensionArrays.push(nextDimensionArray);\n                        dimensionArray.push(nextDimensionArray);\n                    }\n                }\n            }\n            currentDimensionArrays = nextDimensionArrays;\n        }\n    };\n    /** Translates a QBasic index into the index in the underlying array. */\n    QbArray.prototype.getIdx = function (dimensionIdx, qbIdx) {\n        var dimensionSpecs = this._typeSpec.dimensionSpecs;\n        if (!Number.isFinite(dimensionIdx) ||\n            dimensionIdx < 0 ||\n            dimensionIdx >= dimensionSpecs.length) {\n            throw new Error('Invalid dimension in getIndex: ' +\n                (\"expected number between 0 and \" + (dimensionSpecs.length - 1) + \", \") +\n                (\"got \" + dimensionIdx));\n        }\n        var _a = dimensionSpecs[dimensionIdx], minIdx = _a[0], maxIdx = _a[1];\n        if (!Number.isFinite(qbIdx) || qbIdx < minIdx || qbIdx > maxIdx) {\n            throw new Error(\"Index out of range for dimension \" + (dimensionIdx + 1) + \": \" +\n                (\"expected number between \" + minIdx + \" and \" + maxIdx + \", \") +\n                (\"got \" + qbIdx));\n        }\n        return qbIdx - minIdx;\n    };\n    Object.defineProperty(QbArray.prototype, \"values\", {\n        get: function () {\n            return this._values;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(QbArray.prototype, \"typeSpec\", {\n        get: function () {\n            return this._typeSpec;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return QbArray;\n}());\nexports.default = QbArray;\n\n\n/***/ }),\n\n/***/ 83:\n/***/ (function(__unused_webpack_module, exports, __nccwpck_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nvar types_1 = __nccwpck_require__(521);\nvar init_value_1 = __importDefault(__nccwpck_require__(176));\n/** Runtime representation for QBasic user-defined types. */\nvar QbUdt = /** @class */ (function () {\n    function QbUdt(udtTypeSpec) {\n        /** The underlying array storing the actual elements. */\n        this._values = {};\n        this._typeSpec = __assign({}, udtTypeSpec);\n        this.init();\n    }\n    QbUdt.prototype.init = function () {\n        for (var _i = 0, _a = this._typeSpec.fieldSpecs; _i < _a.length; _i++) {\n            var fieldSpec = _a[_i];\n            this._values[fieldSpec.name] = init_value_1.default(fieldSpec.typeSpec);\n        }\n    };\n    QbUdt.prototype.clone = function () {\n        var newQbUdt = new QbUdt(this._typeSpec);\n        for (var _i = 0, _a = this._typeSpec.fieldSpecs; _i < _a.length; _i++) {\n            var fieldSpec = _a[_i];\n            var value = this._values[fieldSpec.name];\n            newQbUdt._values[fieldSpec.name] = types_1.isUdt(fieldSpec.typeSpec)\n                ? value.clone()\n                : value;\n        }\n        return newQbUdt;\n    };\n    Object.defineProperty(QbUdt.prototype, \"values\", {\n        get: function () {\n            return this._values;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(QbUdt.prototype, \"typeSpec\", {\n        get: function () {\n            return this._typeSpec;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return QbUdt;\n}());\nexports.default = QbUdt;\n\n\n/***/ }),\n\n/***/ 753:\n/***/ (function(__unused_webpack_module, exports, __nccwpck_require__) {\n\n\"use strict\";\n\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from) {\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\n        to[j] = from[i];\n    return to;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.SCREEN_MODE_CONFIGS = exports.RuntimePlatform = void 0;\nvar moo_1 = __importDefault(__nccwpck_require__(357));\nvar types_1 = __nccwpck_require__(521);\nvar builtins_1 = __nccwpck_require__(562);\nvar compiled_code_1 = __nccwpck_require__(308);\nvar round_half_to_even_1 = __importDefault(__nccwpck_require__(345));\n/** Interface for platform-specific runtime functionality. */\nvar RuntimePlatform = /** @class */ (function () {\n    function RuntimePlatform() {\n        /** Flag indicating we should stop executing.\n         *\n         * Setting this flag will cause blocking methods like `inputLine()` to exit early.\n         */\n        this.shouldStopExecution = false;\n    }\n    return RuntimePlatform;\n}());\nexports.RuntimePlatform = RuntimePlatform;\nexports.SCREEN_MODE_CONFIGS = [\n    {\n        mode: 0,\n        textModeDimensions: [{ rows: 80, cols: 25 }],\n        colorMap: [\n            'black',\n            'blue',\n            'green',\n            'cyan',\n            'red',\n            'magenta',\n            'yellow',\n            'white',\n            'gray',\n            'blueBright',\n            'greenBright',\n            'cyanBright',\n            'redBright',\n            'magentaBright',\n            'yellowBright',\n            'whiteBright',\n        ],\n    },\n];\n/** Runtime support library.\n *\n * This class provides the interface invoked by compiled code. It is platform-agnostic, and wraps\n * the low-level, platform-dependent functionality in the injected RuntimePlatform.\n */\nvar Runtime = /** @class */ (function () {\n    function Runtime(platform) {\n        this.platform = platform;\n        this.roundHalfToEven = round_half_to_even_1.default;\n        this.printFormatStringLexer = moo_1.default.compile({\n            NUMBER: /(?:[#,])*\\.#+|[#,]+/,\n            STRING: '&',\n            DOLLAR_SIGNS: /\\$+/,\n            LITERAL: {\n                match: /[^.#&\\$]+/,\n                lineBreaks: true,\n            },\n        });\n        /** Lexer for input(). */\n        this.inputLexer = moo_1.default.compile({\n            WHITESPACE: { match: /\\s+/, lineBreaks: true },\n            QUOTED_STRING: {\n                match: /\"[^\"]*\"/,\n                value: function (text) { return text.substr(1, text.length - 2); },\n                type: function () { return 'STRING'; },\n            },\n            COMMA: ',',\n            STRING: /[^,\\s]+/,\n        });\n        this.currentScreenMode = 0;\n    }\n    Runtime.prototype.executeBuiltinProc = function (name, argTypeSpecs) {\n        var args = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n            args[_i - 2] = arguments[_i];\n        }\n        return __awaiter(this, void 0, void 0, function () {\n            var builtinProc, runContext;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        builtinProc = builtins_1.lookupBuiltin(builtins_1.BUILTIN_FNS, name, argTypeSpecs) ||\n                            builtins_1.lookupBuiltin(builtins_1.BUILTIN_SUBS, name, argTypeSpecs);\n                        if (!builtinProc) {\n                            throw new Error(\"No matching built-in procedure found: \\\"\" + name + \"\\\"\");\n                        }\n                        if (argTypeSpecs.length !== args.length) {\n                            throw new Error(\"Argument types and values do not match: \" +\n                                (\"expected \" + argTypeSpecs.length + \" arguments, got \" + args.length));\n                        }\n                        runContext = {\n                            runtime: this,\n                            platform: this.platform,\n                            argTypeSpecs: argTypeSpecs,\n                            args: args,\n                        };\n                        return [4 /*yield*/, builtinProc.run.apply(builtinProc, __spreadArray(__spreadArray([], args.map(function (ptr) { return ptr[0][ptr[1]]; })), [runContext]))];\n                    case 1: return [2 /*return*/, _a.sent()];\n                }\n            });\n        });\n    };\n    Runtime.prototype.print = function (formatString) {\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        return __awaiter(this, void 0, void 0, function () {\n            var line;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        line = formatString\n                            ? this.printWithFormatString(formatString, args)\n                            : this.printWithDefaultFormat(args);\n                        if (args.length === 0 ||\n                            args[args.length - 1].type === compiled_code_1.PrintArgType.VALUE) {\n                            line += '\\n';\n                        }\n                        return [4 /*yield*/, this.platform.print(line)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Implements PRINT USING format strings.\n     *\n     * This is a VERY incomplete implementation. Supported:\n     *\n     *   - Formatting numbers with ##.##\n     *   - Formatting string with &\n     */\n    Runtime.prototype.printWithFormatString = function (formatString, args) {\n        var pieces = [];\n        var argIdx = 0;\n        this.printFormatStringLexer.reset(formatString);\n        for (;;) {\n            while (argIdx < args.length && args[argIdx].type !== compiled_code_1.PrintArgType.VALUE) {\n                ++argIdx;\n            }\n            var nextArg = argIdx < args.length ? args[argIdx] : null;\n            var token = this.printFormatStringLexer.next();\n            if (!token) {\n                break;\n            }\n            switch (token.type) {\n                case 'NUMBER':\n                    if (!nextArg || typeof nextArg.value !== 'number') {\n                        throw new Error('Formatting error: expected number ' +\n                            (\"as argument #\" + (argIdx + 1) + \", got \" + typeof (nextArg === null || nextArg === void 0 ? void 0 : nextArg.value)));\n                    }\n                    var _a = token.value.split('.'), integralFormat = _a[0], fractionFormat = _a[1];\n                    // Not supporting commas yet.\n                    var integralFormatLength = integralFormat.replace(/,/, '').length;\n                    if (fractionFormat) {\n                        var formattedValue = (\"\" + Math.floor(nextArg.value)).padStart(integralFormatLength) +\n                            '.' +\n                            nextArg.value.toFixed(fractionFormat.length).split('.')[1];\n                        pieces.push(formattedValue);\n                    }\n                    else {\n                        var formattedValue = nextArg.value.toFixed(0).padStart(integralFormatLength) +\n                            (token.value.indexOf('.') >= 0 ? '.' : '');\n                        pieces.push(formattedValue);\n                    }\n                    ++argIdx;\n                    break;\n                case 'STRING':\n                    if (!nextArg || typeof nextArg.value !== 'string') {\n                        throw new Error(\"Formatting error: expected string as argument #\" + (argIdx + 1));\n                    }\n                    pieces.push(nextArg.value);\n                    ++argIdx;\n                    break;\n                case 'DOLLAR_SIGNS': {\n                    var value = void 0;\n                    if (token.value.length <= 1) {\n                        value = token.value;\n                    }\n                    else if (token.value.length === 2) {\n                        value = ' $';\n                    }\n                    else {\n                        value = '%$';\n                    }\n                    pieces.push(value);\n                    break;\n                }\n                case 'LITERAL':\n                    pieces.push(token.value);\n                    break;\n                default:\n                    throw new Error(\"Unexpected token type: \" + JSON.stringify(token));\n            }\n        }\n        return pieces.join('');\n    };\n    Runtime.prototype.printWithDefaultFormat = function (args) {\n        var PRINT_ZONE_LENGTH = 14;\n        var line = '';\n        for (var _i = 0, args_1 = args; _i < args_1.length; _i++) {\n            var arg = args_1[_i];\n            switch (arg.type) {\n                case compiled_code_1.PrintArgType.SEMICOLON:\n                    break;\n                case compiled_code_1.PrintArgType.COMMA:\n                    var numPaddingChars = PRINT_ZONE_LENGTH - (line.length % PRINT_ZONE_LENGTH);\n                    line += ' '.repeat(numPaddingChars);\n                    break;\n                case compiled_code_1.PrintArgType.VALUE:\n                    if (typeof arg.value === 'string') {\n                        line += \"\" + arg.value;\n                        break;\n                    }\n                    else if (typeof arg.value === 'number') {\n                        line += \"\" + (arg.value >= 0 ? ' ' : '') + arg.value + \" \";\n                        break;\n                    }\n                    else {\n                        // Fall through\n                    }\n                default:\n                    throw new Error(\"Unknown print arg: '\" + JSON.stringify(arg) + \"'\");\n            }\n        }\n        return line;\n    };\n    Runtime.prototype.inputLine = function (prompt) {\n        return __awaiter(this, void 0, void 0, function () {\n            var line;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!prompt) return [3 /*break*/, 2];\n                        return [4 /*yield*/, this.platform.print(prompt)];\n                    case 1:\n                        _a.sent();\n                        _a.label = 2;\n                    case 2: return [4 /*yield*/, this.platform.setCursorVisibility(true)];\n                    case 3:\n                        _a.sent();\n                        return [4 /*yield*/, this.platform.inputLine()];\n                    case 4:\n                        line = _a.sent();\n                        return [4 /*yield*/, this.platform.setCursorVisibility(false)];\n                    case 5:\n                        _a.sent();\n                        return [2 /*return*/, line];\n                }\n            });\n        });\n    };\n    Runtime.prototype.input = function (prompt) {\n        var resultTypes = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            resultTypes[_i - 1] = arguments[_i];\n        }\n        return __awaiter(this, void 0, void 0, function () {\n            var results, line, tokens, tokenIdx, errorMessage, resultIdx, resultType, errorMessagePrefix, tokenValue, numericValue;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        results = [];\n                        return [4 /*yield*/, this.platform.print(prompt)];\n                    case 1:\n                        _a.sent();\n                        return [4 /*yield*/, this.inputLine('')];\n                    case 2:\n                        line = _a.sent();\n                        if (this.platform.shouldStopExecution) {\n                            return [2 /*return*/, results];\n                        }\n                        tokens = this.lexInput(line);\n                        tokenIdx = 0;\n                        errorMessage = null;\n                        for (resultIdx = 0; resultIdx < resultTypes.length; ++resultIdx) {\n                            resultType = resultTypes[resultIdx];\n                            errorMessagePrefix = \"Error parsing value \" + (resultIdx + 1) + \": \";\n                            // Consume comma token for result 1+.\n                            if (resultIdx > 0) {\n                                if (tokenIdx < tokens.length && tokens[tokenIdx].type === 'COMMA') {\n                                    ++tokenIdx;\n                                }\n                                else {\n                                    errorMessage = errorMessagePrefix + \"Comma expected\";\n                                    break;\n                                }\n                            }\n                            // Consume value.\n                            if (tokenIdx < tokens.length && tokens[tokenIdx].type === 'STRING') {\n                                tokenValue = tokens[tokenIdx].value;\n                                if (types_1.isString(resultType)) {\n                                    results.push(tokenValue);\n                                }\n                                else if (types_1.isNumeric(resultType)) {\n                                    numericValue = parseFloat(tokenValue);\n                                    if (isNaN(numericValue)) {\n                                        errorMessage = errorMessagePrefix + \"Invalid numeric value \\\"\" + tokenValue + \"\\\"\";\n                                        break;\n                                    }\n                                    else {\n                                        results.push(numericValue);\n                                    }\n                                }\n                                else {\n                                    throw new Error(\"Unexpected result type \" + resultType.type);\n                                }\n                                ++tokenIdx;\n                            }\n                            else {\n                                errorMessage = errorMessagePrefix + \"No value provided\";\n                                break;\n                            }\n                        }\n                        if (!(results.length === resultTypes.length)) return [3 /*break*/, 3];\n                        return [2 /*return*/, results];\n                    case 3:\n                        if (!(results.length < resultTypes.length)) return [3 /*break*/, 5];\n                        return [4 /*yield*/, this.platform.print(\"\\n\" + (errorMessage ? errorMessage + \"\\n\" : '') + \"Redo from start\\n\")];\n                    case 4:\n                        _a.sent();\n                        return [3 /*break*/, 6];\n                    case 5: \n                    // This would indicate a logic error above - we should stop consuming from input once the\n                    // expected number of results has been reached.\n                    throw new Error(\"Too many results: expected \" + resultTypes.length + \", got \" + results.length);\n                    case 6: return [3 /*break*/, 0];\n                    case 7: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Runtime.prototype.lexInput = function (line) {\n        this.inputLexer.reset(line.trim());\n        var tokens = [];\n        for (;;) {\n            var token = this.inputLexer.next();\n            if (!token) {\n                break;\n            }\n            if (token.type !== 'WHITESPACE') {\n                tokens.push(token);\n            }\n        }\n        return tokens;\n    };\n    Runtime.prototype.setScreenMode = function (n) {\n        var screenMode = exports.SCREEN_MODE_CONFIGS.find(function (_a) {\n            var mode = _a.mode;\n            return mode === n;\n        });\n        if (!screenMode) {\n            throw new Error(\"Unsupported screen mode: \" + n);\n        }\n        this.currentScreenMode = n;\n    };\n    Object.defineProperty(Runtime.prototype, \"currentScreenModeConfig\", {\n        get: function () {\n            var _this = this;\n            return exports.SCREEN_MODE_CONFIGS.find(function (_a) {\n                var mode = _a.mode;\n                return mode === _this.currentScreenMode;\n            });\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return Runtime;\n}());\nexports.default = Runtime;\n\n\n/***/ }),\n\n/***/ 282:\n/***/ ((module) => {\n\n\"use strict\";\nmodule.exports = require(\"module\");;\n\n/***/ }),\n\n/***/ 622:\n/***/ ((module) => {\n\n\"use strict\";\nmodule.exports = require(\"path\");;\n\n/***/ }),\n\n/***/ 630:\n/***/ ((module) => {\n\n\"use strict\";\nmodule.exports = require(\"perf_hooks\");;\n\n/***/ })\n\n/******/ \t});\n/************************************************************************/\n/******/ \t// The module cache\n/******/ \tvar __webpack_module_cache__ = {};\n/******/ \t\n/******/ \t// The require function\n/******/ \tfunction __nccwpck_require__(moduleId) {\n/******/ \t\t// Check if module is in cache\n/******/ \t\tvar cachedModule = __webpack_module_cache__[moduleId];\n/******/ \t\tif (cachedModule !== undefined) {\n/******/ \t\t\treturn cachedModule.exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = __webpack_module_cache__[moduleId] = {\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/ \t\n/******/ \t\t// Execute the module function\n/******/ \t\tvar threw = true;\n/******/ \t\ttry {\n/******/ \t\t\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __nccwpck_require__);\n/******/ \t\t\tthrew = false;\n/******/ \t\t} finally {\n/******/ \t\t\tif(threw) delete __webpack_module_cache__[moduleId];\n/******/ \t\t}\n/******/ \t\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/ \t\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/ \t\n/************************************************************************/\n/******/ \t/* webpack/runtime/node module decorator */\n/******/ \t(() => {\n/******/ \t\t__nccwpck_require__.nmd = (module) => {\n/******/ \t\t\tmodule.paths = [];\n/******/ \t\t\tif (!module.children) module.children = [];\n/******/ \t\t\treturn module;\n/******/ \t\t};\n/******/ \t})();\n/******/ \t\n/******/ \t/* webpack/runtime/compat */\n/******/ \t\n/******/ \tif (typeof __nccwpck_require__ !== 'undefined') __nccwpck_require__.ab = __dirname + \"/\";/************************************************************************/\n/******/ \t\n/******/ \t// startup\n/******/ \t// Load entry module and return exports\n/******/ \t// This entry module is referenced by other modules so it can't be inlined\n/******/ \tvar __webpack_exports__ = __nccwpck_require__(421);\n/******/ \tmodule.exports = __webpack_exports__;\n/******/ \t\n/******/ })()\n;"}},685:function(e,n,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.createParser=void 0;var o=t(686),s=r(t(687)),a=r(t(159)),i=r(t(94));function u(e){return new o.Parser(o.Grammar.fromCompiled(s.default),e)}n.createParser=u,n.default=function(e,n){var t=u(n);try{t.feed(e),t.feed("\n")}catch(r){throw"token"in r?new i.default(r.message.replace(/ Instead, I was expecting to see one of the following:$[\s\S]*/gm,""),{sourceFileName:null===n||void 0===n?void 0:n.sourceFileName,loc:r.token}):r}if(0===t.results.length)throw new i.default("Unexpected end of input",{sourceFileName:null===n||void 0===n?void 0:n.sourceFileName,loc:a.default.lastToken});if(1!==t.results.length)throw new i.default(t.results.length+" parse trees:\n\n"+t.results.map((function(e,n){return"Parse tree #"+(n+1)+":\n"+JSON.stringify(e,null,4)})).join("\n\n"),{sourceFileName:null===n||void 0===n?void 0:n.sourceFileName,loc:a.default.lastToken});return t.results[0]}},687:function(e,n,t){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)},o=this&&this.__spreadArray||function(e,n){for(var t=0,r=n.length,o=e.length;t<r;t++,o++)e[o]=n[t];return e},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};function a(e){return e[0]}Object.defineProperty(n,"__esModule",{value:!0});var i=s(t(34)),u=s(t(159)),c=t(132),p=t(38);function l(){return null}function m(e){if("loc"in e)return{loc:e.loc};if("line"in e&&"col"in e)return{loc:{line:e.line,col:e.col}};throw new Error("Invalid tokenOrAstNode: "+JSON.stringify(e))}function f(e){var n=e[0],t=e[1],o=e[2];return r({type:c.ExprType.BINARY_OP,op:a(t).type.toLowerCase(),leftExpr:n,rightExpr:o},m(n))}function d(e){var n=e[0],t=e[1];return r({type:c.ExprType.UNARY_OP,op:a(n).type.toLowerCase(),rightExpr:t},m(a(n)))}function y(e,n){var t=m(e).loc;return[[t.line,t.col],n]}var h={Lexer:u.default,ParserRules:[{name:"module$ebnf$1",symbols:["stmtSep"],postprocess:a},{name:"module$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"module$ebnf$2",symbols:["moduleComponentWithSep"]},{name:"module$ebnf$2",symbols:["module$ebnf$2","moduleComponentWithSep"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"module",symbols:["module$ebnf$1","module$ebnf$2"],postprocess:function(e){e[0];return e[1].reduce((function(e,n){return{stmts:o(o([],e.stmts),n.stmts),procs:o(o([],e.procs),n.procs),udts:o(o([],e.udts),n.udts)}}))}},{name:"moduleComponentWithSep",symbols:["stmtWithSep"],postprocess:function(e){return{stmts:[e[0]],procs:[],udts:[]}}},{name:"moduleComponentWithSep",symbols:["proc","stmtSep"],postprocess:function(e){var n=e[0];e[1];return{stmts:[],procs:n?[n]:[],udts:[]}}},{name:"moduleComponentWithSep",symbols:["udt","stmtSep"],postprocess:function(e){var n=e[0];e[1];return{stmts:[],procs:[],udts:n?[n]:[]}}},{name:"proc",symbols:["fnProc"],postprocess:a},{name:"proc",symbols:["subProc"],postprocess:a},{name:"proc",symbols:["defFnExprProc"],postprocess:a},{name:"proc",symbols:["procDecl"],postprocess:l},{name:"fnProc$ebnf$1$subexpression$1",symbols:[u.default.has("LPAREN")?{type:"LPAREN"}:LPAREN,"params",u.default.has("RPAREN")?{type:"RPAREN"}:RPAREN]},{name:"fnProc$ebnf$1",symbols:["fnProc$ebnf$1$subexpression$1"],postprocess:a},{name:"fnProc$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"fnProc$ebnf$2",symbols:[u.default.has("STATIC")?{type:"STATIC"}:STATIC],postprocess:a},{name:"fnProc$ebnf$2",symbols:[],postprocess:function(){return null}},{name:"fnProc",symbols:[u.default.has("FUNCTION")?{type:"FUNCTION"}:FUNCTION,u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER,"fnProc$ebnf$1","fnProc$ebnf$2","stmts",u.default.has("END")?{type:"END"}:END,u.default.has("FUNCTION")?{type:"FUNCTION"}:FUNCTION],postprocess:function(e){var n=e[0],t=e[1],o=e[2],s=e[3],a=e[4];e[5],e[6];return r({type:p.ProcType.FN,name:t.value,params:o?o[1]:[],stmts:a,isDefaultStatic:!!s},m(n))}},{name:"subProc$ebnf$1$subexpression$1",symbols:[u.default.has("LPAREN")?{type:"LPAREN"}:LPAREN,"params",u.default.has("RPAREN")?{type:"RPAREN"}:RPAREN]},{name:"subProc$ebnf$1",symbols:["subProc$ebnf$1$subexpression$1"],postprocess:a},{name:"subProc$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"subProc$ebnf$2",symbols:[u.default.has("STATIC")?{type:"STATIC"}:STATIC],postprocess:a},{name:"subProc$ebnf$2",symbols:[],postprocess:function(){return null}},{name:"subProc",symbols:[u.default.has("SUB")?{type:"SUB"}:SUB,u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER,"subProc$ebnf$1","subProc$ebnf$2","stmts",u.default.has("END")?{type:"END"}:END,u.default.has("SUB")?{type:"SUB"}:SUB],postprocess:function(e){var n=e[0],t=e[1],o=e[2],s=e[3],a=e[4];e[5],e[6];return r({type:p.ProcType.SUB,name:t.value,params:o?o[1]:[],stmts:a,isDefaultStatic:!!s},m(n))}},{name:"defFnExprProc$ebnf$1$subexpression$1",symbols:[u.default.has("LPAREN")?{type:"LPAREN"}:LPAREN,"params",u.default.has("RPAREN")?{type:"RPAREN"}:RPAREN]},{name:"defFnExprProc$ebnf$1",symbols:["defFnExprProc$ebnf$1$subexpression$1"],postprocess:a},{name:"defFnExprProc$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"defFnExprProc",symbols:[u.default.has("DEF")?{type:"DEF"}:DEF,u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER,"defFnExprProc$ebnf$1",u.default.has("EQ")?{type:"EQ"}:EQ,"expr"],postprocess:function(e,n,t){var o=e[0],s=e[1],a=e[2],i=e[3],u=e[4];return s.value.toLowerCase().startsWith("fn")?r({type:p.ProcType.DEF_FN,name:s.value,params:a?a[1]:[],stmts:[r({type:c.StmtType.ASSIGN,targetExpr:r({type:c.ExprType.VAR_REF,name:s.value},m(i)),valueExpr:u},m(i))],isDefaultStatic:!1},m(o)):t}},{name:"procDecl$subexpression$1",symbols:[u.default.has("FUNCTION")?{type:"FUNCTION"}:FUNCTION]},{name:"procDecl$subexpression$1",symbols:[u.default.has("SUB")?{type:"SUB"}:SUB]},{name:"procDecl$ebnf$1$subexpression$1",symbols:[u.default.has("LPAREN")?{type:"LPAREN"}:LPAREN,"params",u.default.has("RPAREN")?{type:"RPAREN"}:RPAREN]},{name:"procDecl$ebnf$1",symbols:["procDecl$ebnf$1$subexpression$1"],postprocess:a},{name:"procDecl$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"procDecl",symbols:[u.default.has("DECLARE")?{type:"DECLARE"}:DECLARE,"procDecl$subexpression$1",u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER,"procDecl$ebnf$1"],postprocess:l},{name:"params",symbols:[],postprocess:function(){return[]}},{name:"params$ebnf$1",symbols:[]},{name:"params$ebnf$1$subexpression$1",symbols:["param",u.default.has("COMMA")?{type:"COMMA"}:COMMA]},{name:"params$ebnf$1",symbols:["params$ebnf$1","params$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"params",symbols:["params$ebnf$1","param"],postprocess:function(e){var n=e[0],t=e[1];return o(o([],n?n.map((function(e){var n=e[0];e[1];return n})):[]),[t])}},{name:"param",symbols:[u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER,"singularTypeExprOrDefault"],postprocess:function(e){var n=e[0],t=e[1];return r({name:n.value,typeExpr:t},m(n))}},{name:"param",symbols:[u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER,u.default.has("LPAREN")?{type:"LPAREN"}:LPAREN,u.default.has("RPAREN")?{type:"RPAREN"}:RPAREN,"singularTypeExprOrDefault"],postprocess:function(e){var n=e[0],t=(e[1],e[2],e[3]);return r({name:n.value,typeExpr:r({type:c.DataTypeExprType.ARRAY,elementTypeExpr:t,dimensionSpecExprs:[]},m(n))},m(n))}},{name:"udt",symbols:[u.default.has("TYPE")?{type:"TYPE"}:TYPE,u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER,"fieldExprs",u.default.has("END")?{type:"END"}:END,u.default.has("TYPE")?{type:"TYPE"}:TYPE],postprocess:function(e){var n=e[0],t=e[1],o=e[2];e[3],e[4];return r({name:t.value,fieldSpecExprs:o},m(n))}},{name:"fieldExprs$ebnf$1",symbols:["stmtSep"],postprocess:a},{name:"fieldExprs$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"fieldExprs",symbols:["fieldExprs$ebnf$1"],postprocess:function(){return[]}},{name:"fieldExprs$ebnf$2",symbols:["stmtSep"],postprocess:a},{name:"fieldExprs$ebnf$2",symbols:[],postprocess:function(){return null}},{name:"fieldExprs$ebnf$3",symbols:[]},{name:"fieldExprs$ebnf$3$subexpression$1",symbols:["fieldExpr","stmtSep"]},{name:"fieldExprs$ebnf$3",symbols:["fieldExprs$ebnf$3","fieldExprs$ebnf$3$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"fieldExprs$ebnf$4",symbols:["stmtSep"],postprocess:a},{name:"fieldExprs$ebnf$4",symbols:[],postprocess:function(){return null}},{name:"fieldExprs",symbols:["fieldExprs$ebnf$2","fieldExprs$ebnf$3","fieldExpr","fieldExprs$ebnf$4"],postprocess:function(e){e[0];var n=e[1],t=e[2];e[3];return o(o([],n?n.map((function(e){var n=e[0];e[1];return n})):[]),[t])}},{name:"fieldExpr",symbols:[u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER,"singularTypeExpr"],postprocess:function(e){var n=e[0],t=e[1];return r({name:n.value,typeExpr:t},m(n))}},{name:"stmts$ebnf$1",symbols:["stmtSep"],postprocess:a},{name:"stmts$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"stmts$ebnf$2",symbols:[]},{name:"stmts$ebnf$2",symbols:["stmts$ebnf$2","stmtWithSep"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"stmts",symbols:["stmts$ebnf$1","stmts$ebnf$2"],postprocess:function(e){e[0];return e[1]}},{name:"stmtSep$ebnf$1$subexpression$1",symbols:[u.default.has("COLON")?{type:"COLON"}:COLON]},{name:"stmtSep$ebnf$1$subexpression$1",symbols:[u.default.has("NEWLINE")?{type:"NEWLINE"}:NEWLINE]},{name:"stmtSep$ebnf$1",symbols:["stmtSep$ebnf$1$subexpression$1"]},{name:"stmtSep$ebnf$1$subexpression$2",symbols:[u.default.has("COLON")?{type:"COLON"}:COLON]},{name:"stmtSep$ebnf$1$subexpression$2",symbols:[u.default.has("NEWLINE")?{type:"NEWLINE"}:NEWLINE]},{name:"stmtSep$ebnf$1",symbols:["stmtSep$ebnf$1","stmtSep$ebnf$1$subexpression$2"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"stmtSep",symbols:["stmtSep$ebnf$1"],postprocess:l},{name:"stmtWithSep$ebnf$1",symbols:["stmtSep"],postprocess:a},{name:"stmtWithSep$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"stmtWithSep",symbols:["labelStmt","stmtWithSep$ebnf$1"],postprocess:a},{name:"stmtWithSep",symbols:["nonLabelStmt","stmtSep"],postprocess:a},{name:"stmtWithSep$ebnf$2",symbols:["stmtSep"],postprocess:a},{name:"stmtWithSep$ebnf$2",symbols:[],postprocess:function(){return null}},{name:"stmtWithSep",symbols:["singleLineIfStmt","stmtWithSep$ebnf$2"],postprocess:a},{name:"nonLabelStmt",symbols:["dimStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["assignStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["constStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["gotoStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["blockIfStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["selectStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["whileStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["doWhileStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["doUntilStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["loopWhileStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["loopUntilStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["doLoopStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["exitLoopStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["forStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["nextStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["exitForStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["gosubStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["returnStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["callStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["exitProcStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["endStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["swapStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["printStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["inputStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["defTypeStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["dataStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["readStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["restoreStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["callStmtWithOptParams"],postprocess:a},{name:"nonLabelStmt",symbols:["defSegStmt"],postprocess:a},{name:"nonLabelStmt",symbols:["viewPrintStmt"],postprocess:a},{name:"labelStmt",symbols:[u.default.has("NUMERIC_LITERAL")?{type:"NUMERIC_LITERAL"}:NUMERIC_LITERAL],postprocess:function(e,n,t){var o=e[0];return o.isFirstTokenOnLine?r({type:c.StmtType.LABEL,label:o.value},m(o)):t}},{name:"labelStmt",symbols:[u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER,u.default.has("COLON")?{type:"COLON"}:COLON],postprocess:function(e,n,t){var o=e[0];e[1];return o.isFirstTokenOnLine?r({type:c.StmtType.LABEL,label:o.value},m(o)):t}},{name:"dimStmt$ebnf$1",symbols:[u.default.has("SHARED")?{type:"SHARED"}:SHARED],postprocess:a},{name:"dimStmt$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"dimStmt",symbols:[u.default.has("DIM")?{type:"DIM"}:DIM,"dimStmt$ebnf$1","varDecls"],postprocess:function(e){var n=e[0],t=e[1],o=e[2];return r({type:c.StmtType.DIM,dimType:t?c.DimType.SHARED:c.DimType.LOCAL,varDecls:o},m(n))}},{name:"dimStmt",symbols:[u.default.has("STATIC")?{type:"STATIC"}:STATIC,"varDecls"],postprocess:function(e){var n=e[0],t=e[1];return r({type:c.StmtType.DIM,dimType:c.DimType.STATIC,varDecls:t},m(n))}},{name:"dimStmt",symbols:[u.default.has("SHARED")?{type:"SHARED"}:SHARED,"varDecls"],postprocess:function(e){var n=e[0],t=e[1];return r({type:c.StmtType.DIM,dimType:c.DimType.SHARED,varDecls:t},m(n))}},{name:"varDecls$ebnf$1",symbols:[]},{name:"varDecls$ebnf$1$subexpression$1",symbols:["varDecl",u.default.has("COMMA")?{type:"COMMA"}:COMMA]},{name:"varDecls$ebnf$1",symbols:["varDecls$ebnf$1","varDecls$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"varDecls",symbols:["varDecls$ebnf$1","varDecl"],postprocess:function(e){var n=e[0],t=e[1];return o(o([],n?n.map((function(e){var n=e[0];e[1];return n})):[]),[t])}},{name:"varDecl",symbols:[u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER,"singularTypeExprOrDefault"],postprocess:function(e){var n=e[0],t=e[1];return r({name:n.value,typeExpr:t},m(n))}},{name:"varDecl$ebnf$1",symbols:["dimensionSpecExprs"],postprocess:a},{name:"varDecl$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"varDecl",symbols:[u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER,u.default.has("LPAREN")?{type:"LPAREN"}:LPAREN,"varDecl$ebnf$1",u.default.has("RPAREN")?{type:"RPAREN"}:RPAREN,"singularTypeExprOrDefault"],postprocess:function(e){var n=e[0],t=(e[1],e[2]),o=(e[3],e[4]);return r({name:n.value,typeExpr:r({type:c.DataTypeExprType.ARRAY,elementTypeExpr:o,dimensionSpecExprs:null!==t&&void 0!==t?t:[]},m(n))},m(n))}},{name:"dimensionSpecExprs$ebnf$1",symbols:[]},{name:"dimensionSpecExprs$ebnf$1$subexpression$1",symbols:["dimensionSpecExpr",u.default.has("COMMA")?{type:"COMMA"}:COMMA]},{name:"dimensionSpecExprs$ebnf$1",symbols:["dimensionSpecExprs$ebnf$1","dimensionSpecExprs$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"dimensionSpecExprs",symbols:["dimensionSpecExprs$ebnf$1","dimensionSpecExpr"],postprocess:function(e){var n=e[0],t=e[1];return o(o([],n?n.map((function(e){var n=e[0];e[1];return n})):[]),[t])}},{name:"dimensionSpecExpr",symbols:["expr"],postprocess:function(e){var n=e[0];return r({maxIdxExpr:n},m(n))}},{name:"dimensionSpecExpr",symbols:["expr",u.default.has("TO")?{type:"TO"}:TO,"expr"],postprocess:function(e){var n=e[0],t=(e[1],e[2]);return r({minIdxExpr:n,maxIdxExpr:t},m(n))}},{name:"assignStmt$ebnf$1",symbols:[u.default.has("LET")?{type:"LET"}:LET],postprocess:a},{name:"assignStmt$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"assignStmt",symbols:["assignStmt$ebnf$1","lhsExpr",u.default.has("EQ")?{type:"EQ"}:EQ,"expr"],postprocess:function(e){var n=e[0],t=e[1],o=(e[2],e[3]);return r({type:c.StmtType.ASSIGN,targetExpr:t,valueExpr:o},m(n||t))}},{name:"constStmt",symbols:[u.default.has("CONST")?{type:"CONST"}:CONST,"constDefs"],postprocess:function(e){var n=e[0],t=e[1];return r({type:c.StmtType.CONST,constDefs:t},m(n))}},{name:"constDefs$ebnf$1",symbols:[]},{name:"constDefs$ebnf$1$subexpression$1",symbols:["constDef",u.default.has("COMMA")?{type:"COMMA"}:COMMA]},{name:"constDefs$ebnf$1",symbols:["constDefs$ebnf$1","constDefs$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"constDefs",symbols:["constDefs$ebnf$1","constDef"],postprocess:function(e){var n=e[0],t=e[1];return o(o([],n?n.map((function(e){var n=e[0];e[1];return n})):[]),[t])}},{name:"constDef",symbols:[u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER,u.default.has("EQ")?{type:"EQ"}:EQ,"expr"],postprocess:function(e){var n=e[0],t=(e[1],e[2]);return r({name:n.value,valueExpr:t},m(n))}},{name:"gotoStmt",symbols:[u.default.has("GOTO")?{type:"GOTO"}:GOTO,"labelRef"],postprocess:function(e){var n=e[0],t=e[1];return r({type:c.StmtType.GOTO,destLabel:t},m(n))}},{name:"singleLineIfStmt$ebnf$1$subexpression$1",symbols:[u.default.has("ELSE")?{type:"ELSE"}:ELSE,"singleLineStmts"]},{name:"singleLineIfStmt$ebnf$1",symbols:["singleLineIfStmt$ebnf$1$subexpression$1"],postprocess:a},{name:"singleLineIfStmt$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"singleLineIfStmt",symbols:[u.default.has("IF")?{type:"IF"}:IF,"expr",u.default.has("THEN")?{type:"THEN"}:THEN,"singleLineStmts","singleLineIfStmt$ebnf$1",u.default.has("NEWLINE")?{type:"NEWLINE"}:NEWLINE],postprocess:function(e){var n=e[0],t=e[1],o=(e[2],e[3]),s=e[4];e[5],e[6];return r({type:c.StmtType.IF,ifBranches:[r({condExpr:t,stmts:o},m(n))],elseBranch:s?r({stmts:s[1]},m(s[0])):null},m(n))}},{name:"blockIfStmt$ebnf$1",symbols:[]},{name:"blockIfStmt$ebnf$1$subexpression$1",symbols:[u.default.has("ELSEIF")?{type:"ELSEIF"}:ELSEIF,"expr",u.default.has("THEN")?{type:"THEN"}:THEN,u.default.has("NEWLINE")?{type:"NEWLINE"}:NEWLINE,"stmts"]},{name:"blockIfStmt$ebnf$1",symbols:["blockIfStmt$ebnf$1","blockIfStmt$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"blockIfStmt$ebnf$2$subexpression$1",symbols:[u.default.has("ELSE")?{type:"ELSE"}:ELSE,"stmts"]},{name:"blockIfStmt$ebnf$2",symbols:["blockIfStmt$ebnf$2$subexpression$1"],postprocess:a},{name:"blockIfStmt$ebnf$2",symbols:[],postprocess:function(){return null}},{name:"blockIfStmt",symbols:[u.default.has("IF")?{type:"IF"}:IF,"expr",u.default.has("THEN")?{type:"THEN"}:THEN,u.default.has("NEWLINE")?{type:"NEWLINE"}:NEWLINE,"stmts","blockIfStmt$ebnf$1","blockIfStmt$ebnf$2",u.default.has("END")?{type:"END"}:END,u.default.has("IF")?{type:"IF"}:IF],postprocess:function(e){var n=e[0],t=e[1],s=(e[2],e[3],e[4]),a=e[5],i=e[6];e[7],e[8];return r({type:c.StmtType.IF,ifBranches:o([r({condExpr:t,stmts:s},m(n))],a.map((function(e){var n=e[0],t=e[1],o=(e[2],e[3],e[4]);return r({condExpr:t,stmts:o},m(n))}))),elseBranch:i?r({stmts:i[1]},m(i[0])):null},m(n))}},{name:"selectStmt$ebnf$1",symbols:["stmtSep"],postprocess:a},{name:"selectStmt$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"selectStmt$ebnf$2$subexpression$1",symbols:[u.default.has("CASE")?{type:"CASE"}:CASE,"caseExprs","stmts"]},{name:"selectStmt$ebnf$2",symbols:["selectStmt$ebnf$2$subexpression$1"]},{name:"selectStmt$ebnf$2$subexpression$2",symbols:[u.default.has("CASE")?{type:"CASE"}:CASE,"caseExprs","stmts"]},{name:"selectStmt$ebnf$2",symbols:["selectStmt$ebnf$2","selectStmt$ebnf$2$subexpression$2"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"selectStmt$ebnf$3$subexpression$1",symbols:[u.default.has("CASE")?{type:"CASE"}:CASE,u.default.has("ELSE")?{type:"ELSE"}:ELSE,"stmts"]},{name:"selectStmt$ebnf$3",symbols:["selectStmt$ebnf$3$subexpression$1"],postprocess:a},{name:"selectStmt$ebnf$3",symbols:[],postprocess:function(){return null}},{name:"selectStmt",symbols:[u.default.has("SELECT")?{type:"SELECT"}:SELECT,u.default.has("CASE")?{type:"CASE"}:CASE,"expr","selectStmt$ebnf$1","selectStmt$ebnf$2","selectStmt$ebnf$3",u.default.has("END")?{type:"END"}:END,u.default.has("SELECT")?{type:"SELECT"}:SELECT],postprocess:function(e){var n=e[0],t=(e[1],e[2]),o=(e[3],e[4]),s=e[5];e[6],e[7];return r({type:c.StmtType.SELECT,testExpr:t,ifBranches:o.map((function(e){var n=e[0],t=e[1],o=e[2];return r({condExprs:t,stmts:o},m(n))})),elseBranch:s?r({stmts:s[2]},m(s[0])):null},m(n))}},{name:"caseExprs$ebnf$1",symbols:[]},{name:"caseExprs$ebnf$1$subexpression$1",symbols:["caseExpr",u.default.has("COMMA")?{type:"COMMA"}:COMMA]},{name:"caseExprs$ebnf$1",symbols:["caseExprs$ebnf$1","caseExprs$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"caseExprs",symbols:["caseExprs$ebnf$1","caseExpr"],postprocess:function(e){var n=e[0],t=e[1];return o(o([],n?n.map((function(e){var n=e[0];e[1];return n})):[]),[t])}},{name:"caseExpr",symbols:["expr"],postprocess:function(e){var n=e[0];return{type:c.CaseExprType.VALUE,valueExpr:n}}},{name:"caseExpr",symbols:["expr",u.default.has("TO")?{type:"TO"}:TO,"expr"],postprocess:function(e){var n=e[0],t=(e[1],e[2]);return{type:c.CaseExprType.RANGE,lowerBoundExpr:n,upperBoundExpr:t}}},{name:"caseExpr$subexpression$1",symbols:[u.default.has("EQ")?{type:"EQ"}:EQ]},{name:"caseExpr$subexpression$1",symbols:[u.default.has("NE")?{type:"NE"}:NE]},{name:"caseExpr$subexpression$1",symbols:[u.default.has("GT")?{type:"GT"}:GT]},{name:"caseExpr$subexpression$1",symbols:[u.default.has("GTE")?{type:"GTE"}:GTE]},{name:"caseExpr$subexpression$1",symbols:[u.default.has("LT")?{type:"LT"}:LT]},{name:"caseExpr$subexpression$1",symbols:[u.default.has("LTE")?{type:"LTE"}:LTE]},{name:"caseExpr",symbols:[u.default.has("IS")?{type:"IS"}:IS,"caseExpr$subexpression$1","expr"],postprocess:function(e){e[0];var n=e[1],t=e[2];return{type:c.CaseExprType.COMP,op:a(n).type.toLowerCase(),rightExpr:t}}},{name:"whileStmt",symbols:[u.default.has("WHILE")?{type:"WHILE"}:WHILE,"expr","stmts",u.default.has("WEND")?{type:"WEND"}:WEND],postprocess:function(e){var n=e[0],t=e[1],o=e[2];e[3];return r({type:c.StmtType.COND_LOOP,structure:c.CondLoopStructure.COND_EXPR_BEFORE_STMTS,condExpr:t,isCondNegated:!1,stmts:o},m(n))}},{name:"doWhileStmt",symbols:[u.default.has("DO")?{type:"DO"}:DO,u.default.has("WHILE")?{type:"WHILE"}:WHILE,"expr","stmts",u.default.has("LOOP")?{type:"LOOP"}:LOOP],postprocess:function(e){var n=e[0],t=(e[1],e[2]),o=e[3];e[4];return r({type:c.StmtType.COND_LOOP,structure:c.CondLoopStructure.COND_EXPR_BEFORE_STMTS,condExpr:t,isCondNegated:!1,stmts:o},m(n))}},{name:"doUntilStmt",symbols:[u.default.has("DO")?{type:"DO"}:DO,u.default.has("UNTIL")?{type:"UNTIL"}:UNTIL,"expr","stmts",u.default.has("LOOP")?{type:"LOOP"}:LOOP],postprocess:function(e){var n=e[0],t=(e[1],e[2]),o=e[3];e[4];return r({type:c.StmtType.COND_LOOP,structure:c.CondLoopStructure.COND_EXPR_BEFORE_STMTS,condExpr:t,isCondNegated:!0,stmts:o},m(n))}},{name:"loopWhileStmt",symbols:[u.default.has("DO")?{type:"DO"}:DO,"stmts",u.default.has("LOOP")?{type:"LOOP"}:LOOP,u.default.has("WHILE")?{type:"WHILE"}:WHILE,"expr"],postprocess:function(e){var n=e[0],t=e[1],o=(e[2],e[3],e[4]);return r({type:c.StmtType.COND_LOOP,structure:c.CondLoopStructure.COND_EXPR_AFTER_STMTS,condExpr:o,isCondNegated:!1,stmts:t},m(n))}},{name:"loopUntilStmt",symbols:[u.default.has("DO")?{type:"DO"}:DO,"stmts",u.default.has("LOOP")?{type:"LOOP"}:LOOP,u.default.has("UNTIL")?{type:"UNTIL"}:UNTIL,"expr"],postprocess:function(e){var n=e[0],t=e[1],o=(e[2],e[3],e[4]);return r({type:c.StmtType.COND_LOOP,structure:c.CondLoopStructure.COND_EXPR_AFTER_STMTS,condExpr:o,isCondNegated:!0,stmts:t},m(n))}},{name:"doLoopStmt",symbols:[u.default.has("DO")?{type:"DO"}:DO,"stmts",u.default.has("LOOP")?{type:"LOOP"}:LOOP],postprocess:function(e){var n=e[0],t=e[1];e[2];return r({type:c.StmtType.UNCOND_LOOP,stmts:t},m(n))}},{name:"exitLoopStmt",symbols:[u.default.has("EXIT")?{type:"EXIT"}:EXIT,u.default.has("DO")?{type:"DO"}:DO],postprocess:function(e){var n=e[0];e[1];return r({type:c.StmtType.EXIT_LOOP},m(n))}},{name:"forStmt$ebnf$1$subexpression$1",symbols:[u.default.has("STEP")?{type:"STEP"}:STEP,"expr"]},{name:"forStmt$ebnf$1",symbols:["forStmt$ebnf$1$subexpression$1"],postprocess:a},{name:"forStmt$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"forStmt",symbols:[u.default.has("FOR")?{type:"FOR"}:FOR,"lhsExpr",u.default.has("EQ")?{type:"EQ"}:EQ,"expr",u.default.has("TO")?{type:"TO"}:TO,"expr","forStmt$ebnf$1"],postprocess:function(e){var n=e[0],t=e[1],o=(e[2],e[3]),s=(e[4],e[5]),a=e[6];return r({type:c.StmtType.FOR,counterExpr:t,startExpr:o,endExpr:s,stepExpr:a?a[1]:null},m(n))}},{name:"nextStmt$ebnf$1",symbols:["lhsExprs"],postprocess:a},{name:"nextStmt$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"nextStmt",symbols:[u.default.has("NEXT")?{type:"NEXT"}:NEXT,"nextStmt$ebnf$1"],postprocess:function(e){var n=e[0],t=e[1];return r({type:c.StmtType.NEXT,counterExprs:null!==t&&void 0!==t?t:[]},m(n))}},{name:"exitForStmt",symbols:[u.default.has("EXIT")?{type:"EXIT"}:EXIT,u.default.has("FOR")?{type:"FOR"}:FOR],postprocess:function(e){var n=e[0];e[1];return r({type:c.StmtType.EXIT_FOR},m(n))}},{name:"gosubStmt",symbols:[u.default.has("GOSUB")?{type:"GOSUB"}:GOSUB,"labelRef"],postprocess:function(e){var n=e[0],t=e[1];return r({type:c.StmtType.GOSUB,destLabel:t},m(n))}},{name:"returnStmt$ebnf$1",symbols:["labelRef"],postprocess:a},{name:"returnStmt$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"returnStmt",symbols:[u.default.has("RETURN")?{type:"RETURN"}:RETURN,"returnStmt$ebnf$1"],postprocess:function(e){var n=e[0],t=e[1];return r({type:c.StmtType.RETURN,destLabel:t},m(n))}},{name:"callStmt$ebnf$1$subexpression$1",symbols:[u.default.has("LPAREN")?{type:"LPAREN"}:LPAREN,"exprs",u.default.has("RPAREN")?{type:"RPAREN"}:RPAREN]},{name:"callStmt$ebnf$1",symbols:["callStmt$ebnf$1$subexpression$1"],postprocess:a},{name:"callStmt$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"callStmt",symbols:[u.default.has("CALL")?{type:"CALL"}:CALL,u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER,"callStmt$ebnf$1"],postprocess:function(e){var n=e[0],t=e[1],o=e[2];return r({type:c.StmtType.CALL,name:t.value,argExprs:o?o[1]:[]},m(n))}},{name:"callStmt",symbols:[u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER,"exprs"],postprocess:function(e,n,t){var o=e[0],s=e[1];if(o.isFirstTokenOnLine&&0===s.length){var a=u.default.peek();if(a&&"COLON"===a.type)return t}return 1===s.length&&s[0].type===c.ExprType.BINARY_OP&&s[0].op===c.BinaryOp.EQ?t:r({type:c.StmtType.CALL,name:o.value,argExprs:s},m(o))}},{name:"exitProcStmt",symbols:[u.default.has("EXIT")?{type:"EXIT"}:EXIT,u.default.has("FUNCTION")?{type:"FUNCTION"}:FUNCTION],postprocess:function(e){var n=e[0];e[1];return r({type:c.StmtType.EXIT_PROC,procType:p.ProcType.FN},m(n))}},{name:"exitProcStmt",symbols:[u.default.has("EXIT")?{type:"EXIT"}:EXIT,u.default.has("SUB")?{type:"SUB"}:SUB],postprocess:function(e){var n=e[0];e[1];return r({type:c.StmtType.EXIT_PROC,procType:p.ProcType.SUB},m(n))}},{name:"endStmt$subexpression$1",symbols:[u.default.has("END")?{type:"END"}:END]},{name:"endStmt$subexpression$1",symbols:[u.default.has("SYSTEM")?{type:"SYSTEM"}:SYSTEM]},{name:"endStmt$subexpression$1",symbols:[u.default.has("STOP")?{type:"STOP"}:STOP]},{name:"endStmt",symbols:["endStmt$subexpression$1"],postprocess:function(e){var n=e[0];return r({type:c.StmtType.END},m(a(n)))}},{name:"swapStmt",symbols:[u.default.has("SWAP")?{type:"SWAP"}:SWAP,"lhsExpr",u.default.has("COMMA")?{type:"COMMA"}:COMMA,"lhsExpr"],postprocess:function(e){var n=e[0],t=e[1],o=(e[2],e[3]);return r({type:c.StmtType.SWAP,leftExpr:t,rightExpr:o},m(n))}},{name:"printStmt$ebnf$1$subexpression$1",symbols:[u.default.has("USING")?{type:"USING"}:USING,"expr",u.default.has("SEMICOLON")?{type:"SEMICOLON"}:SEMICOLON]},{name:"printStmt$ebnf$1",symbols:["printStmt$ebnf$1$subexpression$1"],postprocess:a},{name:"printStmt$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"printStmt",symbols:[u.default.has("PRINT")?{type:"PRINT"}:PRINT,"printStmt$ebnf$1","printArgs"],postprocess:function(e){var n=e[0],t=e[1],o=e[2];return r({type:c.StmtType.PRINT,args:o,formatExpr:t?t[1]:null},m(n))}},{name:"printArgs$ebnf$1",symbols:[]},{name:"printArgs$ebnf$1$subexpression$1",symbols:["expr"]},{name:"printArgs$ebnf$1$subexpression$1",symbols:["printSep"]},{name:"printArgs$ebnf$1",symbols:["printArgs$ebnf$1","printArgs$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"printArgs",symbols:["printArgs$ebnf$1"],postprocess:function(e,n,t){for(var r=e[0],o=i.default.flatten(r),s=0;s<o.length-1;++s){var a=o[s],u=o[s+1];if("string"!==typeof a&&a.type===c.ExprType.VAR_REF&&"string"!==typeof u&&u.type===c.ExprType.UNARY_OP&&u.op===c.UnaryOp.PARENS)return t}return o}},{name:"printSep",symbols:[u.default.has("COMMA")?{type:"COMMA"}:COMMA],postprocess:function(){return c.PrintSep.COMMA}},{name:"printSep",symbols:[u.default.has("SEMICOLON")?{type:"SEMICOLON"}:SEMICOLON],postprocess:function(){return c.PrintSep.SEMICOLON}},{name:"inputStmt$ebnf$1$subexpression$1",symbols:[u.default.has("STRING_LITERAL")?{type:"STRING_LITERAL"}:STRING_LITERAL,"inputStmtPromptSep"]},{name:"inputStmt$ebnf$1",symbols:["inputStmt$ebnf$1$subexpression$1"],postprocess:a},{name:"inputStmt$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"inputStmt",symbols:[u.default.has("INPUT")?{type:"INPUT"}:INPUT,"inputStmt$ebnf$1","lhsExprs"],postprocess:function(e){var n=e[0],t=e[1],o=e[2];return r({type:c.StmtType.INPUT,prompt:t?t[0].value+(t[1]?"? ":""):"? ",inputType:c.InputType.TOKENIZED,targetExprs:o},m(n))}},{name:"inputStmt$ebnf$2$subexpression$1",symbols:[u.default.has("STRING_LITERAL")?{type:"STRING_LITERAL"}:STRING_LITERAL,"inputStmtPromptSep"]},{name:"inputStmt$ebnf$2",symbols:["inputStmt$ebnf$2$subexpression$1"],postprocess:a},{name:"inputStmt$ebnf$2",symbols:[],postprocess:function(){return null}},{name:"inputStmt",symbols:[u.default.has("LINE")?{type:"LINE"}:LINE,u.default.has("INPUT")?{type:"INPUT"}:INPUT,"inputStmt$ebnf$2","lhsExpr"],postprocess:function(e){var n=e[0],t=(e[1],e[2]),o=e[3];return r({type:c.StmtType.INPUT,prompt:t?t[0].value:"",inputType:c.InputType.LINE,targetExprs:[o]},m(n))}},{name:"inputStmtPromptSep",symbols:[u.default.has("COMMA")?{type:"COMMA"}:COMMA],postprocess:function(){return!1}},{name:"inputStmtPromptSep",symbols:[u.default.has("SEMICOLON")?{type:"SEMICOLON"}:SEMICOLON],postprocess:function(){return!0}},{name:"defTypeStmt",symbols:[u.default.has("DEFINT")?{type:"DEFINT"}:DEFINT,"defTypeRanges"],postprocess:function(e){var n=e[0],t=e[1];return r({type:c.StmtType.DEF_TYPE,typeSpec:p.integerSpec(),ranges:t},m(n))}},{name:"defTypeStmt",symbols:[u.default.has("DEFSNG")?{type:"DEFSNG"}:DEFSNG,"defTypeRanges"],postprocess:function(e){var n=e[0],t=e[1];return r({type:c.StmtType.DEF_TYPE,typeSpec:p.singleSpec(),ranges:t},m(n))}},{name:"defTypeStmt",symbols:[u.default.has("DEFDBL")?{type:"DEFDBL"}:DEFDBL,"defTypeRanges"],postprocess:function(e){var n=e[0],t=e[1];return r({type:c.StmtType.DEF_TYPE,typeSpec:p.doubleSpec(),ranges:t},m(n))}},{name:"defTypeStmt",symbols:[u.default.has("DEFLNG")?{type:"DEFLNG"}:DEFLNG,"defTypeRanges"],postprocess:function(e){var n=e[0],t=e[1];return r({type:c.StmtType.DEF_TYPE,typeSpec:p.longSpec(),ranges:t},m(n))}},{name:"defTypeStmt",symbols:[u.default.has("DEFSTR")?{type:"DEFSTR"}:DEFSTR,"defTypeRanges"],postprocess:function(e){var n=e[0],t=e[1];return r({type:c.StmtType.DEF_TYPE,typeSpec:p.stringSpec(),ranges:t},m(n))}},{name:"defTypeRanges$ebnf$1",symbols:[]},{name:"defTypeRanges$ebnf$1$subexpression$1",symbols:["defTypeRange",u.default.has("COMMA")?{type:"COMMA"}:COMMA]},{name:"defTypeRanges$ebnf$1",symbols:["defTypeRanges$ebnf$1","defTypeRanges$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"defTypeRanges",symbols:["defTypeRanges$ebnf$1","defTypeRange"],postprocess:function(e){var n=e[0],t=e[1];return o(o([],n?n.map((function(e){var n=e[0];e[1];return n})):[]),[t])}},{name:"defTypeRange",symbols:[u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER],postprocess:function(e){var n=e[0];return r({minPrefix:n.value,maxPrefix:n.value},m(n))}},{name:"defTypeRange",symbols:[u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER,u.default.has("SUB")?{type:"SUB"}:SUB,u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER],postprocess:function(e){var n=e[0],t=(e[1],e[2]);return r({minPrefix:n.value,maxPrefix:t.value},m(n))}},{name:"dataStmt$ebnf$1",symbols:[]},{name:"dataStmt$ebnf$1$subexpression$1",symbols:["dataItem",u.default.has("COMMA")?{type:"COMMA"}:COMMA]},{name:"dataStmt$ebnf$1",symbols:["dataStmt$ebnf$1","dataStmt$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"dataStmt",symbols:[u.default.has("DATA")?{type:"DATA"}:DATA,"dataStmt$ebnf$1","dataItem"],postprocess:function(e){var n=e[0],t=e[1],s=e[2];return r({type:c.StmtType.DATA,data:o(o([],t?t.map((function(e){var n=e[0];e[1];return n})):[]),[s])},m(n))}},{name:"dataItem",symbols:[],postprocess:function(){return y(u.default.lastToken,null)}},{name:"dataItem",symbols:["literalExpr"],postprocess:function(e){var n=e[0];return y(n,n.value)}},{name:"dataItem",symbols:[u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER],postprocess:function(e){var n=e[0];return y(n,n.value)}},{name:"readStmt",symbols:[u.default.has("READ")?{type:"READ"}:READ,"lhsExprs"],postprocess:function(e){var n=e[0],t=e[1];return r({type:c.StmtType.READ,targetExprs:t},m(n))}},{name:"restoreStmt$ebnf$1",symbols:["labelRef"],postprocess:a},{name:"restoreStmt$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"restoreStmt",symbols:[u.default.has("RESTORE")?{type:"RESTORE"}:RESTORE,"restoreStmt$ebnf$1"],postprocess:function(e){var n=e[0],t=e[1];return r({type:c.StmtType.RESTORE,destLabel:t},m(n))}},{name:"callStmtWithOptParams$subexpression$1",symbols:[u.default.has("LOCATE")?{type:"LOCATE"}:LOCATE]},{name:"callStmtWithOptParams$subexpression$1",symbols:[u.default.has("COLOR")?{type:"COLOR"}:COLOR]},{name:"callStmtWithOptParams$ebnf$1",symbols:[]},{name:"callStmtWithOptParams$ebnf$1$subexpression$1$ebnf$1",symbols:["expr"],postprocess:a},{name:"callStmtWithOptParams$ebnf$1$subexpression$1$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"callStmtWithOptParams$ebnf$1$subexpression$1",symbols:["callStmtWithOptParams$ebnf$1$subexpression$1$ebnf$1",u.default.has("COMMA")?{type:"COMMA"}:COMMA]},{name:"callStmtWithOptParams$ebnf$1",symbols:["callStmtWithOptParams$ebnf$1","callStmtWithOptParams$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"callStmtWithOptParams",symbols:["callStmtWithOptParams$subexpression$1","callStmtWithOptParams$ebnf$1","expr"],postprocess:function(e){var n=e[0],t=e[1],s=e[2];return r({type:c.StmtType.CALL,name:n[0].value,argExprs:o(o([],t?t.map((function(e){var n=e[0],t=e[1];return null!==n&&void 0!==n?n:r({type:c.ExprType.LITERAL,value:NaN},m(t))})):[]),[s])},m(n[0]))}},{name:"defSegStmt$ebnf$1$subexpression$1",symbols:[u.default.has("EQ")?{type:"EQ"}:EQ,"expr"]},{name:"defSegStmt$ebnf$1",symbols:["defSegStmt$ebnf$1$subexpression$1"],postprocess:a},{name:"defSegStmt$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"defSegStmt",symbols:[u.default.has("DEF")?{type:"DEF"}:DEF,u.default.has("SEG")?{type:"SEG"}:SEG,"defSegStmt$ebnf$1"],postprocess:function(e){var n=e[0],t=(e[1],e[2]);return r({type:c.StmtType.CALL,name:"__def_seg",argExprs:t?[t[1]]:[]},m(n))}},{name:"viewPrintStmt$ebnf$1$subexpression$1",symbols:["expr",u.default.has("TO")?{type:"TO"}:TO,"expr"]},{name:"viewPrintStmt$ebnf$1",symbols:["viewPrintStmt$ebnf$1$subexpression$1"],postprocess:a},{name:"viewPrintStmt$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"viewPrintStmt",symbols:[u.default.has("VIEW")?{type:"VIEW"}:VIEW,u.default.has("PRINT")?{type:"PRINT"}:PRINT,"viewPrintStmt$ebnf$1"],postprocess:function(e){var n=e[0],t=(e[1],e[2]);return r({type:c.StmtType.CALL,name:"__view_print",argExprs:t?[t[0],t[2]]:[]},m(n))}},{name:"singleLineStmts$ebnf$1",symbols:[]},{name:"singleLineStmts$ebnf$1",symbols:["singleLineStmts$ebnf$1",u.default.has("COLON")?{type:"COLON"}:COLON],postprocess:function(e){return e[0].concat([e[1]])}},{name:"singleLineStmts$ebnf$2",symbols:[]},{name:"singleLineStmts$ebnf$2$subexpression$1$ebnf$1",symbols:[u.default.has("COLON")?{type:"COLON"}:COLON]},{name:"singleLineStmts$ebnf$2$subexpression$1$ebnf$1",symbols:["singleLineStmts$ebnf$2$subexpression$1$ebnf$1",u.default.has("COLON")?{type:"COLON"}:COLON],postprocess:function(e){return e[0].concat([e[1]])}},{name:"singleLineStmts$ebnf$2$subexpression$1",symbols:["singleLineStmts$ebnf$2$subexpression$1$ebnf$1","nonLabelStmt"]},{name:"singleLineStmts$ebnf$2",symbols:["singleLineStmts$ebnf$2","singleLineStmts$ebnf$2$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"singleLineStmts",symbols:["singleLineStmts$ebnf$1","nonLabelStmt","singleLineStmts$ebnf$2"],postprocess:function(e){e[0];var n=e[1],t=e[2];return o([n],t.map((function(e){e[0];return e[1]})))}},{name:"lhsExprs$ebnf$1",symbols:[]},{name:"lhsExprs$ebnf$1$subexpression$1",symbols:["lhsExpr",u.default.has("COMMA")?{type:"COMMA"}:COMMA]},{name:"lhsExprs$ebnf$1",symbols:["lhsExprs$ebnf$1","lhsExprs$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"lhsExprs",symbols:["lhsExprs$ebnf$1","lhsExpr"],postprocess:function(e){var n=e[0],t=e[1];return o(o([],n?n.map((function(e){var n=e[0];e[1];return n})):[]),[t])}},{name:"labelRef$subexpression$1",symbols:[u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER]},{name:"labelRef$subexpression$1",symbols:[u.default.has("NUMERIC_LITERAL")?{type:"NUMERIC_LITERAL"}:NUMERIC_LITERAL]},{name:"labelRef",symbols:["labelRef$subexpression$1"],postprocess:function(e){return a(e[0]).value}},{name:"elementaryTypeSpec",symbols:[u.default.has("INTEGER")?{type:"INTEGER"}:INTEGER],postprocess:function(){return p.integerSpec()}},{name:"elementaryTypeSpec",symbols:[u.default.has("LONG")?{type:"LONG"}:LONG],postprocess:function(){return p.longSpec()}},{name:"elementaryTypeSpec",symbols:[u.default.has("SINGLE")?{type:"SINGLE"}:SINGLE],postprocess:function(){return p.singleSpec()}},{name:"elementaryTypeSpec",symbols:[u.default.has("DOUBLE")?{type:"DOUBLE"}:DOUBLE],postprocess:function(){return p.doubleSpec()}},{name:"elementaryTypeSpec$ebnf$1$subexpression$1",symbols:[u.default.has("MUL")?{type:"MUL"}:MUL,"expr2"]},{name:"elementaryTypeSpec$ebnf$1",symbols:["elementaryTypeSpec$ebnf$1$subexpression$1"],postprocess:a},{name:"elementaryTypeSpec$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"elementaryTypeSpec",symbols:[u.default.has("STRING")?{type:"STRING"}:STRING,"elementaryTypeSpec$ebnf$1"],postprocess:function(){return p.stringSpec()}},{name:"singularTypeExpr",symbols:[u.default.has("AS")?{type:"AS"}:AS,"elementaryTypeSpec"],postprocess:function(e){var n=e[0],t=e[1];return r({type:c.DataTypeExprType.ELEMENTARY,typeSpec:t},m(n))}},{name:"singularTypeExpr",symbols:[u.default.has("AS")?{type:"AS"}:AS,u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER],postprocess:function(e){var n=e[0],t=e[1];return r({type:c.DataTypeExprType.UDT,name:t.value},m(n))}},{name:"singularTypeExprOrDefault",symbols:[],postprocess:function(e){e[0];return{type:c.DataTypeExprType.ELEMENTARY,loc:{line:u.default.lastToken.line,col:u.default.lastToken.col}}}},{name:"singularTypeExprOrDefault",symbols:["singularTypeExpr"],postprocess:a},{name:"expr",symbols:["expr10"],postprocess:a},{name:"lhsExpr",symbols:["varRefExpr"],postprocess:a},{name:"lhsExpr",symbols:["fnCallExpr"],postprocess:a},{name:"lhsExpr",symbols:["memberExpr"],postprocess:a},{name:"expr10",symbols:["expr9"],postprocess:a},{name:"expr10$subexpression$1",symbols:[u.default.has("OR")?{type:"OR"}:OR]},{name:"expr10",symbols:["expr10","expr10$subexpression$1","expr9"],postprocess:f},{name:"expr9",symbols:["expr8"],postprocess:a},{name:"expr9$subexpression$1",symbols:[u.default.has("AND")?{type:"AND"}:AND]},{name:"expr9",symbols:["expr9","expr9$subexpression$1","expr8"],postprocess:f},{name:"expr8",symbols:["expr7"],postprocess:a},{name:"expr8$subexpression$1",symbols:[u.default.has("NOT")?{type:"NOT"}:NOT]},{name:"expr8",symbols:["expr8$subexpression$1","expr7"],postprocess:d},{name:"expr7",symbols:["expr6"],postprocess:a},{name:"expr7$subexpression$1",symbols:[u.default.has("EQ")?{type:"EQ"}:EQ]},{name:"expr7$subexpression$1",symbols:[u.default.has("NE")?{type:"NE"}:NE]},{name:"expr7$subexpression$1",symbols:[u.default.has("GT")?{type:"GT"}:GT]},{name:"expr7$subexpression$1",symbols:[u.default.has("GTE")?{type:"GTE"}:GTE]},{name:"expr7$subexpression$1",symbols:[u.default.has("LT")?{type:"LT"}:LT]},{name:"expr7$subexpression$1",symbols:[u.default.has("LTE")?{type:"LTE"}:LTE]},{name:"expr7",symbols:["expr6","expr7$subexpression$1","expr6"],postprocess:f},{name:"expr6",symbols:["expr5"],postprocess:a},{name:"expr6$subexpression$1",symbols:[u.default.has("ADD")?{type:"ADD"}:ADD]},{name:"expr6$subexpression$1",symbols:[u.default.has("SUB")?{type:"SUB"}:SUB]},{name:"expr6",symbols:["expr6","expr6$subexpression$1","expr5"],postprocess:f},{name:"expr5",symbols:["expr4"],postprocess:a},{name:"expr5$subexpression$1",symbols:[u.default.has("MOD")?{type:"MOD"}:MOD]},{name:"expr5",symbols:["expr5","expr5$subexpression$1","expr4"],postprocess:f},{name:"expr4",symbols:["expr3"],postprocess:a},{name:"expr4$subexpression$1",symbols:[u.default.has("INTDIV")?{type:"INTDIV"}:INTDIV]},{name:"expr4",symbols:["expr4","expr4$subexpression$1","expr3"],postprocess:f},{name:"expr3",symbols:["expr2"],postprocess:a},{name:"expr3$subexpression$1",symbols:[u.default.has("MUL")?{type:"MUL"}:MUL]},{name:"expr3$subexpression$1",symbols:[u.default.has("DIV")?{type:"DIV"}:DIV]},{name:"expr3",symbols:["expr3","expr3$subexpression$1","expr2"],postprocess:f},{name:"expr2",symbols:["expr1"],postprocess:a},{name:"expr2$subexpression$1",symbols:[u.default.has("SUB")?{type:"SUB"}:SUB]},{name:"expr2",symbols:["expr2$subexpression$1","expr1"],postprocess:d},{name:"expr1",symbols:["expr0"],postprocess:a},{name:"expr1$subexpression$1",symbols:[u.default.has("EXP")?{type:"EXP"}:EXP]},{name:"expr1",symbols:["expr1","expr1$subexpression$1","expr0"],postprocess:f},{name:"expr0",symbols:["varRefExpr"],postprocess:a},{name:"expr0",symbols:["fnCallExpr"],postprocess:a},{name:"expr0",symbols:["literalExpr"],postprocess:a},{name:"expr0",symbols:["memberExpr"],postprocess:a},{name:"expr0",symbols:[u.default.has("LPAREN")?{type:"LPAREN"}:LPAREN,"expr",u.default.has("RPAREN")?{type:"RPAREN"}:RPAREN],postprocess:function(e){var n=e[0],t=e[1];e[2];return r({type:c.ExprType.UNARY_OP,op:c.UnaryOp.PARENS,rightExpr:t},m(n))}},{name:"varRefExpr",symbols:[u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER],postprocess:function(e){var n=e[0];return r({type:c.ExprType.VAR_REF,name:n.value},m(n))}},{name:"fnCallExpr",symbols:[u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER,u.default.has("LPAREN")?{type:"LPAREN"}:LPAREN,"exprs",u.default.has("RPAREN")?{type:"RPAREN"}:RPAREN],postprocess:function(e){var n=e[0],t=(e[1],e[2]);e[3];return r({type:c.ExprType.FN_CALL,name:n.value,argExprs:t},m(n))}},{name:"literalExpr",symbols:["stringLiteralExpr"],postprocess:a},{name:"literalExpr",symbols:["numericLiteralExpr"],postprocess:a},{name:"stringLiteralExpr",symbols:[u.default.has("STRING_LITERAL")?{type:"STRING_LITERAL"}:STRING_LITERAL],postprocess:function(e){var n=e[0];return r({type:c.ExprType.LITERAL,value:n.value},m(n))}},{name:"numericLiteralExpr",symbols:[u.default.has("NUMERIC_LITERAL")?{type:"NUMERIC_LITERAL"}:NUMERIC_LITERAL],postprocess:function(e){var n=e[0];return r({type:c.ExprType.LITERAL,value:parseFloat(n.value)},m(n))}},{name:"memberExpr",symbols:["lhsExpr",u.default.has("DOT")?{type:"DOT"}:DOT,u.default.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER],postprocess:function(e){var n=e[0],t=(e[1],e[2]);return r({type:c.ExprType.MEMBER,udtExpr:n,fieldName:t.value},m(n))}},{name:"exprs",symbols:[],postprocess:function(){return[]}},{name:"exprs$ebnf$1",symbols:[]},{name:"exprs$ebnf$1$subexpression$1",symbols:["expr",u.default.has("COMMA")?{type:"COMMA"}:COMMA]},{name:"exprs$ebnf$1",symbols:["exprs$ebnf$1","exprs$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"exprs",symbols:["exprs$ebnf$1","expr"],postprocess:function(e){var n=e[0],t=e[1];return o(o([],n?n.map((function(e){var n=e[0];e[1];return n})):[]),[t])}}],ParserStart:"module"};n.default=h},688:function(e,n,t){"use strict";var r=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)},s=this&&this.__spreadArray||function(e,n){for(var t=0,r=n.length,o=e.length;t<r;t++,o++)e[o]=n[t];return e},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.SemanticAnalyzer=void 0;var i=a(t(34)),u=t(132),c=t(95),p=t(38),l=t(161),m=Object.freeze({"%":p.integerSpec(),"&":p.longSpec(),"!":p.singleSpec(),"#":p.doubleSpec(),$:p.stringSpec()}),f=[0,10],d=function(e){function n(n,t){var r=(void 0===t?{}:t).sourceFileName,o=e.call(this)||this;return o.module=n,o.udtStack=[],o.currentProc=null,o.defTypeMap={},o.sourceFileName=r,o}return r(n,e),n.prototype.run=function(){this.visitModule(this.module)},n.prototype.visitModule=function(e){this.setUpDefTypeMap(),this.udtStack=[],e.udts.forEach(this.visitUdt.bind(this)),e.procs.forEach(this.preprocessProc.bind(this)),this.currentProc=null,e.localSymbols=[],e.globalSymbols=[],e.labels=this.getLabels(e.stmts),this.acceptAll(e.stmts),this.acceptAll(e.procs)},n.prototype.preprocessProc=function(e){var n=this;e.paramSymbols=e.params.map((function(e){return{name:e.name,varType:c.VarType.ARG,typeSpec:n.getTypeSpecForVarDeclOrParam(e),varScope:c.VarScope.LOCAL}})),e.localSymbols=[],u.isFnProcOrDefFnProc(e)&&(e.returnTypeSpec||(e.returnTypeSpec=this.getDefaultTypeSpecFromName(e.name)),e.localSymbols.push({name:e.name,varType:c.VarType.VAR,typeSpec:e.returnTypeSpec,varScope:c.VarScope.LOCAL})),e.labels=this.getLabels(e.stmts)},n.prototype.getLabels=function(e){for(var n={},t=0,r=e;t<r.length;t++){var o=r[t];o.type===u.StmtType.LABEL&&(n[o.label]&&this.throwError('Label "'+o.label+'" already defined on line '+n[o.label].line,o),n[o.label]=o.loc)}return Object.keys(n)},n.prototype.visitUdt=function(e){var n;if(!e.typeSpec){var t=this.udtStack.indexOf(e);if(t>=0){var r=s(s([],this.udtStack.slice(t)),[e]);this.throwError("Dependency cycle in user-defined types: "+r.map((function(e){return e.name})).join(" -> "),e)}this.udtStack.push(e);for(var o={type:p.DataType.UDT,name:e.name,fieldSpecs:[]},a=0,i=e.fieldSpecExprs;a<i.length;a++){var c=i[a],l=c.name,m=c.typeExpr,f=void 0;switch(m.type){case u.DataTypeExprType.ELEMENTARY:f=null!==(n=m.typeSpec)&&void 0!==n?n:this.getDefaultTypeSpecFromName(l);break;case u.DataTypeExprType.UDT:var d=this.lookupUdtOrThrow(m,m.name);this.visitUdt(d),f=d.typeSpec;break;default:this.throwError("Unexpected field type: "+JSON.stringify(m),m)}o.fieldSpecs.push({name:l,typeSpec:f})}e.typeSpec=o}},n.prototype.visitProc=function(e){this.currentProc=e,this.acceptAll(e.stmts),this.currentProc=null},n.prototype.visitLabelStmt=function(e){},n.prototype.visitDimStmt=function(e){e.dimType!==u.DimType.STATIC||this.currentProc||this.throwError("STATIC statement can only be used inside a procedure.",e);for(var n=0,t=e.varDecls;n<t.length;n++){var r=t[n],o=this.getTypeSpecForVarDeclOrParam(r),s=this.lookupSymbol(r.name);if(s)s.varScope===c.VarScope.LOCAL?this.throwError('Variable already defined in local scope: "'+r.name+'"',e):s.varScope!==c.VarScope.GLOBAL||e.dimType!==u.DimType.SHARED||p.areMatchingSingularTypes(o,s.typeSpec)||p.isArray(o)&&p.isArray(s.typeSpec)&&p.areMatchingSingularTypes(o.elementTypeSpec,s.typeSpec.elementTypeSpec)||this.throwError('Variable already defined in global scope: "'+r.name+'"',e),r.symbol=s;else{var a=void 0;switch(e.dimType){case u.DimType.SHARED:var i=c.lookupSymbol(this.module.localSymbols,r.name);i?(a=i,this.module.localSymbols.splice(this.module.localSymbols.indexOf(i),1),a.varScope=c.VarScope.GLOBAL):a={name:r.name,varType:c.VarType.VAR,typeSpec:o,varScope:c.VarScope.GLOBAL},this.module.globalSymbols.push(a);break;case u.DimType.LOCAL:a=this.createLocalVarSymbol({name:r.name,typeSpec:o}),this.addLocalSymbol(a);break;case u.DimType.STATIC:a={name:r.name,varType:c.VarType.STATIC_VAR,typeSpec:o,varScope:c.VarScope.LOCAL},this.addLocalSymbol(a);break;default:this.throwError("Unknown DimType: "+JSON.stringify(e.dimType),e)}r.symbol=a}}},n.prototype.visitAssignStmt=function(e){this.accept(e.targetExpr),this.accept(e.valueExpr);var n=e.targetExpr.typeSpec,t=e.valueExpr.typeSpec;p.areMatchingSingularTypes(n,t)||this.throwError("Cannot assign "+p.typeSpecName(t)+" value to "+p.typeSpecName(n)+" variable",e)},n.prototype.visitConstStmt=function(e){for(var n=0,t=e.constDefs;n<t.length;n++){var r=t[n];this.accept(r.valueExpr);var s=this.lookupSymbol(r.name);s&&(s.varScope===c.VarScope.LOCAL?this.throwError('Constant already defined in local scope: "'+r.name+'"',e):s.varScope!==c.VarScope.GLOBAL||this.currentProc||this.throwError('Constant already defined in global scope: "'+r.name+'"',e));var a={name:r.name,varType:c.VarType.CONST,typeSpec:r.valueExpr.typeSpec};if(this.currentProc){var i=o(o({},a),{varScope:c.VarScope.LOCAL});this.addLocalSymbol(i),r.symbol=i}else{i=o(o({},a),{varScope:c.VarScope.GLOBAL});this.module.globalSymbols.push(i),r.symbol=i}}},n.prototype.visitGotoStmt=function(e){var n;e.destLabel=this.lookupLabelOrThrow(e,null!==(n=this.currentProc)&&void 0!==n?n:this.module,e.destLabel)},n.prototype.requireNumericExpr=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var t=0,r=e;t<r.length;t++){var o=r[t];this.accept(o),p.isNumeric(o.typeSpec)||this.throwError("Expected numeric expression (got "+p.typeSpecName(o.typeSpec)+")",o)}},n.prototype.requireElementaryTypeExpr=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var t=0,r=e;t<r.length;t++){var o=r[t];this.accept(o),p.isElementaryType(o.typeSpec)||this.throwError("Expected elementary type expression instead of "+o.typeSpec.type,o)}},n.prototype.visitIfStmt=function(e){for(var n=0,t=e.ifBranches;n<t.length;n++){var r=t[n],o=r.condExpr,s=r.stmts;this.requireNumericExpr(o),this.acceptAll(s)}e.elseBranch&&this.acceptAll(e.elseBranch.stmts)},n.prototype.visitSelectStmt=function(e){this.accept(e.testExpr);for(var n=0,t=e.ifBranches;n<t.length;n++){for(var r=t[n],o=r.condExprs,s=r.stmts,a=0,i=o;a<i.length;a++){var c=i[a],l=[];switch(c.type){case u.CaseExprType.VALUE:l.push(c.valueExpr);break;case u.CaseExprType.RANGE:l.push(c.lowerBoundExpr,c.upperBoundExpr);break;case u.CaseExprType.COMP:l.push(c.rightExpr);break;default:this.throwError("Unknown case expression type: "+JSON.stringify(c),e)}this.acceptAll(l);for(var m=0,f=l;m<f.length;m++){var d=f[m];p.areMatchingElementaryTypes(e.testExpr.typeSpec,d.typeSpec)||this.throwError("Case expression type does not match test expression: expected "+p.typeSpecName(e.testExpr.typeSpec)+", got "+p.typeSpecName(d.typeSpec),d)}}this.acceptAll(s)}e.elseBranch&&this.acceptAll(e.elseBranch.stmts)},n.prototype.visitCondLoopStmt=function(e){this.requireNumericExpr(e.condExpr),this.acceptAll(e.stmts)},n.prototype.visitUncondLoopStmt=function(e){this.acceptAll(e.stmts)},n.prototype.visitExitLoopStmt=function(e){},n.prototype.visitForStmt=function(e){this.requireNumericExpr.apply(this,s([e.counterExpr,e.startExpr,e.endExpr],e.stepExpr?[e.stepExpr]:[]))},n.prototype.visitNextStmt=function(e){this.requireNumericExpr.apply(this,e.counterExprs)},n.prototype.visitExitForStmt=function(e){},n.prototype.visitGosubStmt=function(e){var n;e.destLabel=this.lookupLabelOrThrow(e,null!==(n=this.currentProc)&&void 0!==n?n:this.module,e.destLabel)},n.prototype.visitReturnStmt=function(e){var n;e.destLabel&&(e.destLabel=this.lookupLabelOrThrow(e,null!==(n=this.currentProc)&&void 0!==n?n:this.module,e.destLabel))},n.prototype.visitCallStmt=function(e){this.acceptAll(e.argExprs);var n=this.lookupSub(e.name,e.argExprs.map((function(e){return e.typeSpec})));(!n||n.defType===p.ProcDefType.MODULE&&n.proc.type!==p.ProcType.SUB)&&this.throwError(p.procTypeName(p.ProcType.SUB)+' not found: "'+e.name+'"',e),this.visitProcCall(n,e)},n.prototype.visitExitProcStmt=function(e){this.currentProc&&this.currentProc.type===e.procType||this.throwError("EXIT statement must be placed inside a "+p.procTypeName(e.procType),e)},n.prototype.visitEndStmt=function(e){},n.prototype.visitSwapStmt=function(e){this.accept(e.leftExpr),this.accept(e.rightExpr),p.areMatchingSingularTypes(e.leftExpr.typeSpec,e.rightExpr.typeSpec)||this.throwError("Cannot swap a "+p.typeSpecName(e.leftExpr.typeSpec)+" variable with a "+p.typeSpecName(e.rightExpr.typeSpec)+" variable",e)},n.prototype.visitPrintStmt=function(e){e.formatExpr&&(this.accept(e.formatExpr),p.isString(e.formatExpr.typeSpec)||this.throwError("Expected format expression to be a string, got "+p.typeSpecName(e.formatExpr.typeSpec),e.formatExpr));for(var n=0,t=e.args;n<t.length;n++){var r=t[n];"string"!==typeof r&&this.requireElementaryTypeExpr(r)}},n.prototype.visitInputStmt=function(e){switch(e.inputType){case u.InputType.TOKENIZED:this.requireElementaryTypeExpr.apply(this,e.targetExprs);break;case u.InputType.LINE:1!==e.targetExprs.length&&this.throwError("Expected single destination in LINE INPUT statement, got "+e.targetExprs.length,e),this.accept(e.targetExprs[0]),p.isString(e.targetExprs[0].typeSpec)||this.throwError("Expected string destination in LINE INPUT staement, got "+e.targetExprs[0].typeSpec.type,e.targetExprs[0]);break;default:this.throwError("Unknown input type: "+JSON.stringify(e.inputType),e)}},n.prototype.visitDefTypeStmt=function(e){this.currentProc&&this.throwError("DEFtype statements are only allowed at module level",e);for(var n=function(n){var r=[n.minPrefix.toLowerCase(),n.maxPrefix.toLowerCase()],o=r[0],s=r[1];[o,s].every((function(e){return e.match(/^[a-z]$/)||o>s}))||t.throwError("Invalid DEFtype range",n);for(var a=o.charCodeAt(0);a<=s.charCodeAt(0);++a)t.defTypeMap[String.fromCharCode(a)]=e.typeSpec},t=this,r=0,o=e.ranges;r<o.length;r++){n(o[r])}},n.prototype.visitDataStmt=function(e){this.currentProc&&this.throwError("DATA statement must be at module level",e)},n.prototype.visitReadStmt=function(e){0===e.targetExprs.length&&this.throwError("Empty READ statement",e);for(var n=0,t=e.targetExprs;n<t.length;n++){var r=t[n];this.accept(r),p.isElementaryType(r.typeSpec)||this.throwError("Expected elementary type variable in READ statement (got "+p.typeSpecName(r.typeSpec)+")",r)}},n.prototype.visitRestoreStmt=function(e){e.destLabel&&(e.destLabel=this.lookupLabelOrThrow(e,this.module,e.destLabel))},n.prototype.visitLiteralExpr=function(e){"string"===typeof e.value?e.typeSpec=p.stringSpec():"number"===typeof e.value?e.typeSpec=p.singleSpec():this.throwError("Unknown literal expression value type: "+typeof e.value,e)},n.prototype.visitVarRefExpr=function(e){var n,t,r=this.lookupSymbol(e.name);if(!r){if(this.lookupFn(e.name,[])){var o={type:u.ExprType.FN_CALL,name:e.name,argExprs:[],loc:e.loc};return this.accept(o),void Object.assign(e,o)}r=this.createLocalVarSymbol({name:e.name,typeSpec:null!==(t=e.typeSpec)&&void 0!==t?t:this.getDefaultTypeSpecFromName(e.name)}),this.addLocalSymbol(r)}n=[r.typeSpec,r],e.typeSpec=n[0],e.symbol=n[1]},n.prototype.visitFnCallExpr=function(e){this.acceptAll(e.argExprs);var n=this.lookupFn(e.name,e.argExprs.map((function(e){return e.typeSpec})));if(n)return n.defType!==p.ProcDefType.MODULE||u.isFnProcOrDefFnProc(n.proc)||this.throwError("A "+p.procTypeName(n.proc.type)+' cannot be used in an expression: "'+e.name+'"',e),this.visitProcCall(n,e),void(e.typeSpec=n.returnTypeSpec);var t={type:u.ExprType.SUBSCRIPT,arrayExpr:{type:u.ExprType.VAR_REF,name:e.name,loc:e.loc},indexExprs:e.argExprs,loc:e.loc};this.accept(t),Object.assign(e,t)},n.prototype.visitBinaryOpExpr=function(e){var n=this;this.accept(e.leftExpr),this.accept(e.rightExpr);var t=e.leftExpr.typeSpec,r=e.rightExpr.typeSpec,o="Incompatible types for "+e.op+" operator: "+p.typeSpecName(t)+" and "+p.typeSpecName(r),s=function(){p.isNumeric(t)&&p.isNumeric(r)||n.throwError(o,e)},a=function(){e.typeSpec=n.coerceNumericTypes(t,r)};switch(e.op){case u.BinaryOp.ADD:p.isString(t)&&p.isString(r)?e.typeSpec=p.stringSpec():(s(),a());break;case u.BinaryOp.SUB:case u.BinaryOp.MUL:case u.BinaryOp.EXP:case u.BinaryOp.INTDIV:case u.BinaryOp.MOD:s(),a();break;case u.BinaryOp.DIV:s(),e.typeSpec=this.coerceNumericTypes(t,r,p.singleSpec());break;case u.BinaryOp.AND:case u.BinaryOp.OR:s(),e.typeSpec=p.integerSpec();break;case u.BinaryOp.EQ:case u.BinaryOp.NE:case u.BinaryOp.GT:case u.BinaryOp.GTE:case u.BinaryOp.LT:case u.BinaryOp.LTE:p.areMatchingElementaryTypes(t,r)||this.throwError(o,e),e.typeSpec=p.integerSpec();break;default:this.throwError("Unknown operator "+e.op,e)}},n.prototype.visitUnaryOpExpr=function(e){this.accept(e.rightExpr);var n=e.rightExpr.typeSpec;switch(e.op){case u.UnaryOp.NEG:this.requireNumericExpr(e.rightExpr),e.typeSpec=n;break;case u.UnaryOp.NOT:this.requireNumericExpr(e.rightExpr),e.typeSpec=p.integerSpec();break;case u.UnaryOp.PARENS:e.typeSpec=n;break;default:this.throwError("Unknown operator "+e.op,e)}},n.prototype.visitSubscriptExpr=function(e){if(0===e.indexExprs.length)return this.accept(e.arrayExpr),void Object.assign(e,e.arrayExpr);this.acceptAll(e.indexExprs);for(var n=0;n<e.indexExprs.length;++n){var t=e.indexExprs[n];p.isNumeric(t.typeSpec)||this.throwError("Array index #"+(n+1)+" should be numeric instead of "+t.typeSpec.type,t)}e.arrayExpr.typeSpec=p.arraySpec(this.getDefaultTypeSpecFromName(e.arrayExpr.name),e.indexExprs.map((function(){return f}))),this.accept(e.arrayExpr);var r=e.arrayExpr.typeSpec;p.isArray(r)||this.throwError("Expected array variable in subscript expression, got "+p.typeSpecName(e.arrayExpr.typeSpec),e.arrayExpr),r.dimensionSpecs.length&&r.dimensionSpecs.length!==e.indexExprs.length&&this.throwError("Wrong number of index expressions: expected "+r.dimensionSpecs.length+", got "+e.indexExprs.length,e),e.typeSpec=e.arrayExpr.typeSpec.elementTypeSpec},n.prototype.visitMemberExpr=function(e){this.accept(e.udtExpr);var n=e.udtExpr.typeSpec;p.isUdt(n)||this.throwError("Expected user-defined type in member expression, got "+p.typeSpecName(n),e);var t=c.lookupSymbol(n.fieldSpecs,e.fieldName);t||this.throwError('Field "'+e.fieldName+'" does not exist on type "'+p.typeSpecName(n)+'"',e),e.fieldName=t.name,e.typeSpec=t.typeSpec},n.prototype.visitProcCall=function(e,n){var t;switch(n.argTypeProps=[],e.defType){case p.ProcDefType.BUILTIN:t=e.builtinProc.paramTypeSpecs;break;case p.ProcDefType.MODULE:t=e.proc.paramSymbols.map((function(e){return e.typeSpec}));break;default:this.throwError("Unknown FnDefType: "+JSON.stringify(e),n)}n.procDefType=e.defType,t.length!==n.argExprs.length&&this.throwError('Incorrect number of arguments to "'+n.name+'": expected '+t.length+", got "+n.argExprs.length,n);for(var r=0;r<n.argExprs.length;++r){var o=t[r],s=n.argExprs[r],a=s.typeSpec,l=u.isLhsExpr(s)&&!(s.type===u.ExprType.VAR_REF&&s.symbol.varType===c.VarType.CONST)&&e.defType!==p.ProcDefType.BUILTIN;(l?i.default.isEqual(o,a)||p.isArray(o)&&p.isArray(a)&&i.default.isEqual(o.elementTypeSpec,a.elementTypeSpec):p.areMatchingSingularTypes(o,a)||p.isArray(o)&&p.isArray(a)&&(p.areMatchingSingularTypes(o.elementTypeSpec,a.elementTypeSpec)||e.defType===p.ProcDefType.BUILTIN))||this.throwError("Incompatible argument "+(r+1)+' to function "'+n.name+'": expected '+p.typeSpecName(o)+", got "+p.typeSpecName(a),n),n.argTypeProps.push({paramTypeSpec:o,shouldPassByRef:l})}},n.prototype.coerceNumericTypes=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var t=[{operands:[p.integerSpec(),p.integerSpec()],result:p.integerSpec()},{operands:[p.integerSpec(),p.longSpec()],result:p.longSpec()},{operands:[p.integerSpec(),p.singleSpec()],result:p.singleSpec()},{operands:[p.integerSpec(),p.doubleSpec()],result:p.doubleSpec()},{operands:[p.longSpec(),p.integerSpec()],result:p.longSpec()},{operands:[p.longSpec(),p.longSpec()],result:p.longSpec()},{operands:[p.longSpec(),p.singleSpec()],result:p.singleSpec()},{operands:[p.longSpec(),p.doubleSpec()],result:p.doubleSpec()},{operands:[p.singleSpec(),p.integerSpec()],result:p.singleSpec()},{operands:[p.singleSpec(),p.longSpec()],result:p.singleSpec()},{operands:[p.singleSpec(),p.singleSpec()],result:p.singleSpec()},{operands:[p.singleSpec(),p.doubleSpec()],result:p.doubleSpec()},{operands:[p.doubleSpec(),p.integerSpec()],result:p.doubleSpec()},{operands:[p.doubleSpec(),p.longSpec()],result:p.doubleSpec()},{operands:[p.doubleSpec(),p.singleSpec()],result:p.doubleSpec()},{operands:[p.doubleSpec(),p.doubleSpec()],result:p.doubleSpec()}];if(0===e.length)throw new Error("Missing arguments");if(!e.every(p.isNumeric))throw new Error("Expected numeric types: "+JSON.stringify(e));for(var r=e[0],o=function(n){var o=t.find((function(t){var o=t.operands,s=o[0],a=o[1];return i.default.isEqual(s,r)&&i.default.isEqual(a,e[n])}));if(!o)throw new Error("Unknown numeric type combination: "+p.typeSpecName(r)+" and "+p.typeSpecName(e[n]));r=o.result},s=1;s<e.length;++s)o(s);return r},n.prototype.getLocalSymbols=function(){return this.currentProc?this.currentProc.localSymbols:this.module.localSymbols},n.prototype.lookupSymbol=function(e){var n,t,r=null;return this.currentProc&&(r=c.lookupSymbol(this.currentProc.paramSymbols,e)),null!==(t=null!==(n=null!==r&&void 0!==r?r:c.lookupSymbol(this.getLocalSymbols(),e))&&void 0!==n?n:c.lookupSymbol(this.module.globalSymbols,e))&&void 0!==t?t:null},n.prototype.createLocalVarSymbol=function(e){return o(o({},e),{varType:this.currentProc&&this.currentProc.isDefaultStatic?c.VarType.STATIC_VAR:c.VarType.VAR,varScope:c.VarScope.LOCAL})},n.prototype.addLocalSymbol=function(){for(var e,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return(e=this.getLocalSymbols()).push.apply(e,n)},n.prototype.getTypeSpecForVarDeclOrParam=function(e){var n=e.name,t=e.typeExpr;switch(t.type){case u.DataTypeExprType.ELEMENTARY:return t.typeSpec||(t.typeSpec=this.getDefaultTypeSpecFromName(n)),t.typeSpec;case u.DataTypeExprType.ARRAY:for(var r=0,a=t.dimensionSpecExprs;r<a.length;r++){var i=a[r],c=i.minIdxExpr,l=i.maxIdxExpr,m=s(s([],c?[c]:[]),[l]);this.acceptAll(m);for(var f=0,d=m;f<d.length;f++){var y=d[f];p.isNumeric(y.typeSpec)||this.throwError("Array dimension size must be numeric, not "+y.typeSpec.type,y)}}return t.elementTypeExpr?u.isSingularTypeExpr(t.elementTypeExpr)||this.throwError("Invalid array element type: "+JSON.stringify(t.elementTypeExpr),t.elementTypeExpr):t.elementTypeExpr={type:u.DataTypeExprType.ELEMENTARY,typeSpec:this.getDefaultTypeSpecFromName(n),loc:t.loc},{type:p.DataType.ARRAY,elementTypeSpec:this.getTypeSpecForVarDeclOrParam(o(o({},e),{typeExpr:t.elementTypeExpr})),dimensionSpecs:t.dimensionSpecExprs.map((function(){return[0,0]}))};case u.DataTypeExprType.UDT:return this.lookupUdtOrThrow(t,t.name).typeSpec;default:this.throwError("Unknown DataTypeExpr type: "+JSON.stringify(t),e)}},n.prototype.getDefaultTypeSpecFromName=function(e){var n;return null!==(n=m[e[e.length-1]])&&void 0!==n?n:this.defTypeMap[e[0].toLowerCase()]},n.prototype.lookupFn=function(e,n){var t=c.lookupSymbol(this.module.procs,e);if(t)return{defType:p.ProcDefType.MODULE,proc:t,returnTypeSpec:u.isFnProcOrDefFnProc(t)?t.returnTypeSpec:null};var r=l.lookupBuiltin(l.BUILTIN_FNS,e,n,{shouldReturnIfArgTypeMismatch:!0});return r?{defType:p.ProcDefType.BUILTIN,builtinProc:r,returnTypeSpec:r.returnTypeSpec}:null},n.prototype.lookupSub=function(e,n){var t=c.lookupSymbol(this.module.procs,e);if(t)return{defType:p.ProcDefType.MODULE,proc:t};var r=l.lookupBuiltin(l.BUILTIN_SUBS,e,n,{shouldReturnIfArgTypeMismatch:!0});return r?{defType:p.ProcDefType.BUILTIN,builtinProc:r}:null},n.prototype.lookupUdtOrThrow=function(e,n){var t=c.lookupSymbol(this.module.udts,n);return t||this.throwError('Type not found: "'+n+'"',e),t},n.prototype.setUpDefTypeMap=function(){for(var e="a".charCodeAt(0);e<="z".charCodeAt(0);++e)this.defTypeMap[String.fromCharCode(e)]=p.singleSpec();this.acceptAll(i.default.filter(this.module.stmts,["type",u.StmtType.DEF_TYPE]))},n.prototype.lookupLabelOrThrow=function(e,n,t){var r=n.labels.find((function(e){return e.toLowerCase()===t.toLowerCase()}));return r||this.throwError('Label not found: "'+t+'"',e),r},n}(u.AstVisitor);n.SemanticAnalyzer=d,n.default=function(e,n){return void 0===n&&(n={}),new d(e,n).run()}},691:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getDataItem=n.dataItemTypeName=void 0;var r=t(38);function o(e){e[0];var n=e[1];return null===n?"null":typeof n}function s(e,n){var t=e[0],s=t[0],a=t[1];e[1];throw new Error("expected "+r.typeSpecName(n)+", got "+o(e)+" data item (defined at "+s+":"+a+")")}n.dataItemTypeName=o,n.getDataItem=function(e,n){e[0];var t=e[1];if(r.isNumeric(n))switch(typeof t){case"number":return t;case"object":return 0;default:s(e,n)}else{if(!r.isString(n))throw new Error("Unknown expected type spec: "+JSON.stringify(n));switch(typeof t){case"string":return t;case"object":return"";default:s(e,n)}}}},692:function(e,n,t){"use strict";var r=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),o=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(o,s){function a(e){try{u(r.next(e))}catch(n){s(n)}}function i(e){try{u(r.throw(e))}catch(n){s(n)}}function u(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,i)}u((r=r.apply(e,n||[])).next())}))},s=this&&this.__generator||function(e,n){var t,r,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=n.call(e,a)}catch(i){s=[6,i],r=0}finally{t=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var i=a(t(166)),u=a(t(693)),c=a(t(706)),p=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return r(n,e),n.prototype.moveCursorTo=function(e,n){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.print(i.default.cursorTo(e,n))];case 1:return t.sent(),[2]}}))}))},n.prototype.setCursorVisibility=function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,this.print(e?i.default.cursorShow:i.default.cursorHide)];case 1:return n.sent(),[2]}}))}))},n.prototype.clearScreen=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.print(i.default.eraseScreen)];case 1:return e.sent(),[4,this.moveCursorTo(0,0)];case 2:return e.sent(),[2]}}))}))},n.prototype.setFgColor=function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,this.print(u.default[e].open)];case 1:return n.sent(),[2]}}))}))},n.prototype.setBgColor=function(e){return o(this,void 0,void 0,(function(){var n;return s(this,(function(t){switch(t.label){case 0:return n="bg"+e[0].toUpperCase()+e.substr(1),[4,this.print(u.default[n].open)];case 1:return t.sent(),[2]}}))}))},n.prototype.beep=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.print(i.default.beep)];case 1:return e.sent(),[2]}}))}))},n.prototype.translateKeyCode=function(e){var n;return null!==(n=c.default[e])&&void 0!==n?n:e},n}(t(134).RuntimePlatform);n.default=p},706:function(e,n,t){"use strict";var r;function o(e){return"\x1b["+e}function s(e){return String.fromCharCode(0,e)}Object.defineProperty(n,"__esModule",{value:!0});var a=((r={})[o("A")]=s(72),r[o("B")]=s(80),r[o("C")]=s(77),r[o("D")]=s(75),r);n.default=a},709:function(e,n,t){},710:function(e,n,t){"use strict";t.r(n);var r=t(1),o=t.n(r),s=t(17),a=t.n(s),i=t(27),u=t(16),c=(t(227),t(228),t(229),t(230),t(231),t(119)),p=t.n(c),l=t(777),m=t(205),f=t(776),d=t(40),y=t(169),h=t(137),x=t(771),b=t(756),S=t(36),g=t(772),E=t(783),_=t(71),v=t(186),T=t.n(v),O=t(189),N=t.n(O),I=t(188),C=t.n(I),w=t(110),A=t.n(w),D=t(187),L=t.n(D),R=t(99),$=t(19),P=t.n($),j=t(26),k=t(784),F=t(762),M=t(782),B=t(761),U=t(760),G=t(763),V=t(759),H=t(764),W=t(713),Y=t(765),q=t(766),X=t(768),K=t(779),z=t(767),Q=t(34),J=t.n(Q),Z=t(206),ee=t(181),ne=t.n(ee),te=t(180),re=t.n(te),oe=t(182),se=t.n(oe),ae=[{fileName:"guess.bas",title:"GUESS.BAS",description:"Simple number guessing game"},{fileName:"nibbles.bas",title:"NIBBLES.BAS",description:"Classic snake game"},{fileName:"cal.bas",title:"CAL.BAS",description:"Perpetual calendar program"},{fileName:"check.bas",title:"CHECK.BAS",description:"Checkbook balancing program"},{fileName:"strtonum.bas",title:"STRTONUM.BAS",description:"Converts a string to a number"}].map((function(e){return Object(i.a)(Object(i.a)({},e),{},{content:t(245)("./".concat(e.fileName)).default})})),ie=ae,ue=ae[0],ce=t(4);function pe(e){var n=e.isOpen,t=e.onClose,o=e.title,s=e.content,a=e.onConfirm;return Object(ce.jsxs)(M.a,{open:n,onClose:t,children:[Object(ce.jsx)(V.a,{children:o}),Object(ce.jsx)(U.a,{children:Object(ce.jsx)(G.a,{children:s})}),Object(ce.jsxs)(B.a,{children:[Object(ce.jsx)(F.a,{onClick:t,color:"primary",children:"Cancel"}),Object(ce.jsx)(F.a,{onClick:Object(r.useCallback)((function(){t(),a()}),[t,a]),color:"primary",children:"OK"})]})]})}function le(e){var n=e.onSelect,t=Object(r.useCallback)((function(e){n(ie[e])}),[n]);return Object(ce.jsx)(H.a,{subheader:Object(ce.jsx)("li",{}),children:ie.map((function(e,n){var r=e.fileName,o=e.title,s=e.description;return Object(ce.jsxs)(W.a,{button:!0,onClick:function(){return t(n)},children:[Object(ce.jsx)(Y.a,{children:Object(ce.jsx)(k.a,{children:Object(ce.jsx)(re.a,{color:"action"})})}),Object(ce.jsx)(q.a,{primary:o,secondary:s})]},r)}))})}function me(e){var n=e.onSelect,t=Object(r.useCallback)(function(){var e=Object(j.a)(P.a.mark((function e(t){var r;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=9;break}return r=t[0],e.t0=n,e.t1=r.name,e.next=6,r.text();case 6:e.t2=e.sent,e.t3={title:e.t1,content:e.t2},(0,e.t0)(e.t3);case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[n]);return Object(ce.jsx)("div",{style:{display:"flex",flex:1,height:"100%",alignItems:"center",justifyContent:"center"},children:Object(ce.jsx)(Z.a,{acceptedFiles:[".bas"],filesLimit:1,showPreviews:!1,showPreviewsInDropzone:!1,onChange:t})})}var fe,de,ye=Object(d.a)((function(e){var n,t=e.isOpen,o=e.onClose,s=e.editor,a=Object(S.a)(),i=Object(z.a)(a.breakpoints.down("sm")),c=Object(r.useRef)(null),p=Object(r.useState)(!1),l=Object(u.a)(p,2),m=l[0],f=l[1],d=Object(r.useCallback)((function(){s&&c.current&&(s.setValue(c.current.content),c.current=null,o())}),[s,o]),y=Object(r.useCallback)((function(e){if(s){var n=s.getValue().trim(),t=!!n&&!J.a.some(ie,(function(e){var t=e.content;return n===t.trim()}));c.current=e,t?f(!0):d()}}),[s,d]),h=Object(r.useState)("examples"),x=Object(u.a)(h,2),b=x[0],g=x[1];return Object(ce.jsxs)(ce.Fragment,{children:[Object(ce.jsxs)(M.a,{fullScreen:i,open:t,onClose:o,fullWidth:!0,maxWidth:"sm",scroll:"paper",children:[Object(ce.jsx)(V.a,{children:"Open program"}),Object(ce.jsxs)("div",{style:{display:"flex"},children:[Object(ce.jsxs)(K.a,{orientation:"vertical",variant:"scrollable",value:b,onChange:function(e,n){return g(n)},style:{borderRight:"1px solid ".concat(a.palette.divider)},indicatorColor:"primary",textColor:"primary",children:[Object(ce.jsx)(X.a,{label:"Examples",icon:Object(ce.jsx)(ne.a,{}),value:"examples"}),Object(ce.jsx)(X.a,{label:"Computer",icon:Object(ce.jsx)(se.a,{}),value:"upload"})]}),Object(ce.jsxs)("div",{style:{backgroundColor:a.palette.background.paper,overflowY:"overlay",flex:1,height:300,paddingLeft:20,paddingRight:20},children:["examples"===b&&Object(ce.jsx)(le,{onSelect:y}),"upload"===b&&Object(ce.jsx)(me,{onSelect:y})]})]}),Object(ce.jsx)(B.a,{children:Object(ce.jsx)(F.a,{onClick:o,color:"primary",children:"Close"})})]}),Object(ce.jsx)(pe,{isOpen:m,onClose:function(){return f(!1)},onConfirm:d,title:"Open ".concat(null===(n=c.current)||void 0===n?void 0:n.title),content:"This will overwrite the current editor contents. Are you sure?"})]})})),he=t(770),xe=t(769),be=t(780),Se=t(785),ge=t(778),Ee=t(183),_e=t.n(Ee),ve=t(184),Te=t.n(ve),Oe=t(109),Ne=t.n(Oe),Ie=t(29),Ce=t(45),we=t(24),Ae=t(9);!function(e){e.SOURCE_FILES="v1/sourceFiles",e.CURRENT_SOURCE_FILE_NAME="v1/currentSourceFileName",e.EDITOR_FONT_FAMILY="v1/editorFontFamily",e.EDITOR_FONT_SIZE="v1/editorFontSize",e.EDITOR_THEME="v1/editorTheme",e.EDITOR_KEYBINDINGS="v1/editorKeybindings",e.SCREEN_FONT_FAMILY="v1/outputScreenFontFamily",e.SCREEN_FONT_SIZE="v1/outputScreenFontSize",e.SCREEN_LETTER_SPACING="v1/outputScreenLetterSpacing",e.SCREEN_LINE_HEIGHT="v1/outputScreenLineHeight",e.EXECUTION_DELAY="v1/executionDelayUs"}(de||(de={}));var De=(fe={},Object(we.a)(fe,de.SOURCE_FILES,[{name:"default",content:""}]),Object(we.a)(fe,de.CURRENT_SOURCE_FILE_NAME,"default"),Object(we.a)(fe,de.EDITOR_FONT_FAMILY,"Cascadia Mono"),Object(we.a)(fe,de.EDITOR_FONT_SIZE,14),Object(we.a)(fe,de.EDITOR_THEME,"nord_dark"),Object(we.a)(fe,de.EDITOR_KEYBINDINGS,""),Object(we.a)(fe,de.SCREEN_FONT_FAMILY,"Cascadia Mono"),Object(we.a)(fe,de.SCREEN_FONT_SIZE,14),Object(we.a)(fe,de.SCREEN_LETTER_SPACING,0),Object(we.a)(fe,de.SCREEN_LINE_HEIGHT,1),Object(we.a)(fe,de.EXECUTION_DELAY,0),fe),Le=[{label:"Light themes",value:"light"},{label:"Dark themes",value:"dark"}],Re=[{label:"Ambiance",value:"ambiance",group:"dark"},{label:"Chaos",value:"chaos",group:"dark"},{label:"Chrome",value:"chrome",group:"light"},{label:"Clouds",value:"clouds",group:"light"},{label:"Clouds midnight",value:"clouds_midnight",group:"dark"},{label:"Cobalt",value:"cobalt",group:"dark"},{label:"Crimson Editor",value:"crimson_editor",group:"light"},{label:"Dawn",value:"dawn",group:"light"},{label:"Dracula",value:"dracula",group:"dark"},{label:"Dreamweaver",value:"dreamweaver",group:"light"},{label:"Eclipse",value:"eclipse",group:"light"},{label:"Github",value:"github",group:"light"},{label:"Gob",value:"gob",group:"dark"},{label:"Gruvbox",value:"gruvbox",group:"dark"},{label:"Idle Fingers",value:"idle_fingers",group:"dark"},{label:"Iplastic",value:"iplastic",group:"light"},{label:"Katzenmilch",value:"katzenmilch",group:"light"},{label:"KR Theme",value:"kr_theme",group:"dark"},{label:"Kuroir",value:"kuroir",group:"light"},{label:"Merbivore",value:"merbivore",group:"dark"},{label:"Merbivore Soft",value:"merbivore_soft",group:"dark"},{label:"Mono Industrial",value:"mono_industrial",group:"dark"},{label:"Monokai",value:"monokai",group:"dark"},{label:"Nord Dark",value:"nord_dark",group:"dark"},{label:"Pastel On Dark",value:"pastel_on_dark",group:"dark"},{label:"Solarized Dark",value:"solarized_dark",group:"dark"},{label:"Solarized Light",value:"solarized_light",group:"light"},{label:"SQL Server",value:"sqlserver",group:"light"},{label:"Terminal",value:"terminal",group:"dark"},{label:"Textmate",value:"textmate",group:"light"},{label:"Tomorrow",value:"tomorrow",group:"light"},{label:"Tomorrow Night Blue",value:"tomorrow_night_blue",group:"dark"},{label:"Tomorrow Night Bright",value:"tomorrow_night_bright",group:"dark"},{label:"Tomorrow Night Eighties",value:"tomorrow_night_eighties",group:"dark"},{label:"Tomorrow Night",value:"tomorrow_night",group:"dark"},{label:"Twilight",value:"twilight",group:"dark"},{label:"Vibrant Ink",value:"vibrant_ink",group:"dark"},{label:"Xcode",value:"xcode",group:"light"}],$e=[{label:"Default",value:""},{label:"Vim",value:"vim"},{label:"Emacs",value:"emacs"},{label:"Sublime Text",value:"sublime"},{label:"Visual Studio Code",value:"vscode"}],Pe=new(function(){function e(){var n=this;Object(Ie.a)(this,e),this.config=De,Object(Ae.o)(this,{config:Ae.p,setKey:Ae.f,load:Ae.f,sourceFiles:Ae.h,currentSourceFile:Ae.h,setContent:Ae.f}),this.load(),Object(Ae.q)((function(){return Object(Ae.s)(n.config)}),(function(){return n.save()}))}return Object(Ce.a)(e,[{key:"getKey",value:function(e){return this.config[e]}},{key:"setKey",value:function(e,n){this.config[e]=n}},{key:"save",value:function(){for(var e=0,n=Object.values(de);e<n.length;e++){var t=n[e],r=JSON.stringify(De[t]),o=JSON.stringify(this.config[t]);o===r?localStorage.removeItem(t):localStorage.setItem(t,o)}}},{key:"load",value:function(){if("undefined"!==typeof localStorage){for(var e=0,n=Object.values(de);e<n.length;e++){var t=n[e],r=localStorage.getItem(t);if(r){var o=void 0;try{o=JSON.parse(r)}catch(s){console.warn('Failed to parse value for key "'.concat(t,'": "').concat(r,'"'));continue}this.setKey(t,o)}}this.currentSourceFile||this.sourceFiles.push({name:this.getKey(de.CURRENT_SOURCE_FILE_NAME),content:""}),console.log("Loaded config:",Object(Ae.s)(this.config))}else console.warn("localStorage not available")}},{key:"sourceFiles",get:function(){return this.getKey(de.SOURCE_FILES)}},{key:"currentSourceFile",get:function(){return J.a.find(this.sourceFiles,["name",this.getKey(de.CURRENT_SOURCE_FILE_NAME)])}},{key:"setContent",value:function(e,n){e.content=n}}]),e}());function je(e){var n=e.configKey,t=e.title,o=e.isOpen,s=e.onClose,a=Object(r.useState)(Pe.getKey(n)),i=Object(u.a)(a,2),c=i[0],p=i[1];return Object(ce.jsxs)(M.a,{open:o,onClose:s,children:[Object(ce.jsx)(V.a,{children:t}),Object(ce.jsx)(U.a,{dividers:!0,children:Object(ce.jsx)(ge.a,{autoFocus:!0,required:!0,fullWidth:!0,value:c,onChange:function(e){return p(e.target.value)},style:{width:400,maxWidth:"100%"},InputProps:{style:{fontSize:"0.9rem"}}})}),Object(ce.jsxs)(B.a,{children:[Object(ce.jsx)(F.a,{onClick:s,color:"primary",children:"Cancel"}),Object(ce.jsx)(F.a,{onClick:Object(r.useCallback)((function(){Pe.setKey(n,c.trim()),s()}),[n,c,s]),disabled:!c.trim(),color:"primary",children:"Save"})]})]})}function ke(e){var n=e.isOpen,t=e.onClose,o=e.title,s=e.configKey,a=e.min,i=e.max,c=e.step,p=Object(r.useState)(Pe.getKey(s)),l=Object(u.a)(p,2),m=l[0],f=l[1];return Object(ce.jsxs)(M.a,{open:n,onClose:t,children:[Object(ce.jsx)(V.a,{children:o}),Object(ce.jsx)(U.a,{dividers:!0,children:Object(ce.jsx)(Se.a,{value:m,onChange:function(e,n){return f(n)},min:a,max:i,step:c,marks:!0,valueLabelDisplay:"on",style:{width:400,maxWidth:"100%",marginTop:40}})}),Object(ce.jsxs)(B.a,{children:[Object(ce.jsx)(F.a,{onClick:t,color:"primary",children:"Cancel"}),Object(ce.jsx)(F.a,{onClick:Object(r.useCallback)((function(){Pe.setKey(s,m),t()}),[s,m,t]),color:"primary",children:"Save"})]})]})}function Fe(e){var n=e.isOpen,t=e.onClose,o=e.title,s=e.configKey,a=e.groups,i=e.choices,c=Object(r.useState)(Pe.getKey(s)),p=Object(u.a)(c,2),l=p[0],m=p[1],f=Object(r.useRef)(null),d=Object(r.useRef)(null),y=Object(r.useRef)(!1),h=Object(r.useCallback)((function(){n?f.current&&d.current&&!y.current&&(d.current.scrollIntoView(!0),f.current.scrollHeight-f.current.scrollTop-f.current.clientHeight<1||(f.current.scrollTop-=150),y.current=!0):y.current=!1}),[n]);return Object(r.useEffect)(h),Object(ce.jsxs)(M.a,{open:n,onClose:t,children:[Object(ce.jsx)(V.a,{children:o}),Object(ce.jsx)(U.a,{dividers:!0,children:Object(ce.jsx)(H.a,{subheader:Object(ce.jsx)("li",{}),style:{overflowX:"hidden"},ref:function(e){f.current=e,h()},children:(a||[null]).map((function(e,n){var t;return Object(ce.jsx)("li",{style:{backgroundColor:"inherit"},children:Object(ce.jsxs)("ul",{style:{padding:0,backgroundColor:"inherit"},children:[e&&Object(ce.jsx)(xe.a,{color:"primary",children:e.label}),i.map((function(n){if(e&&e.value!==n.group)return null;var t=n.value===l,r=function(){return m(n.value)};return Object(ce.jsxs)(W.a,{selected:t,button:!0,onClick:r,style:{width:400},ref:t?function(e){d.current=e,h()}:null,children:[Object(ce.jsx)(q.a,{primary:n.label,primaryTypographyProps:{style:{fontSize:"0.9rem"}}}),Object(ce.jsx)(he.a,{children:Object(ce.jsx)(be.a,{checked:t,onSelect:r,color:"primary"})})]},n.value)}))]})},null!==(t=null===e||void 0===e?void 0:e.value)&&void 0!==t?t:n)}))})}),Object(ce.jsxs)(B.a,{children:[Object(ce.jsx)(F.a,{onClick:t,color:"primary",children:"Cancel"}),Object(ce.jsx)(F.a,{onClick:Object(r.useCallback)((function(){Pe.setKey(s,l),t()}),[s,l,t]),color:"primary",children:"Save"})]})]})}var Me=Object(d.a)((function(e){var n,t,o=e.isOpen,s=e.onClose,a=Object(S.a)(),i=Object(z.a)(a.breakpoints.down("sm")),c=Object(r.useState)("editor"),p=Object(u.a)(c,2),l=p[0],m=p[1],f=Object(r.useState)(!1),d=Object(u.a)(f,2),y=d[0],h=d[1],x=Object(r.useState)(!1),b=Object(u.a)(x,2),g=b[0],E=b[1],_=Object(r.useState)(!1),v=Object(u.a)(_,2),T=v[0],O=v[1],N=Object(r.useState)(!1),I=Object(u.a)(N,2),C=I[0],w=I[1],A=Object(r.useState)(!1),D=Object(u.a)(A,2),L=D[0],R=D[1],$=Object(r.useState)(!1),P=Object(u.a)($,2),j=P[0],k=P[1],G=Object(r.useState)(!1),Y=Object(u.a)(G,2),Q=Y[0],Z=Y[1],ee=Object(r.useState)(!1),ne=Object(u.a)(ee,2),te=ne[0],re=ne[1],oe=Object(r.useState)(!1),se=Object(u.a)(oe,2),ae=se[0],ie=se[1];return Object(ce.jsxs)(ce.Fragment,{children:[Object(ce.jsxs)(M.a,{fullScreen:i,open:o,onClose:s,fullWidth:!0,maxWidth:"sm",scroll:"paper",children:[Object(ce.jsx)(V.a,{children:"Settings"}),Object(ce.jsx)(U.a,{dividers:!0,children:Object(ce.jsxs)("div",{style:{display:"flex"},children:[Object(ce.jsxs)(K.a,{orientation:"vertical",variant:"scrollable",value:l,onChange:function(e,n){return m(n)},style:{borderRight:"1px solid ".concat(a.palette.divider)},indicatorColor:"primary",textColor:"primary",children:[Object(ce.jsx)(X.a,{label:"Editor",icon:Object(ce.jsx)(_e.a,{}),value:"editor"}),Object(ce.jsx)(X.a,{label:"Output",icon:Object(ce.jsx)(Ne.a,{}),value:"outputScreen"}),Object(ce.jsx)(X.a,{label:"Execution",icon:Object(ce.jsx)(Te.a,{}),value:"execution"})]}),Object(ce.jsx)("div",{style:{backgroundColor:a.palette.background.paper,overflowY:"overlay",flex:1,height:300,paddingLeft:20,paddingRight:20},children:Object(ce.jsxs)(H.a,{subheader:Object(ce.jsx)("li",{}),children:["editor"===l&&Object(ce.jsxs)(ce.Fragment,{children:[Object(ce.jsx)(W.a,{button:!0,onClick:function(){return O(!0)},children:Object(ce.jsx)(q.a,{primary:"Editor theme",secondary:null===(n=J.a.find(Re,["value",Pe.getKey(de.EDITOR_THEME)]))||void 0===n?void 0:n.label})}),Object(ce.jsx)(W.a,{button:!0,onClick:function(){return h(!0)},children:Object(ce.jsx)(q.a,{primary:"Editor font",secondary:Pe.getKey(de.EDITOR_FONT_FAMILY)})}),Object(ce.jsxs)(W.a,{button:!0,onClick:function(){return E(!0)},children:[Object(ce.jsx)(q.a,{primary:"Editor font size",secondary:Pe.getKey(de.EDITOR_FONT_SIZE)})," "]}),Object(ce.jsx)(W.a,{button:!0,onClick:function(){return w(!0)},children:Object(ce.jsx)(q.a,{primary:"Editor keybindings",secondary:null===(t=J.a.find($e,["value",Pe.getKey(de.EDITOR_KEYBINDINGS)]))||void 0===t?void 0:t.label})})]}),"outputScreen"===l&&Object(ce.jsxs)(ce.Fragment,{children:[Object(ce.jsx)(W.a,{button:!0,onClick:function(){return R(!0)},children:Object(ce.jsx)(q.a,{primary:"Output screen font",secondary:Pe.getKey(de.SCREEN_FONT_FAMILY)})}),Object(ce.jsx)(W.a,{button:!0,onClick:function(){return k(!0)},children:Object(ce.jsx)(q.a,{primary:"Output screen font size",secondary:Pe.getKey(de.SCREEN_FONT_SIZE)})}),Object(ce.jsx)(W.a,{button:!0,onClick:function(){return Z(!0)},children:Object(ce.jsx)(q.a,{primary:"Output screen letter spacing",secondary:Pe.getKey(de.SCREEN_LETTER_SPACING)})}),Object(ce.jsx)(W.a,{button:!0,onClick:function(){return re(!0)},children:Object(ce.jsx)(q.a,{primary:"Output screen line height",secondary:"".concat(Pe.getKey(de.SCREEN_LINE_HEIGHT),"x")})})]}),"execution"===l&&Object(ce.jsx)(ce.Fragment,{children:Object(ce.jsx)(W.a,{button:!0,onClick:function(){return ie(!0)},children:Object(ce.jsx)(q.a,{primary:"Statement execution delay",secondary:"".concat(Pe.getKey(de.EXECUTION_DELAY)," \u03bcs")})})})]})})]})}),Object(ce.jsx)(B.a,{children:Object(ce.jsx)(F.a,{onClick:s,color:"primary",children:"Close"})})]}),Object(ce.jsx)(je,{isOpen:y,onClose:function(){return h(!1)},title:"Editor font",configKey:de.EDITOR_FONT_FAMILY}),Object(ce.jsx)(ke,{isOpen:g,onClose:function(){return E(!1)},title:"Editor font size",configKey:de.EDITOR_FONT_SIZE,min:6,max:24,step:1}),Object(ce.jsx)(Fe,{isOpen:T,onClose:function(){return O(!1)},title:"Editor theme",configKey:de.EDITOR_THEME,groups:Le,choices:Re}),Object(ce.jsx)(Fe,{isOpen:C,onClose:function(){return w(!1)},title:"Editor keybindings",configKey:de.EDITOR_KEYBINDINGS,choices:$e}),Object(ce.jsx)(je,{isOpen:L,onClose:function(){return R(!1)},title:"Output screen font",configKey:de.SCREEN_FONT_FAMILY}),Object(ce.jsx)(ke,{isOpen:j,onClose:function(){return k(!1)},title:"Output screen font size",configKey:de.SCREEN_FONT_SIZE,min:6,max:24,step:1}),Object(ce.jsx)(ke,{isOpen:Q,onClose:function(){return Z(!1)},title:"Output screen letter spacing",configKey:de.SCREEN_LETTER_SPACING,min:0,max:8,step:1}),Object(ce.jsx)(ke,{isOpen:te,onClose:function(){return re(!1)},title:"Output screen line height",configKey:de.SCREEN_LINE_HEIGHT,min:1,max:2,step:.05}),Object(ce.jsx)(ke,{isOpen:ae,onClose:function(){return ie(!1)},title:"Statement execution delay",configKey:de.EXECUTION_DELAY,min:0,max:10,step:1})]})}));var Be=function(e){var n=e.isReady,t=e.editor,o=Object(r.useCallback)((function(){if(n&&t){var e=new Blob([t.getValue()],{type:"text/plain;charset=utf-8"});Object(R.saveAs)(e,"program.bas")}}),[n,t]),s=Object(S.a)(),a=Object(r.useState)(!1),i=Object(u.a)(a,2),c=i[0],p=i[1],l=Object(r.useState)(!1),m=Object(u.a)(l,2),f=m[0],d=m[1];return Object(ce.jsxs)(ce.Fragment,{children:[Object(ce.jsx)(x.a,{position:"relative",color:"default",children:Object(ce.jsxs)(g.a,{children:[Object(ce.jsx)(_.a,{variant:"h6",style:{flexGrow:1},children:"qbjc playground"}),n&&Object(ce.jsxs)(ce.Fragment,{children:[Object(ce.jsx)(E.a,{title:"Open program",children:Object(ce.jsx)(b.a,{"aria-label":"Open program",color:"inherit",onClick:function(){return d(!0)},children:Object(ce.jsx)(T.a,{})})}),Object(ce.jsx)(E.a,{title:"Save program",children:Object(ce.jsx)(b.a,{"aria-label":"Save program",color:"inherit",onClick:o,children:Object(ce.jsx)(A.a,{})})}),Object(ce.jsx)(E.a,{title:"Settings",children:Object(ce.jsx)(b.a,{"aria-label":"Edit settings",color:"inherit",onClick:function(){return p(!0)},children:Object(ce.jsx)(L.a,{})})})]}),Object(ce.jsx)(E.a,{title:Object(ce.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:["View on GitHub",Object(ce.jsx)(C.a,{style:{fontSize:s.typography.overline.fontSize,marginLeft:"0.1rem"}})]}),children:Object(ce.jsx)(b.a,{"aria-label":"View on GitHub",color:"inherit",href:"https://github.com/jichu4n/qbjc",target:"_blank",children:Object(ce.jsx)(N.a,{})})})]})}),Object(ce.jsx)(ye,{isOpen:f,onClose:function(){return d(!1)},editor:t}),Object(ce.jsx)(Me,{isOpen:c,onClose:function(){return p(!1)}})]})},Ue=t(773);var Ge,Ve=function(e){var n,t=e.isReady;!function(e){e.VISIBLE="visible",e.TRANSITIONING="transitioning",e.HIDDEN="hidden"}(n||(n={}));var o=Object(r.useState)(n.VISIBLE),s=Object(u.a)(o,2),a=s[0],c=s[1],p=Object(S.a)();return Object(r.useEffect)((function(){t&&a===n.VISIBLE&&(c(n.TRANSITIONING),setTimeout((function(){return c(n.HIDDEN)}),600))}),[t,a,n]),Object(ce.jsx)("div",{style:Object(i.a)(Object(i.a)(Object(i.a)({position:"fixed",left:0,top:0,width:"100%",height:"100%",zIndex:200,backgroundColor:p.palette.background.paper,display:"flex",justifyContent:"center",alignItems:"center",transition:"opacity ".concat(600,"ms")},a===n.VISIBLE?{opacity:1}:{}),a===n.TRANSITIONING?{opacity:0}:{}),a===n.HIDDEN?{display:"none"}:{}),children:Object(ce.jsx)(Ue.a,{})})},He=(t(253),t(775)),We=t(207),Ye=t(774),qe=t(107),Xe=t.n(qe),Ke=t(196),ze=t.n(Ke),Qe=t(195),Je=t.n(Qe),Ze=t(194),en=t.n(Ze),nn=t(111),tn=t.n(nn),rn=(t(150),t(115)),on=t.n(rn),sn=t(193),an=t.n(sn),un=t(192),cn=t.n(un),pn=t(112);!function(e){e.MODULE="module",e.BUNDLE="bundle"}(Ge||(Ge={}));var ln=[{compileResultType:Ge.MODULE,iconClass:cn.a,label:"ES6 module"},{compileResultType:Ge.BUNDLE,iconClass:an.a,label:"Standalone Node.js program"}];function mn(e){var n=e.value,t=e.onChange,s=e.style,a=void 0===s?{}:s,i=o.a.useState(null),c=Object(u.a)(i,2),p=c[0],l=c[1],m=Object(r.useCallback)((function(e){l(e.currentTarget)}),[]),f=Object(r.useCallback)((function(e){l(null),t(e)}),[t]),d=Object(r.useCallback)((function(){l(null)}),[]),y=J.a.find(ln,["compileResultType",n]),h=y.iconClass,x=y.label;return Object(ce.jsxs)(ce.Fragment,{children:[Object(ce.jsx)(F.a,{startIcon:Object(ce.jsx)(h,{}),endIcon:Object(ce.jsx)(en.a,{fontSize:"small"}),onClick:m,style:a,children:x}),Object(ce.jsx)(We.a,{anchorEl:p,keepMounted:!0,open:!!p,onClose:d,children:ln.map((function(e){var t=e.compileResultType,r=e.iconClass,o=e.label;return Object(ce.jsxs)(Ye.a,{selected:t===n,onClick:function(){return f(t)},children:[Object(ce.jsx)(He.a,{children:Object(ce.jsx)(r,{})}),Object(ce.jsx)(_.a,{variant:"inherit",children:o})]},t)}))})]})}function fn(e){var n=e.compileResult,t=e.isOpen,o=e.onClose,s=Object(S.a)(),a=Object(r.useState)(Ge.MODULE),i=Object(u.a)(a,2),c=i[0],p=i[1],l=Object(r.useState)(null),m=Object(u.a)(l,2),f=m[0],d=m[1],y=Object(r.useRef)(null),h=Object(r.useState)(!1),x=Object(u.a)(h,2),g=x[0],v=x[1],T=Object(r.useCallback)((function(){v(!0),setTimeout((function(){var e;return null===(e=y.current)||void 0===e?void 0:e.resize()}),0)}),[]),O=Object(r.useCallback)((function(){v(!1),setTimeout((function(){var e;return null===(e=y.current)||void 0===e?void 0:e.resize()}),0)}),[]),N=Object(r.useCallback)((function(){var e=y.current;if(e){if(!n)return e.setValue(""),void(f&&d(null));f&&f.source===n.source||Object(pn.compile)({source:n.source,sourceFileName:"program.bas",enableBundling:!0}).then(d);var t=(c===Ge.MODULE?n.code:null===f||void 0===f?void 0:f.code)||"";t&&e.getValue()!==t&&e.setValue(t)}}),[c,n,f]);Object(r.useEffect)((function(){N()}),[N]);var I=Object(r.useRef)(null),C=Object(r.useCallback)((function(e){if(e&&!y.current&&t){var n=tn.a.edit(e,{useWorker:!1});I.current=Object(Ae.g)((function(){n.setOptions({fontFamily:Pe.getKey(de.EDITOR_FONT_FAMILY),fontSize:"".concat(Pe.getKey(de.EDITOR_FONT_SIZE),"px")}),n.setTheme("ace/theme/".concat(Pe.getKey(de.EDITOR_THEME)));var e=Pe.getKey(de.EDITOR_KEYBINDINGS);n.setKeyboardHandler(e?"ace/keyboard/".concat(e):"")})),n.setShowPrintMargin(!1),n.session.setMode("ace/mode/javascript"),n.setReadOnly(!0),n.clearSelection(),n.moveCursorTo(0,0),n.focus(),y.current=n,N()}}),[t,N]),w=Object(r.useCallback)((function(){I.current&&(I.current(),I.current=null),y.current&&(y.current.destroy(),y.current=null),o()}),[o]),D=Object(r.useCallback)((function(){var e=y.current;if(e){var n=new Blob([e.getValue()],{type:"text/plain;charset=utf-8"});Object(R.saveAs)(n,"program.js")}}),[]);return Object(ce.jsxs)(M.a,{onClose:w,open:t,fullWidth:!0,fullScreen:g,maxWidth:"lg",children:[Object(ce.jsxs)(V.a,{disableTypography:!0,style:{display:"flex",alignItems:"center"},children:[Object(ce.jsx)(on.a,{style:{marginRight:"0.4rem"}}),Object(ce.jsx)(_.a,{variant:"h6",style:{flexGrow:1},children:"Compiled code"}),Object(ce.jsx)(mn,{value:c,onChange:p,style:{marginRight:s.spacing(1)}}),Object(ce.jsx)(E.a,{title:"Save compiled JavaScript program",children:Object(ce.jsx)(b.a,{onClick:D,children:Object(ce.jsx)(A.a,{})})}),g?Object(ce.jsx)(E.a,{title:"Exit full screen",children:Object(ce.jsx)(b.a,{onClick:O,children:Object(ce.jsx)(Je.a,{})})}):Object(ce.jsx)(E.a,{title:"View as full screen",children:Object(ce.jsx)(b.a,{onClick:T,children:Object(ce.jsx)(ze.a,{})})}),Object(ce.jsx)(E.a,{title:"Close",children:Object(ce.jsx)(b.a,{onClick:w,style:{marginRight:-s.spacing(2)},children:Object(ce.jsx)(Xe.a,{})})})]}),Object(ce.jsx)(U.a,{dividers:!0,style:{display:"flex",flexDirection:"column",height:"80vh",padding:0},children:Object(ce.jsx)("div",{ref:C,style:{flexGrow:1,height:0,overflowY:"overlay"}})})]})}var dn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onReady,t=void 0===n?function(){}:n,o=e.style,s=void 0===o?{}:o,a=Object(r.useRef)(null),i=Object(r.useCallback)((function(e){if(e&&!a.current){var n=tn.a.edit(e);Object(Ae.g)((function(){n.setOptions({fontFamily:Pe.getKey(de.EDITOR_FONT_FAMILY),fontSize:"".concat(Pe.getKey(de.EDITOR_FONT_SIZE),"px")}),n.setTheme("ace/theme/".concat(Pe.getKey(de.EDITOR_THEME)));var e=Pe.getKey(de.EDITOR_KEYBINDINGS);n.setKeyboardHandler(e?"ace/keyboard/".concat(e):"")})),n.setShowPrintMargin(!1),n.session.setMode("ace/mode/vbscript");var r=Pe.currentSourceFile.content.trim()?Pe.currentSourceFile.content:ue.content;n.setValue(r),n.clearSelection(),n.moveCursorTo(0,0),n.focus(),n.on("change",(function(){return Pe.setContent(Pe.currentSourceFile,n.getValue())})),a.current=n,t(n)}}),[t]);return Object(ce.jsx)("div",{ref:i,style:s})},yn=t(116),hn=t.n(yn),xn=t(106),bn=t.n(xn),Sn=t(198),gn=t.n(Sn),En=t(199),_n=t.n(En),vn=t(712);var Tn,On=function(e){var n=e.title,t=e.icon,r=e.children,o=Object(S.a)();return Object(ce.jsxs)(vn.a,{elevation:2,square:!0,style:{display:"flex",flexDirection:"row",alignItems:"center",backgroundColor:o.palette.background.default},children:[Object(ce.jsx)("div",{style:{display:"flex",padding:"0 8px 0 12px"},children:t}),Object(ce.jsx)(_.a,{variant:"overline",color:"textSecondary",style:{flexGrow:1,paddingRight:"12px"},children:n}),r]})},Nn=t(197);!function(e){e.ERROR="error",e.INFO="info",e.EXECUTION="execution"}(Tn||(Tn={}));var In=function(){function e(){Object(Ie.a)(this,e),this.isRunning=!1,this.messages=[],this.editor=null,this.terminal=null,this.executor=null,Object(Ae.o)(this,{init:Ae.f,isReady:Ae.h,isRunning:Ae.p,messages:Ae.p,run:Ae.f,pushMessage:Ae.f,clearMessages:Ae.f,editor:Ae.p.ref,terminal:Ae.p.ref})}return Object(Ce.a)(e,[{key:"init",value:function(e){var n=e.editor,t=e.terminal;n&&(this.editor=n),t&&(this.terminal=t)}},{key:"isReady",get:function(){return!!this.editor&&!!this.terminal}},{key:"run",value:function(){var e=Object(j.a)(P.a.mark((function e(){var n,t,r,o,s,a=this;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.editor&&this.terminal&&!this.isRunning){e.next=2;break}return e.abrupt("return");case 2:if((n=this.editor.getValue()).trim()){e.next=5;break}return e.abrupt("return");case 5:return this.isRunning=!0,e.prev=6,e.next=9,Object(pn.compile)({source:n,sourceFileName:"program.bas"});case 9:t=e.sent,console.log(t.code),e.next=19;break;case 13:return e.prev=13,e.t0=e.catch(6),console.error("Compile error: ".concat(null!==(r=e.t0.message)&&void 0!==r?r:JSON.stringify(e.t0))),Object(Ae.r)((function(){a.isRunning=!1})),e.t0.message&&this.pushMessage({loc:e.t0.loc,type:Tn.ERROR,message:e.t0.message}),e.abrupt("return");case 19:return this.pushMessage({type:Tn.EXECUTION,message:"Running...",compileResult:t}),o=new Date,this.terminal.focus(),this.executor=new Nn.BrowserExecutor(this.terminal,{stmtExecutionDelayUs:Pe.getKey(de.EXECUTION_DELAY)}),e.prev=23,e.next=26,this.executor.executeModule(t.code);case 26:return e.prev=26,s=new Date,Object(Ae.r)((function(){a.isRunning=!1})),this.pushMessage({type:Tn.INFO,message:"Exited in "+"".concat(((s.getTime()-o.getTime())/1e3).toFixed(3),"s")}),this.executor=null,this.editor.focus(),e.finish(26);case 33:case"end":return e.stop()}}),e,this,[[6,13],[23,,26,33]])})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){this.isRunning&&this.executor&&this.executor.stopExecution()}},{key:"goToMessageLocInEditor",value:function(e){if(this.editor&&e){var n=e.line,t=e.col;this.editor.moveCursorTo(n-1,t-1),this.editor.selection.selectWordRight()}}},{key:"pushMessage",value:function(e){this.messages.push(e)}},{key:"clearMessages",value:function(){this.messages.splice(0,this.messages.length)}}]),e}();var Cn=Object(d.a)((function(e){var n=e.messages,t=e.onLocClick,o=e.onShowCompileResultClick,s=e.style,a=void 0===s?{}:s,u=Object(S.a)(),c=Object(r.useRef)(null),p=Object(r.useRef)(!0),l=Object(r.useRef)(0);return Object(r.useEffect)((function(){var e=c.current,t=l.current,r=p.current,o=n.length;e&&o!==t&&(r&&(e.scrollTop=e.scrollHeight),l.current=o)})),Object(ce.jsxs)("div",{style:Object(i.a)({display:"flex",flexDirection:"column"},a),children:[Object(ce.jsx)(On,{title:"Messages",icon:Object(ce.jsx)(_n.a,{style:{fontSize:u.typography.overline.fontSize}}),children:Object(ce.jsx)(E.a,{title:"Clear messages",children:Object(ce.jsx)(b.a,{onClick:function(){return Object(Ae.r)((function(){n.length=0}))},children:Object(ce.jsx)(hn.a,{style:{fontSize:u.typography.overline.fontSize,color:u.palette.text.secondary}})})})}),Object(ce.jsx)("div",{ref:c,style:{flexGrow:1,height:0,overflowY:"overlay"},onScroll:Object(r.useCallback)((function(){var e=c.current;e&&(p.current=e.scrollHeight-e.scrollTop-e.clientHeight<1)}),[]),children:Object(ce.jsx)(H.a,{dense:!0,disablePadding:!0,children:n.map((function(e,n){var r=e.loc,s=e.message,a=e.type,i=e.compileResult,c=function(e,n){var t;return(t={},Object(we.a)(t,Tn.ERROR,{iconClass:bn.a,color:e.palette.warning.dark}),Object(we.a)(t,Tn.INFO,{iconClass:null,color:e.palette.text.hint}),Object(we.a)(t,Tn.EXECUTION,{iconClass:gn.a,color:e.palette.text.hint}),t)[n]}(u,a),p=c.iconClass,l=c.color,m=null;return p&&(m=Object(ce.jsx)(p,{htmlColor:l,style:{fontSize:u.typography.body2.fontSize}})),Object(ce.jsxs)(W.a,{button:!0,divider:!0,style:{paddingTop:0,paddingBottom:0},onClick:function(){return r?t(r):null},children:[m&&Object(ce.jsx)(He.a,{children:m}),Object(ce.jsx)(q.a,{primary:s,primaryTypographyProps:{variant:"caption",style:{fontSize:"0.7rem"}},inset:!m,style:{color:l,marginTop:3,marginBottom:3,marginLeft:-28}}),i&&Object(ce.jsx)(he.a,{style:{marginRight:-6},children:Object(ce.jsx)(E.a,{title:"View compiled JavaScript code",children:Object(ce.jsx)(F.a,{startIcon:Object(ce.jsx)(on.a,{style:{fontSize:u.typography.overline.fontSize,color:u.palette.text.secondary,marginRight:-2}}),onClick:function(){return o(i)},style:{marginRight:-2,fontSize:"0.6rem",color:l},children:"Compiled code"})})})]},n)}))})})]})})),wn=t(200),An=t(201),Dn=t(202),Ln=(t(708),Object(d.a)((function(e){var n=e.isRunning,t=e.onReady,o=void 0===t?function(){}:t,s=e.style,a=void 0===s?{}:s,u=e.dimensions,c=void 0===u?null:u,p=Object(S.a)(),l=Object(r.useRef)(null),m=Object(r.useRef)(null),f=Object(r.useCallback)(function(){var e=Object(j.a)(P.a.mark((function e(n){var t,r;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&!l.current){e.next=2;break}return e.abrupt("return");case 2:return t=new wn.Terminal({convertEol:!0,fontFamily:Pe.getKey(de.SCREEN_FONT_FAMILY)}),l.current=t,r=new An.FitAddon,t.loadAddon(r),t.loadAddon(new Dn),e.next=9,t.loadWebfontAndOpen(n);case 9:Object(Ae.g)((function(){t.setOption("fontFamily",Pe.getKey(de.SCREEN_FONT_FAMILY)),t.setOption("fontSize",Pe.getKey(de.SCREEN_FONT_SIZE)),t.setOption("letterSpacing",Pe.getKey(de.SCREEN_LETTER_SPACING)),t.setOption("lineHeight",Pe.getKey(de.SCREEN_LINE_HEIGHT)),r.fit()})),window.addEventListener("resize",J.a.debounce((function(){return r.fit()}),200)),t.onResize((function(e){var n=e.rows,t=e.cols;return console.log("Resized terminal to ".concat(t,"x").concat(n))})),m.current=r,o(t);case 14:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[o]),d=Object(r.useRef)(""),y=JSON.stringify(c);return Object(r.useEffect)((function(){d.current!==y&&l.current&&m.current&&(m.current.fit(),d.current=y)}),[y]),Object(ce.jsxs)("div",{style:Object(i.a)({display:"flex",flexDirection:"column"},a),children:[Object(ce.jsx)(On,{title:"Output",icon:Object(ce.jsx)(Ne.a,{style:{fontSize:p.typography.overline.fontSize}}),children:n?Object(ce.jsx)("div",{style:{marginRight:12,paddingTop:8,paddingBottom:8},children:Object(ce.jsx)(E.a,{title:"Running program...",children:Object(ce.jsx)(Ue.a,{color:"inherit",size:10})})}):Object(ce.jsx)(E.a,{title:"Clear output",children:Object(ce.jsx)(b.a,{onClick:function(){var e;return null===(e=l.current)||void 0===e?void 0:e.reset()},children:Object(ce.jsx)(hn.a,{style:{fontSize:p.typography.overline.fontSize,color:p.palette.text.secondary}})})})}),Object(ce.jsx)("div",{ref:f,style:{flexGrow:1,height:0,overflowY:"overlay"}})]})}))),Rn=t(755),$n=t(204),Pn=t.n($n),jn=t(203),kn=t.n(jn),Fn=Object(d.a)((function(e){var n=e.qbjcManager,t=n.isRunning;return Object(ce.jsx)("div",{style:{position:"absolute",right:"2rem",bottom:"2rem"},children:Object(ce.jsx)("div",{style:{position:"relative"},children:Object(ce.jsx)(E.a,{title:t?"Stop program":"Run program",children:Object(ce.jsx)(Rn.a,{onClick:Object(r.useCallback)(Object(j.a)(P.a.mark((function e(){return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}n.stop(),e.next=6;break;case 4:return e.next=6,n.run();case 6:case"end":return e.stop()}}),e)}))),[n,t]),color:t?"secondary":"primary",style:{zIndex:10},children:t?Object(ce.jsx)(kn.a,{}):Object(ce.jsx)(Pn.a,{})})})})})})),Mn=(t(709),Object(m.a)({palette:{type:"dark",primary:{light:p.a[300],main:p.a[400],dark:p.a[700],contrastText:"white"}}})),Bn=Object(d.a)((function(){var e=Object(r.useRef)(new In).current,n=Object(r.useState)({}),t=Object(u.a)(n,2),o=t[0],s=t[1],a=Object(r.useState)(!1),c=Object(u.a)(a,2),p=c[0],m=c[1],d=Object(r.useState)(null),x=Object(u.a)(d,2),b=x[0],S=x[1],g=Object(r.useCallback)((function(e){S(e),m(!0)}),[]),E=Object(r.useCallback)((function(){m(!1),S(null)}),[]);return Object(ce.jsxs)(f.a,{theme:Mn,children:[Object(ce.jsx)(l.a,{}),Object(ce.jsx)(Ve,{isReady:e.isReady}),Object(ce.jsx)(y.a,{children:Object(ce.jsxs)("title",{children:["qbjc Playground",e.isRunning?" - Running...":""]})}),Object(ce.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%",width:"100%",backgroundColor:Mn.palette.background.default},children:[Object(ce.jsx)(Be,{isReady:e.isReady,editor:e.editor}),Object(ce.jsxs)(h.a,{minSize:300,sizes:[50,50],onDragEnd:function(e){s(Object(i.a)(Object(i.a)({},o),{},{horizontalSplit:e}))},style:{display:"flex",flexDirection:"row",flexGrow:1,marginTop:5},gutterSize:6,children:[Object(ce.jsxs)("div",{style:{position:"relative"},children:[Object(ce.jsx)(dn,{onReady:function(n){return e.init({editor:n})},style:{width:"100%",height:"100%",overflow:"overlay"}}),Object(ce.jsx)(Fn,{qbjcManager:e})]}),Object(ce.jsxs)(h.a,{direction:"vertical",sizes:[80,20],minSize:100,expandToMin:!0,onDragEnd:function(e){s(Object(i.a)(Object(i.a)({},o),{},{rightVerticalSplit:e}))},style:{display:"flex",flexDirection:"column"},gutterSize:6,children:[Object(ce.jsx)(Ln,{onReady:function(n){return e.init({terminal:n})},dimensions:o,isRunning:e.isRunning}),Object(ce.jsx)(Cn,{messages:e.messages,onLocClick:Object(r.useCallback)((function(n){return e.goToMessageLocInEditor(n)}),[e]),onShowCompileResultClick:g})]})]})]}),Object(ce.jsx)(fn,{compileResult:b,isOpen:p,onClose:E})]})}));a.a.render(Object(ce.jsx)(o.a.StrictMode,{children:Object(ce.jsx)(Bn,{})}),document.getElementById("root"))},94:function(e,n,t){"use strict";var r=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=function(e){function n(n,t){var r=void 0===t?{}:t,o=r.sourceFileName,s=r.loc,a=e.call(this,n)||this;if(s){var i=o?o+":":"",u=s.line+":"+s.col;a.message=""+i+u+" - "+a.message,a.loc=s}return a}return r(n,e),n}(Error);n.default=o},95:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.lookupSymbols=n.lookupSymbol=n.VarScope=n.VarType=void 0,function(e){e.VAR="var",e.STATIC_VAR="staticVar",e.CONST="const",e.ARG="arg"}(n.VarType||(n.VarType={})),function(e){e.LOCAL="local",e.GLOBAL="global"}(n.VarScope||(n.VarScope={})),n.lookupSymbol=function(e,n){var t;return null!==(t=e.find((function(e){return e.name.toLowerCase()===n.toLowerCase()})))&&void 0!==t?t:null},n.lookupSymbols=function(e,n){return e.filter((function(e){return e.name.toLowerCase()===n.toLowerCase()}))}},96:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.PrintArgType=n.ExecutionDirectiveType=void 0,function(e){e.GOTO="goto",e.GOSUB="gosub",e.RETURN="return",e.END="end",e.EXIT_PROC="exitProc"}(n.ExecutionDirectiveType||(n.ExecutionDirectiveType={})),function(e){e.COMMA="comma",e.SEMICOLON="semicolon",e.VALUE="value"}(n.PrintArgType||(n.PrintArgType={}))}},[[710,1,2]]]);
//# sourceMappingURL=main.da82c78d.chunk.js.map